(this.webpackJsonpgnnvis=this.webpackJsonpgnnvis||[]).push([[0],{137:function(e,t,n){},150:function(e,t,n){},166:function(e,t,n){e.exports=n.p+"static/media/logo2.4b8ec5cf.png"},179:function(e,t,n){e.exports=n(319)},184:function(e,t,n){},185:function(e,t,n){},187:function(e,t,n){},234:function(e,t,n){},242:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},247:function(e,t,n){"use strict";n.r(t);var r=n(139),a=n(138),i={version:"1.0.2"};function o(e,t){return!(isNaN(e)||isNaN(t)||e==1/0||t==1/0)}function s(e,t){for(var n=t?Array(e.length):{},r=0;r<e.length;r++)n[e[r]]=r;return n}function c(e){var t,n=Array(e);for(t=0;t<e;t++)n[t]={id:t};return n}i.debug=!1,i.cmp_number_asc=function(e,t){return e-t},i.cmp_number=i.cmp_number_asc,i.cmp_number_desc=function(e,t){return t-e},i.flatten=function(e,t){return e.concat(t)},i.infinities=function(e){var t=-1,n=[];if(1===arguments.length)for(;++t<e;)n[t]=1/0;else for(;++t<e;)n[t]=i.infinities.apply(this,Array.prototype.slice.call(arguments,1));return n},i.array1d=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t;return r},i.dot=r.lin.dot,i.length=r.lin.length,i.normalize=r.lin.normalize,i.zeroes=r.zeroes,i.displaymat=function(e,t,n){var r,a,i,o;for(console.log("Matrix:"),r=0;r<e.length;r++){for(i=t?e[t[r]]:e[r],o="",a=0;a<i.length;a++)o+=(n?i[n[a]]:i[a])?"*":" ";console.log(o)}},i.printvec=function(e,t,n,r){var a;for(r||(r=""),a=0;a<e.length;a++)0!==r.length&&(r+=", "),r+=n?e[n[a]].toFixed(t):e[a].toFixed(t);console.log(r)},i.printmat=function(e,t,n,r){var a,o;for(t||(t=4),a=0;a<e.length;a++)o=n?e[n[a]]:e[a],i.printvec(o,t,r,a+": ")},i.assert=function(e,t){if(!e)throw console.log(t),t||"Assertion failed"},i.printhcluster=function(e,t){return null===e.left?Array(t+1).join(" ")+"id: "+e.id:Array(t+1).join(" ")+"id: "+e.id+", dist: "+e.dist+"\n"+i.printhcluster(e.left,t+1)+"\n"+i.printhcluster(e.right,t+1)},i.mean=r.stats.mean,i.meantranspose=function(e,t){var n=e.length;if(0===n)return NaN;e[0].length;for(var r=0,a=-1;++a<n;)r+=(e[a][t]-r)/(a+1);return r},i.meancolumns=function(e){var t=e.length;if(0===t)return NaN;for(var n,r,a=e[0].length,i=e[0].slice(0),o=0;++o<t;)for(r=e[o],n=0;n<a;n++)i[n]+=(r[n]-i[n])/(o+1);return i},i.sum=function(e){for(var t=e.length,n=0;t-- >0;)isNaN(e[t])||(n+=e[t]);return n},i.distance={euclidean:function(e,t){for(var n,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(a+=(n=e[r]-t[r])*n);return Math.sqrt(a)},manhattan:function(e,t){for(var n=e.length,r=0;n-- >0;)o(e[n],t[n])&&(r+=Math.abs(e[n]-t[n]));return r},minkowski:function(e){return function(t,n){for(var r=t.length,a=0;r-- >0;)o(t[r],n[r])&&(a+=Math.pow(Math.abs(t[r]-n[r]),e));return Math.pow(a,1/e)}},chebyshev:function(e,t){for(var n,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(n=Math.abs(e[r]-t[r]))>a&&(a=n);return a},hamming:function(e,t){for(var n=e.length,r=0;n-- >0;)o(e[n],t[n])&&e[n]!==t[n]&&r++;return r},jaccard:function(e,t){for(var n=0,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(e[r]===t[r]&&a++,n++);return 0===n?0:a/n},braycurtis:function(e,t){for(var n,r,a=e.length,i=0,s=0;a-- >0;)o(n=e[a],r=t[a])&&(i+=Math.abs(n-r),s+=Math.abs(n+r));return 0===s?0:i/s}},i.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));var r=[],a=e;if(n<0)for(;a>t;a+=n)r.push(a);else for(;a<t;a+=n)r.push(a);return r},i.transpose=r.lin.transpose,i.transposeSlice=function(e,t,n){arguments.length<3&&(n=e[0].length,arguments.length<2&&(t=0));for(var r,a=e.length,i=n,o=t-1,s=new Array(n-t);++o<i;)for(s[o]=new Array(a),r=-1;++r<a;)s[o-t][r]=e[r][o];return s},i.correlation={pearson:function(e,t){var n,a,i,o=r.stats.mean(e),s=r.stats.mean(t),c=0,l=0,u=0,d=Math.min(e.length,t.length);if(0===d)return NaN;for(n=0;n<d;n++)c+=(a=e[n]-o)*(i=t[n]-s),l+=a*a,u+=i*i;return c/Math.sqrt(l*u)},pearsonMatrix:function(e){var t,n,r,a=i.correlation.pearson,o=e.length;if(0===o)return NaN;for(r=i.zeroes(o,o),t=0;t<o-1;t++)for(n=t+1;n<o;n++){var s=a(e[t],e[n]);r[t][n]=r[n][t]=s}return r}},i.bandwidth=function(e,t){t||(t=i.range(e.nodes().length));var n,r,a,o=s(t),c=e.links(),l=0;for(n=0;n<c.length;n++)r=c[n],a=Math.abs(o[r.source.index]-o[r.target.index]),l=Math.max(l,a);return l},i.edgesum=function(e,t){t||(t=i.range(e.nodes().length));var n,r,a=s(t),o=e.links(),c=0;for(n=0;n<o.length;n++)r=o[n],c+=Math.abs(a[r.source.index]-a[r.target.index]);return c},i.permutation=i.range,i.inverse_permutation=s,i.graph=function(e,t,n){var r,a,o,s,c={},l=1;return c.nodes=function(t){return arguments.length?(e=t,c):e},c.nodes_indices=function(){return e.map((function(e){return e.index}))},c.generate_nodes=function(t){e=[];for(var n=0;n<t;n++)e.push({id:n});return c},c.links=function(e){return arguments.length?(t=e,c):t},c.links_indices=function(){return t.map((function(e){return{source:e.source.index,target:e.target.index}}))},c.linkDistance=function(e){return arguments.length?(l="function"===typeof e?e:+e,c):l},c.directed=function(e){return arguments.length?(n=e,c):n},c.init=function(){var i,u,d=e.length,h=t.length;for(s=void 0,i=0;i<d;++i)(u=e[i]).index=i,u.weight=0;for(i=0;i<h;++i)(u=t[i]).index=i,"number"==typeof u.source&&(u.source=e[u.source]),"number"==typeof u.target&&(u.target=e[u.target]),"value"in u||(u.value=1),++u.source.weight,++u.target.weight;if("function"===typeof l)for(i=0;i<h;++i)t[i].distance=+l.call(this,t[i],i);else for(i=0;i<h;++i)t[i].distance=l;for(r=Array(e.length),i=0;i<e.length;++i)r[i]=[];if(n)for(a=Array(e.length),o=Array(e.length),i=0;i<e.length;++i)a[i]=[],o[i]=[];else a=o=r;for(i=0;i<t.length;++i)u=t[i],r[u.source.index].push(u),u.source.index!=u.target.index&&r[u.target.index].push(u),n&&a[u.source.index].push(u),n&&o[u.target.index].push(u);return c},c.edges=function(e){return"number"!=typeof e&&(e=e.index,i.debug&&console.log("received node %d",e)),r[e]},c.degree=function(e){return"number"!=typeof e&&(e=e.index),r[e].length},c.inEdges=function(e){return"number"!=typeof e&&(e=e.index),a[e]},c.inDegree=function(e){return"number"!=typeof e&&(e=e.index),a[e].length},c.outEdges=function(e){return"number"!=typeof e&&(e=e.index),o[e]},c.outDegree=function(e){return"number"!=typeof e&&(e=e.index),o[e].length},c.sinks=function(){var t,n=[];for(t=0;t<e.length;t++)0===c.outEdges(t).length&&n.push(t);return n},c.sources=function(){var t,n=[];for(t=0;t<e.length;t++)0===c.inEdges(t).length&&n.push(t);return n},c.distance=function(e){return t[e].distance},c.neighbors=function(e){for(var t=r[e],n=[],a=0;a<t.length;++a){var i=t[a];i.source.index==e?n.push(i.target):n.push(i.source)}return n},c.other=function(e,n){return"number"==typeof e&&(e=t[e]),e.source.index==n?e.target:e.source},c.components=function(){return s||(s=function(){var t,n,a,o,s,c,l,u=[],d=0,h=[],f=e.length;for(n=0;n<f;n++)e[n].comp=0;for(a=0;a<f;a++)if(0===e[a].comp){for(d+=1,e[a].comp=d,u.push(a),t=[a];u.length;)for(o=u.shift(),s=r[o],n=0;n<s.length;n++)(c=(l=s[n]).source).index==o&&(c=l.target),c.index!=o&&0===c.comp&&(c.comp=d,t.push(c.index),u.push(c.index));t.length&&(t.sort(i.cmp_number),h.push(t))}return h.sort((function(e,t){return t.length-e.length})),h}()),s},c},i.graph_random_erdos_renyi=function(e,t,n){if(t<=0)return i.graph_empty(e,n);if(t>=1)return i.graph_complete(e,n);var r,a,o,s,l=c(e),u=[];if(a=-1,s=Math.log(1-t),n)for(r=0;r<e;){for(o=Math.log(1-Math.random()),r==(a=a+1+Math.floor(o/s))&&(a+=1);a>=e&&r<e;)(r+=1)==(a-=e)&&(a+=1);r<e&&u.push({source:r,target:a})}else for(r=1;r<e;){for(o=Math.log(1-Math.random()),a=a+1+Math.floor(o/s);a>=r&&r<e;)a-=r,r+=1;r<e&&u.push({source:r,target:a})}return i.graph(l,u,n).init()},i.graph_random=i.graph_random_erdos_renyi,i.graph_empty_nodes=c,i.graph_empty=function(e,t){return i.graph(c(e),[],t)},i.complete_graph=function(e,t){var n,r,a=c(e),o=[];if(t)for(n=0;n<e;n++)for(r=0;r<e;r++)n!=r&&o.push({source:n,target:r});else for(n=0;n<e-1;n++)for(r=n+1;r<e;r++)o.push({source:n,target:r});return i.graph(a,o,t).init()},i.graph_connect=function(e,t){var n,r,a=e.links();for(t||(t=e.components()),n=0;n<t.length-1;n++)for(r=n+1;r<t.length;r++)a.push({source:t[n][0],target:t[r][0]});return e.links(a),e.init()},i.bfs=function(e,t,n){var r,i,o,s,c=new a,l={};for(c.push(t),l[t]=!0,n(t,void 0);c.length;){for(n(t=c.shift(),t),s=e.edges(t),r=0;r<s.length;r++)i=s[r],l[o=e.other(i,t).index]||(c.push(o),l[o]=!0,n(t,o));n(t,-1)}},i.bfs_distances=function(e,t){var n={};return n[t]=0,i.bfs(e,t,(function(e,t){t>=0&&e!=t&&(n[t]=n[e]+1)})),n},i.all_pairs_distance_bfs=function(e,t){t||(t=[e.nodes_indices()]);var n,r,a,o=t.reduce(i.flatten).sort(i.cmp_number),s=Array(o.length);for(n=0;n<o.length;n++)s[n]=Array(o.length);for(n=0;n<o.length;n++)for(r in a=i.bfs_distances(e,n))s[n][r]=a[r],s[r][n]=a[r];return s};function l(e,t,n){var r,a,o,c,l,u,d,h=!1,f=i.permutation(e.nodes().length);if(void 0===t&&(t=f.filter((function(t){return 0!==e.outDegree(t)})),n=f.filter((function(t){return 0!==e.inDegree(t)}))),t.length<n.length){var g=t;t=n,n=g,h=!0}var p=s(n),_=[];for(r=0;r<t.length;r++)(a=h?e.inEdges(t[r]).map((function(e){return p[e.target.index]})):e.outEdges(t[r]).map((function(e){return p[e.source.index]}))).sort(i.cmp_number),_=_.concat(a);for(o=1;o<n.length;)o<<=1;for(c=2*o-1,o-=1,l=i.zeroes(c),d=0,r=0;r<_.length;r++)for(l[u=_[r]+o]++;u>0;)u%2&&(d+=l[u+1]),l[u=u-1>>1]++;return d}function u(e,t,n,r){var a,i,o,s=e.inEdges(t),c=e.inEdges(n),l=0;for(i=0;i<c.length;i++)for(o=r[c[i].target.index],a=0;a<s.length;a++)r[s[a].target.index]>o&&l++;return l}function d(e,t,n,r){var a,i,o,s=e.outEdges(t),c=e.outEdges(n),l=0;for(i=0;i<c.length;i++)for(o=r[c[i].source.index],a=0;a<s.length;a++)r[s[a].source.index]>o&&l++;return l}function h(e){if(0===e.length)return-1;if(1===e.length)return e[0];if(2===e.length)return(e[0]+e[1])/2;if(e.sort(i.cmp_number),e.length%2)return e[(e.length-1)/2];var t=e.length/2,n=t-1,r=e[e.length-1]-e[t],a=e[n]-e[0];return a==r?(e[n]+e[t])/2:(e[n]*r+e[t]*a)/(a+r)}function f(e,t){var n,r,a,o,c=i.infinities(t.length,t.length);for(o=s(t),n=0;n<t.length;n++)c[n][n]=0;var l=function(t){if(t.source!=t.target&&t.source.index in o&&t.target.index in o){var n=o[t.source.index],r=o[t.target.index];c[r][n]=c[n][r]=e.distance(t.index)}};for(n=0;n<t.length;n++)e.edges(t[n]).forEach(l);for(a=0;a<t.length;a++)for(n=0;n<t.length;n++)if(c[n][a]!=1/0)for(r=0;r<t.length;r++)c[a][r]!=1/0&&c[n][r]>c[n][a]+c[a][r]&&(c[n][r]=c[n][a]+c[a][r],c[r][n]=c[n][r]);return c}function g(e){var t,n,r=e.length,a=i.zeroes(r,r),o=i.distmax(e);for(t=0;t<r;t++)for(n=t;n<r;n++)a[n][t]=a[t][n]=1+o-e[t][n];return a}function p(e,t,n,r){for(var a=[],i=e+n,o=t.length,s=-1;++s<o;)a[s]=(e*t[s]+n*r[s])/i;return a}function _(e){var t=i.length(e),n=e.length;if(0===t||Math.abs(t-1)<1e-9)return 1;for(;n-- >0;)e[n]/=t;return t}function v(e){var t,n,r,a,o=e.length,s=e[0].length;if(r=function(e){var t,n,r,a=e.length,o=e[0].length,s=i.zeroes(o);for(t=0;t<a;t++)for(r=e[t],n=0;n<o;n++)s[n]+=r[n];return s}(e),n=function(e){var t,n,r,a,i=e.length,o=e[0].length,s=Array(i);for(t=0;t<i;t++){for(r=e[t],a=0,n=0;n<o;n++)a+=r[n];s[t]=a}return s}(e),(a=function(e,t,n,r,a,o,s){var c,l,u,d,h,f,g,p,_,v,y,C,S,k,N,M,L,E,P,O,I,j,D,T,G=i.zeroes(r),A=i.zeroes(r),V=i.zeroes(r),F=i.zeroes(r);for(u=0,l=0;l<r;l++)u+=s[l],t[l]=l+1;t[0]=1.1,T=5e-6,m(t,t,e,o,n,r,a),d=0;for(;;){for(h=0,l=0;l<r;l++)h+=t[l]*s[l];for(h/=u,g=0,l=0;l<r;l++)f=t[l]-h,g+=f*f*s[l],t[l]=f;for(g=Math.sqrt(g),l=0;l<r;l++)t[l]/=g;for(m(t,G,e,o,n,r,a),h=0,p=0,_=0,v=0,y=0,C=0,S=0,k=0,l=0;l<r;l++)f=G[l],G[l]=f/s[l],h+=f,p+=f*t[l];for(h/=u,l=0;l<r;l++)f=G[l]-(h+p*t[l]),_+=f*f*s[l],G[l]=f;for(_=Math.sqrt(_),l=0;l<r;l++)G[l]/=_;if(_<T||d>999)break;for(d++,m(G,A,e,o,n,r,a),h=0,O=0,l=0;l<r;l++)f=A[l],A[l]=f/s[l],h+=f,v+=f*G[l],O+=f*t[l];for(h/=u,l=0;l<r;l++)f=A[l]-(h+v*G[l]+O*t[l]),y+=f*f*s[l],A[l]=f;if((y=Math.sqrt(y))>T){for(l=0;l<r;l++)A[l]/=y;for(m(A,V,e,o,n,r,a),h=0,I=0,j=0,l=0;l<r;l++)f=V[l],V[l]/=s[l],h+=f,C+=f*A[l],I+=f*t[l],j+=f*G[l];for(h/=u,l=0;l<r;l++)f=V[l]-(h+C*A[l]+I*t[l]+j*G[l]),S+=f*f*s[l],V[l]=f;if((S=Math.sqrt(S))>T){for(l=0;l<r;l++)V[l]/=S;for(m(V,F,e,o,n,r,a),l=0;l<r;l++)k+=V[l]*F[l]}else S=0}else y=0;if(N=w(T,p,_,v,y,C,S,k),M=N[0],L=N[1],E=N[2],P=N[3],_<T)break;for(l=0;l<r;l++)t[l]=M*t[l]+L*G[l]+E*A[l]+P*V[l]}_>T&&i.debug>0&&console.log("residual bigger than tolerance on axis 1");var H=t[0],R=t[0];for(l=1;l<r;l++)(h=t[l])<R?R=h:h>H&&(H=h);if(-R>H)for(l=0;l<r;l++)t[l]=-t[l];for(x(t,e,n,r,a),c=0;c<n;c++)e[c]/=o[c];var z=0;for(c=0;c<n;c++)z+=o[c]*b(e[c]);for(z=Math.sqrt(z),c=0;c<n;c++)e[c]/=z;for(l=0;l<r;l++)t[l]/=z;var W,U=0;for(c=0;c<n;c++)for(W=e[c],D=a[c],l=0;l<r;l++)U+=D[l]*b(W-t[l]);var K=Math.sqrt(U/u);if(p>=.999){var B=-R/z;B>(K=H/z)&&(K=B)}for(l=0;l<r;l++)t[l]/=K;return{rows:e,cols:t,eig:p}}(i.array1d(o,1),i.array1d(s,1),o,s,e,n,r)).eig<1e-7)a.rows=a.cols=[],a.eig=0;else{t=a.rows,x(a.cols,t,o,s,e);for(var c=0;c<o;c++)t[c]/=n[c]}return a}function m(e,t,n,r,a,i,o,s){var c;for(s&&console.log("TRANS "+s),x(e,n,a,i,o,s),c=0;c<a;c++)n[c]=n[c]/r[c];!function(e,t,n,r,a,i){var o,s,c,l;i&&(console.log("xymult"),y(t));for(s=0;s<r;s++)t[s]=0;for(o=0;o<n;o++)for(c=e[o],l=a[o],s=0;s<r;s++)t[s]+=c*l[s];i&&y(t)}(n,t,a,i,o,s)}function y(e){console.log("");for(var t=0;t<e.length;t++)console.log("i:"+(t+1)+" v:  "+e[t].toFixed(5))}function x(e,t,n,r,a,i){var o,s,c,l;for(i&&(console.log("yxmult"),y(t)),o=0;o<n;o++){for(c=0,l=a[o],s=0;s<r;s++)c+=e[s]*l[s];t[o]=c}i&&y(t)}function b(e){return e*e}function w(e,t,n,r,a,i,o,s){var c,l,u,d,h,f,g,p,_=1,v=.1,m=.01,y=.001;for(c=0;c<100&&(_=t*(l=t*_+n*v)+n*(u=n*_+r*v+a*m),v=n*l+r*u+a*(d=a*v+i*m+o*y),m=a*u+i*d+o*(h=o*m+s*y),y=o*d+s*h,_/=f=Math.sqrt(b(_)+b(v)+b(m)+b(y)),v/=f,m/=f,y/=f,(c+1)%5===0&&(g=Math.sqrt(f),p=Math.sqrt(b(_-l/g)+b(v-u/g)+b(m-d/g)+b(y-h/g))),!(p<.05*e));c++);return[_,v,m,y]}function C(e){return e.map((function(e){return e.map(Math.abs)}))}function S(e,t,n){var r,a=1,o=[1],s=0;for(r=1;r<e.length;r++)n[e[r-1]][e[r]]<0&&(a=-a),a<0?(o.push(-1),s++):o.push(1);if(i.debug&&console.log(o),-1==(a=s>e.length-s?-1:1))for(r=0;r<e.length-1;r++)o[r]=o[r]*a;return o}i.mat2graph=function(e,t){var n,r,a,o=e.length,s=[],c=[],l=Number.NEGATIVE_INFINITY;for(n=0;n<o;n++)s.push({id:n});for(n=0;n<o;n++)for(a=e[n],r=t?0:n;r<a.length;r++)r==s.length&&s.push({id:r}),0!==a[r]&&(a[r]>l&&(l=a[r]),c.push({source:n,target:r,value:a[r]}));return i.graph(s,c,t).linkDistance((function(e,t){return 1+l-e.value})).init()},i.graph2mat=function(e,t){var n,r,a,o=e.nodes(),s=e.links(),c=o.length;if(t||(t=e.directed()),t){var l=c,u=c;for(n=c-1;n>=0&&0===e.inEdges(n).length;n--)l--;for(n=c-1;n>=0&&0===e.outEdges(n).length;n--)u--;for(a=i.zeroes(l,u),n=0;n<s.length;n++)a[(r=s[n]).source.index][r.target.index]=r.value?r.value:1}else for(a=i.zeroes(c,c),n=0;n<s.length;n++)a[(r=s[n]).source.index][r.target.index]=r.value?r.value:1,a[r.target.index][r.source.index]=r.value?r.value:1;return a},i.count_crossings=l,i.adjacent_exchange=function(e,t,n){t=t.slice(),n=n.slice();for(var r,a,i,o,c,l=s(t),h=s(n),f=!0,g=0;f;){for(f=!1,r=0;r<t.length-1;r++)(o=d(e,a=t[r],i=t[r+1],h))>(c=d(e,i,a,h))&&(t[r]=i,t[r+1]=a,l[i]=r,l[a]=r+1,f=!0,g+=o-c);for(r=0;r<n.length-1;r++)(o=u(e,a=n[r],i=n[r+1],l))>(c=u(e,i,a,l))&&(n[r]=i,n[r+1]=a,h[i]=r,h[a]=r+1,f=!0,g+=o-c)}return[t,n,g]},i.barycenter_order=function(e,t,n){var r=[[],[],0];t||(t=e.components());for(var a=0;a<t.length;a++){var o=i.barycenter(e,t[a],n);r=[r[0].concat(o[0]),r[1].concat(o[1]),r[2]+o[2]]}return r},i.barycenter=function(e,t,n){var r,a,o,c,u,d,f,g,p,_,v,m,y,x=e.nodes(),b={};if(r=t.filter((function(t){return 0!==e.outDegree(t)})),a=t.filter((function(t){return 0!==e.inDegree(t)})),t.length<3)return[r,a,l(e,r,a)];n?n%2==1&&n++:n=24,b=s(a),f=l(e,r,a),u=r.slice(),d=a.slice(),g=0;var w=function(e){var t=e.source==v?e.target:e.source;return b[t.index]},C=function(t,n){var r=y[t]-y[n];return 0===r&&(r=e.edges(n).length%2-e.edges(t).length%2),r<0?-1:r>0?1:0};for(p=r,c=0;c<n;c++,p=p==r?a:r){for(y={},_=0;_<p.length;_++)v=x[p[_]],m=(m=p==r?e.outEdges(v.index):e.inEdges(v.index)).map(w),y[v.index]=+h(m);for(p.sort(C),_=0;_<p.length;_++)b=s(p);(o=l(e,r,a))<f&&(f=o,u=r.slice(),d=a.slice(),g=c,n=Math.max(n,c+2))}return i.debug&&console.log("Best iter: "+g),[u,d,f]},i.all_pairs_distance=function(e,t){var n=[];t||(t=e.components());for(var r=0;r<t.length;r++)n.push(f(e,t[r]));return n},i.all_pairs_distance_floyd_warshall=f,i.floyd_warshall_with_path=function(e,t){t||(t=e.components()[0]);var n,r,a,o,c=i.infinities(t.length,t.length),l=Array(t.length),u=e.directed();for(o=s(t),n=0;n<t.length;n++)c[n][n]=0,l[n]=Array(t.length);var d=function(t){if(t.source!=t.target){var n=o[t.source.index],r=o[t.target.index];c[n][r]=e.distance(t),l[n][r]=r,u||(c[r][n]=e.distance(t),l[r][n]=n)}};for(n=0;n<t.length;n++)e.edges(t[n]).forEach(d);for(a=0;a<t.length;a++)for(n=0;n<t.length;n++)for(r=0;r<t.length;r++)c[n][r]>c[n][a]+c[a][r]&&(c[n][r]=c[n][a]+c[a][r],l[n][r]=l[n][a],u||(c[r][n]=c[n][r],l[r][n]=l[a][r]));return[c,l]},i.floyd_warshall_path=function(e,t,n){if(void 0===e[t][n])return[];for(var r=[t];t!=n;)t=e[t][n],r.push(t);return r},i.distmat2valuemat=g,i.graph2valuemats=function(e,t){return t||(t=e.components()),i.all_pairs_distance(e,t).map(g)},i.valuemats_reorder=function(e,t,n){var r=e.map(t);return n&&(r=r.map((function(e,t){return i.permute(n[t],e)}))),r.reduce(i.flatten)},i.dist=function(){var e=i.distance.euclidean;function t(t){for(var n=t.length,r=[],a=0;a<n;a++){var i=[];r[a]=i;for(var o=0;o<n;o++)o<a?i.push(r[o][a]):a===o?i.push(0):i.push(e(t[a],t[o]))}return r}return t.distance=function(n){return arguments.length?(e=n,t):e},t},i.distmax=function(e){var t,n,r,a=0,i=e.length;for(t=0;t<i;t++)for(r=e[t],n=t+1;n<i;n++)r[n]>a&&(a=r[n]);return a},i.distmin=function(e){var t,n,r,a=1/0,i=e.length;for(t=0;t<i;t++)for(r=e[t],n=t+1;n<i;n++)r[n]<a&&(a=r[n]);return a},i.dist_remove=function(e,t,n){var r;for(arguments.length<3&&(n=t+1),e.splice(t,n-t),r=e.length;r-- >0;)e[r].splice(t,n-t);return e},i.randomPermute=function(e,t,n){arguments.length<3&&(n=e.length,arguments.length<2&&(t=0));for(var r,a,i=n-t;i>0;)a=t+Math.floor(Math.random()*i--),r=e[t+i],e[t+i]=e[a],e[a]=r;return e},i.randomPermutation=function(e){return i.randomPermute(i.permutation(e))},i.random_array=function(e,t,n){var r=Array(e);if(1==arguments.length)for(;e;)r[--e]=Math.random();else if(2==arguments.length)for(;e;)r[--e]=Math.random()*t;else for(;e;)r[--e]=t+Math.random()*(n-t);return r},i.random_matrix=function(e,t,n,r){n||(n=t),t!=n?r=!1:r||(r=!0);var a,o,s,c=i.zeroes(t,n);if(r)for(a=0;a<t;a++){for(s=0,o=0;o<a+1;o++)Math.random()<e&&(c[a][o]=c[o][a]=1,s++);0===s&&(o=Math.floor(Math.random()*t/2),c[a][o]=c[o][a]=1)}else for(a=0;a<t;a++){for(s=0,o=0;o<n;o++)Math.random()<e&&(c[a][o]=1,s++);0===s&&(c[a][Math.floor(Math.random()*n)]=1)}return c},i.permute=function(e,t){for(var n=t.length,r=e.slice();n--;)r[n]=e[t[n]];return r},i.permute_inplace=function(e,t){var n,r,a,i;for(n=0;n<e.length;n++)if((r=t[n])<0)t[n]=-1-r;else for(a=n;r!=n;)i=e[r],e[r]=e[a],e[a]=i,a=r,i=t[r],t[r]=-1-i,r=i;return e},i.permutetranspose=function(e,t){for(var n=e.length;n-- >0;)e[n]=i.permute(e[n],t);return e},i.stablepermute=function(e,t){var n=i.permute(e,t);return n[0]>n[n.length-1]&&n.reverse(),n},i.sort_order=function(e){return i.permutation(0,e.length).sort((function(t,n){return e[t]-e[n]}))},i.sort_order_ascending=i.sort_order,i.sort_order_descending=function(e){return i.permutation(0,e.length).sort((function(t,n){return e[n]-e[t]}))},"undefined"==typeof r&&((r={version:"1.9.1"}).stats={}),r.stats.hcluster=function(){var e=i.distance.euclidean,t="single",n=null;function r(r){var a,i,o,s,c,l,u,d,h=r.length,f=[],g=[],_=[],v=0;if(null===n)for(n=[],u=-1;++u<h;)for(f[u]=0,n[u]=[],d=-1;++d<h;)n[u][d]=u===d?1/0:e(r[u],r[d]),n[u][f[u]]>n[u][d]&&(f[u]=d);else{if(n.length<h||n[0].length<h)throw{error:"Provided distance matrix length "+n.length+" instead of "+h};for(u=-1;++u<h;)for(f[u]=0,d=-1;++d<h;)u===d&&(n[u][d]=1/0),n[u][f[u]]>n[u][d]&&(f[u]=d)}for(u=-1;++u<h;)u!=v&&console.log("i = %d, id = %d",u,v),_[u]=[],_[u][0]={left:null,right:null,dist:0,centroid:r[u],id:v++,size:1,depth:0},g[u]=1;for(c=0;c<h-1;c++){for(a=0,u=0;u<h;u++)n[u][f[u]]<n[a][f[a]]&&(a=u);i=f[a];var m={left:o=_[a][0],right:s=_[i][0],dist:n[a][i],centroid:p(o.size,o.centroid,s.size,s.centroid),id:v++,size:o.size+s.size,depth:1+Math.max(o.depth,s.depth)};for(_[a].splice(0,0,m),g[a]+=g[i],d=0;d<h;d++)switch(t){case"single":n[a][d]>n[i][d]&&(n[d][a]=n[a][d]=n[i][d]);break;case"complete":n[a][d]<n[i][d]&&(n[d][a]=n[a][d]=n[i][d]);break;case"average":n[d][a]=n[a][d]=(g[a]*n[a][d]+g[i]*n[i][d])/(g[a]+g[d])}for(n[a][a]=1/0,u=0;u<h;u++)n[u][i]=n[i][u]=1/0;for(d=0;d<h;d++)f[d]==i&&(f[d]=a),n[a][d]<n[a][f[a]]&&(f[a]=d);l=m}return l}return r.linkage=function(e){return arguments.length?(t=e,r):t},r.distance=function(t){return arguments.length?(e=t,r):e},r.distanceMatrix=function(e){return arguments.length?(n=e.map((function(e){return e.slice(0)})),r):n},r},i.optimal_leaf_order=function(){var e=null,t=i.distance.euclidean,n="complete",a={},o={};function s(e){return null===e?[]:e.id in a?a[e.id]:a[e.id]=function(e){return null===e?[]:0===e.depth?[e.id]:s(e.left).concat(s(e.right))}(e)}function c(t,n,r){var a="k"+t.id+"-"+n+"-"+r;return a in o?o[a]:o[a]=function(t,n,r){if(0===t.depth)return[0,[t.id]];var a,i,o=t.left,l=t.right,u=s(o),d=s(l);if(-1!==u.indexOf(n)&&-1!==d.indexOf(r))a=o,i=l;else{if(-1===d.indexOf(n)||-1===u.indexOf(r))throw{error:"Node is not common ancestor of "+n+", "+r};a=l,i=o}var h=s(a.left),f=s(a.right),g=-1!=f.indexOf(n)?h:f;0===g.length&&(g=[n]);var p=s(i.left),_=s(i.right),v=-1!=_.indexOf(r)?p:_;0===v.length&&(v=[r]);for(var m=1/0,y=[],x=0;x<g.length;x++)for(var b=c(a,n,g[x]),w=0;w<v.length;w++){var C=c(i,v[w],r),S=b[0]+e[g[x]][v[w]]+C[0];S<m&&(m=S,y=b[1].concat(C[1]))}return[m,y]}(t,n,r)}function l(t){a={},o={};var n=1/0,r=[],l=s(t.left),u=s(t.right);i.debug&&console.log(i.printhcluster(t,0));for(var d=0;d<l.length;d++)for(var h=0;h<u.length;h++){var f=c(t,l[d],u[h]);f[0]<n&&(n=f[0],r=f[1])}return e=null,r}function u(a){null===e&&(e=i.dist().distance(t)(a));var o=r.stats.hcluster().linkage(n).distanceMatrix(e)(a);return console.log("hcluster",r.stats.hcluster()),console.log("distancematrix, hcluster_result",e,o),l(o)}return u.order=l,u.reorder=u,u.distance=function(n){return arguments.length?(t=n,e=null,u):t},u.linkage=function(e){return arguments.length?(n=e,u):n},u.distance_matrix=function(t){return arguments.length?(e=t.map((function(e){return e.slice(0)})),u):e},u.distanceMatrix=u.distance_matrix,u},i.order=function(){var e,t=i.distance.euclidean,n=i.optimal_leaf_order,r="complete",a=null,o=[],s=0,c=1/0;function l(l){e=l,c=Math.min(c,l.length);var d,h,f,g=s>0?s-1:0,_=c<e.length?c+1:c;for(d=o.length-1;d>0;d-=2)h=o[d-1],(f=o[d])>=_?_>c?(_=Math.min(_,h+1),o.splice(d-1,2)):f=_:h<=g?g<s?(g=Math.max(g,f-1),o.splice(d-1,2)):h=g:f-h<3&&o.splice(d-1,2);try{return function(t,n){var r,l,d,h,f=e;if(e=e.slice(t,n),0===s&&c==e.length)return u();i.debug&&console.log("i0="+t+" j0="+n);null!==a?(n!==e.length&&i.dist_remove(a,n,e.length),t>0&&i.dist_remove(a,0,t)):p();var g=i.distmax(a);if(t<s){for(l=a[0],d=l.length;d-- >1;)l[d]+=g;for(d=a.length;d-- >1;)a[d][0]+=g;if(g+=g,0!==t)for(d=0;d<o.length;d++)o[d]-=t}if(n>c)for(h=a.length-1,l=a[h],d=h;d-- >0;)l[d]+=g,a[d][h]+=g;r=u(),t<s?(0!==r[0]&&r.reverse(),n>c?i.assert(0===r[0]&&r[r.length-1]==r.length-1,"Invalid constrained permutation endpoints"):i.assert(0===r[0],"Invalid constrained permutation start")):n>c&&(r[r.length-1]!==r.length-1&&(r=r.reverse()),i.assert(r[r.length-1]==r.length-1,"Invalid constrained permutation end"));0!==t&&(r=i.permutation(t).concat(r.map((function(e){return e+t}))));f.length>n&&(r=r.concat(i.range(n,f.length)));return r}(g,_)}finally{t=i.distance.euclidean,n=i.optimal_leaf_order,r="complete",a=null,e=null,o=[],s=0,c=1/0}}function u(){var t,n,r,s,c,l;if(0===o.length)return d();for(p(),n=o.length-1;n>0;n-=2)s=o[n-1],c=o[n],a=i.dist_remove(a,s+1,c-1),e.splice(s+1,c-s-2),i.debug&&console.log("Except["+s+", "+c+"]"),0!==a[s][s+1]&&(a[s][s+1]=a[s+1][s]=-1);for(t=d(),n=0;n<o.length;n+=2){for(s=o[n],c=o[n+1],r=0;r<t.length;r++)t[r]>s?t[r]+=c-s-2:t[r]==s&&(l=r);if(l>0&&t[l-1]==c-1)Array.prototype.splice.apply(t,[l,0].concat(i.range(c-2,s,-1)));else{if(t[l+1]!=c-1)throw"Range not respected";Array.prototype.splice.apply(t,[l+1,0].concat(i.range(s+1,c-1)))}}return t}function d(){var t,o,s,c,l,u,d,f,_=!1,v=[],m={};for(p(),l=0;l<a.length-1;l++){for(s=[],-1!==(c=(o=a[l]).indexOf(-1))&&(m[l]=[l,c],_=!0),u=o.length;--u>l;)0===o[u]?(-1!==(c=a[u].indexOf(-1))&&(m[l]=[u,c],a[c][l]=o[c]=-1,_=!0),s.unshift(u),a=i.dist_remove(a,u),e.splice(u,1)):o[u]<0&&(_=!0);0!==s.length&&(s.unshift(l),v.push(s))}if(_)for(l=0;l<a.length-1;l++)for(o=a[l],u=l+1;u<o.length-1;u++)-1==a[u][u+1]&&(a[u+1][u]=a[u][u+1]=0);for(t=function(){i.debug>1&&i.printmat(a);i.debug>2&&i.printmat(e);var t=n().linkage(r).distanceMatrix(a)(e);i.debug&&console.log("Permutation: "+t);return t}(),l=v.length;l-- >0;)for(s=v[l],u=t.indexOf(s[0]),(d=m[s[0]])&&d[0]==s[0]&&(u=h(t,u,d[0],d[1],0),d=void 0),f=1;f<s.length;f++)t=g(t,u,s[f]),d&&d[0]==s[f]&&(u=h(t,u,d[0],d[1],f),d=void 0);return t}function h(e,t,n,r,a){if(t>0&&e[t-1]==r)return f(e,t,e.indexOf(n)),t+1;if(e[t+a+1]==r)return f(e,t+a,e.indexOf(n)),t;throw"Index not found"}function f(e,t,n){if(t!=n){var r=e[t];e[t]=e[n],e[n]=r}}function g(e,t,n){return(e=e.map((function(e){return e<n?e:e+1}))).splice(t,0,n),e}function p(){return null===a&&(a=i.dist().distance(t)(e)),a}return l.distance=function(e){return arguments.length?(t=e,l):t},l.linkage=function(e){return arguments.length?(r=e,l):r},l.limits=function(e,t){return arguments.length?(s=e,c=t,l):[s,c]},l.except=function(e){return arguments.length?(o=e.sort((function(e,t){if(e>=t)throw"Invalid list, indices not sorted";return e-t})),l):o.slice(0)},l.orderrowsexcept=l.orderexcept,l},i.covariance=i.dot,i.covariancetranspose=function(e,t,n){var r,a=e.length,i=0;for(r=0;r<a;r++)i+=e[r][t]*e[r][n];return i},i.variancecovariance=function(e){var t,n,r=e[0].length,a=Array(r);for(t=0;t<r;t++)a[t]=Array(r);for(t=0;t<r;t++)for(n=t;n<r;n++)a[t][n]=a[n][t]=i.covariancetranspose(e,t,n);return a},i.laplacian=function(e,t){var n,r,a,o,c,l,u,d,h=t.length,f=i.zeroes(h,h),g=s(t);for(i.assert(!e.directed(),"Laplacian only for undirected graphs"),n=0;n<h;n++){for(l=t[n],a=f[n],o=0,c=e.edges(l),r=0;r<c.length;r++)u=c[r],(d=g[e.other(u,l).index])!=n&&(o+=u.value,a[d]=-u.value);a[n]=o}return f},i.poweriteration=function(e,t,n){t||(t=1e-9);var r,a,o,s=e.length,c=Array(s),l=100;for(i.assert(s==e[0].length,"poweriteration needs a square matrix"),_(r=n?n.slice():i.random_array(s));l-- >0;){for(a=0;a<s;a++)for(c[a]=0,o=0;o<s;o++)c[a]+=e[a][o]*r[o];if(_(c),i.dot(c,r)>1-t)break;var u=c;c=r,r=u}return c},i.poweriteration_n=function(e,t,n,r,a){r||(r=1e-9);var o,s,c,l,u,d,h,f=e.length,g=Array(t),p=Array(f),v=100,m=Array(t);if(i.assert(f==e[0].length,"poweriteration needs a square matrix"),n)for(o=0;o<t;o++)g[o]=n[o].slice(),m[o]=_(g[o]);else for(o=0;o<t;o++)h=g[o]=i.random_array(f),m[o]=_(h);for(a||(a=0),c=a;c<t;c++){for(u=g[c];v-- >0;){for(l=0;l<c;l++)for(h=g[l],d=i.dot(u,h),o=0;o<f;o++)u[o]-=d*h[o];for(o=0;o<f;o++)for(p[o]=0,s=0;s<f;s++)p[o]+=e[o][s]*u[s];if(m[c]=_(p),i.dot(p,u)>1-r)break;u=p,p=g[c],g[c]=u}i.debug&&console.log("eig[%d]=%j",c,u)}return[g,m]},i.fiedler_vector=function(e,t){var n,r,a,o=function(e){var t,n,r,a,o=0,s=e.length;for(t=0;t<s;t++){for(r=(a=e[t])[t],n=0;n<s;n++)n!=t&&(r+=Math.abs(a[n]));r>o&&(o=r)}return i.debug&&console.log("gershgorin_bound=%d",o),o}(e),s=e.length,c=e.map((function(e){return e.slice()}));for(n=0;n<s;n++)for(a=c[n],r=0;r<s;r++)a[r]=n==r?o-a[r]:-a[r];var l=[i.array1d(s,1),i.random_array(s)];return i.poweriteration_n(c,2,l,t,1)[0][1]},i.spectral_order=function(e,t){var n,r,a,o,s=[];for(t||(t=e.components()),n=0;n<t.length;n++)a=t[n],r=i.fiedler_vector(i.laplacian(e,a)),o=i.sort_order(r),s=s.concat(i.permute(a,o));return s},i.pca1d=function(e,t){e.length;if(0===e.length)return null;e=function(e){var t=e.length;if(0===t)return null;var n,r,a,o=i.meancolumns(e),s=o.length,c=Array(t);for(n=0;n<t;n++){for(a=e[n].slice(0),r=0;r<s;r++)a[r]-=o[r];c[n]=a}return c}(e);var n=i.variancecovariance(e);return i.poweriteration(n,t)},i.pca_order=function(e,t){return i.sort_order(i.pca1d(e,t))},i.ca_decorana=v,i.ca=v,i.ca_order=function(e){var t=i.ca(e);return{rows:i.sort_order(t.rows),cols:i.sort_order(t.cols),details:t}},i.cuthill_mckee=function(e,t){if(t.length<3)return t;e.nodes();var n,r,i=t[0],o=e.degree(i),c={},l=new a,u=s(t),d=[];for(n=0;n<t.length&&(r=t[n],!(e.degree(r)<o&&(o=e.degree(r),i=r,1==o)));n++);for(l.push(i);0!==l.length;)r=l.shift(),c[r]||(c[r]=!0,d.push(r),e.edges(r).map((function(t){return e.other(t,r).index})).filter((function(e){return!c[e]&&e in u})).sort((function(t,n){return e.degree(t)-e.degree(n)})).forEach(l.push,l));return d},i.reverse_cuthill_mckee=function(e,t){return i.cuthill_mckee(e,t).reverse()},i.cuthill_mckee_order=function(e,t){var n,r,a=[];for(t||(t=e.components()),n=0;n<t.length;n++)r=t[n],a=a.concat(i.cuthill_mckee(e,r));return a},i.reverse_cuthill_mckee_order=function(e,t){var n,r,a=[];for(t||(t=e.components()),n=0;n<t.length;n++)r=t[n],a=a.concat(i.reverse_cuthill_mckee(e,r));return a},i.condition=function(e){var t,n,r,a,i,o,s,c=[];for(t=0;0<e.length;t++){for((s=e[t].slice()).push(c),n=0;n<c.length;n++)if(null!==(i=s[n])){r=a=s[n];break}for(;n<c.length;n++)(i=s[n])<r?r=i:i>a&&(a=i);for(o=a!=r?1/(a-r):0,n=1;n<c.length;n++)null!==(i=s[n])&&i>=i?s[n]=s[n]*o-r:i=NaN}return c},i.array_to_dicts=function(e,t){arguments.length<2&&(t=i.range(e[0].length));var n,r,a,o,s=[];for(a=0;a<e.length;a++){for(n=e[a],r={},o=0;o<n.length;o++)r[t[o]]=n[o];s.push(r)}return s},i.dicts_to_array=function(e,t){arguments.length<2&&(t=Object.keys(e[0]));var n,r,a,i=t.length,o=e.length,s=Array(o);for(n=0;n<o;n++)for(a=Array(i),s[n]=a,r=0;r<i;r++)a[r]=e[n][t[r]];return s},i.pcp=function(e,t){t||(t=i.range(e[0].length));var n=i.transpose(e),a=i.correlation.pearsonMatrix(n),o=C(a),s=(r.stats.hcluster().linkage("complete").distanceMatrix(o)(n),i.optimal_leaf_order().distanceMatrix(o)(n)),c=i.permute(t,s);n=i.permute(n,s);var l=S(s,0,a);return[i.transpose(n),s,c,l,a]},i.parcoords=function(e){e.detectDimensions().autoscale();var t,n,a,o,s=e.data(),c=e.types(),l=e.dimensions(),u=[],d=[];for(n=0;n<l.length;n++)if("number"==c[o=l[n]]){for(t=[],a=0;a<s.length;a++)t.push(s[a][o]);u.push(t)}else if("date"==c[o]){for(t=[],a=0;a<s.length;a++)t.push(.001*s[a][o].getTime());u.push(t)}else l.splice(n,1),d.push(o),n--;var h=i.correlation.pearsonMatrix(u),f=C(h),g=(r.stats.hcluster().linkage("complete").distanceMatrix(f)(u),i.optimal_leaf_order().distanceMatrix(f)(u));i.permute(l,g),u=i.permute(u,g);var p=S(g,0,h);for(n=0;n<p.length;n++)p[n]<0&&e.flip(l[n]);return l=d.reverse().concat(l),e.dimensions(l)},t.default=i},248:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){var r=n(27);!function(){function e(e){return e.length?r.keys(e[0]).sort():[]}function t(){r.event.stopPropagation(),r.event.preventDefault()}function n(e){return e.name}function a(e){return e[0].categories.reduce((function(e,t){return e+t.count}),0)}r.parsets=function(){var i,o,f,g,p=r.dispatch("sortDimensions","sortCategories","ribbonClick","categoryClick"),_=e,v=String,m=d,y=h,x=20,b=1,w=500;function C(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function S(e){return"function"===typeof e?e:function(){return e}}function k(e){e.each((function(e,s){var d,h,v,C,S=r.select(this),k=r.scaleOrdinal(),N=!1,D=_.call(this,e,s),G=[],A={children:{},count:0};if(r.select(window).on("mousemove.parsets."+ ++c,J),null==g&&(g=b),S.selectAll(".ribbon, .ribbon-mouse").data(["ribbon","ribbon-mouse"],String).enter().append("g").attr("class",String),function(){var s=S.selectAll("g.dimension"),c={};s.each((function(e){c[e.name]=e})),D.forEach((function(e){c.hasOwnProperty(e)||(c[e]={name:e,categories:[]}),G.push(c[e])})),G.sort(T),S.select(".ribbon").selectAll("path").each((function(e){for(var t=e.path.split("\0"),n=A,r=t.length-1,a=0;a<r;a++){var i=t[a];n=n.children.hasOwnProperty(i)?n.children[i]:n.children[i]={children:{},count:0}}n.children[e.name]=e})),A=l(A,e,G.map(n),i),c=G.map((function(e){var t={};return e.categories.forEach((function(e){t[e.name]=e})),t})),function e(t,n){if(t.children){var r=G[n],a=c[n];for(var i in t.children)a.hasOwnProperty(i)||r.categories.push(a[i]={name:i}),e(t.children[i],n+1)}}(A,0),G.forEach((function(e,t){G[t].categories=e.categories.sort((function(e,t){return e.name<t.name?-1:1}))})),k.domain([]).range(r.range(G[0].categories.length)),d=O(A,G,k),h=a(G),G.forEach((function(e){e.count=h}));var g=(s=s.data(G,n)).enter().append("g").attr("class","dimension").attr("transform",(function(e){return"translate(0,"+e.y+")"})).on("mousedown.parsets",t);s.merge(g).each((function(e){e.y0=e.y,e.categories.forEach((function(e){e.x0=e.x}))})),g.append("rect").attr("width",o).attr("y",-45).attr("height",45);var _=g.append("text").attr("class","dimension").attr("transform","translate(0,-25)");_.append("tspan").attr("class","name").text(L),_.append("tspan").attr("class","sort alpha").attr("dx","2em").text("alpha \xbb").on("mousedown.parsets",t),_.append("tspan").attr("class","sort size").attr("dx","2em").text("size \xbb").on("mousedown.parsets",t),s.merge(g).call(r.drag().on("start",(function(e){N=!0,e.y0=e.y})).on("drag",(function(t){t.y0=t.y=r.event.y;for(var o=1;o<G.length;o++)if(f*G[o].y<f*G[o-1].y){G.sort(T),D=G.map(n),k.domain([]).range(r.range(G[0].categories.length)),d=O(A=l({children:{},count:0},e,D,i),G,k),h=a(G),S.selectAll(".ribbon, .ribbon-mouse").selectAll("path").remove(),q(s.merge(g)),R(),s.merge(g).transition().duration(w).attr("transform",u).tween("ribbon",W),p.call("sortDimensions");break}r.select(this).attr("transform","translate(0,"+t.y+")").transition(),v.merge(C).filter((function(e){return e.source.dimension===t||e.target.dimension===t})).attr("d",I)})).on("end",(function(e){N=!1,J();var t=(f-45-2)/(G.length-1);G.forEach((function(e,n){e.y=45+n*t})),P(r.select(this)).attr("transform","translate(0,"+e.y+")").tween("ribbon",W)}))),s.merge(g).select("text").select("tspan.sort.alpha").on("click.parsets",H("alpha",(function(e,t){return e.name<t.name?1:-1}),s)),s.merge(g).select("text").select("tspan.sort.size").on("click.parsets",H("size",(function(e,t){return e.count-t.count}),s)),s.merge(g).transition().duration(w).attr("transform",(function(e){return"translate(0,"+e.y+")"})).tween("ribbon",W),s.exit().remove(),q(s.merge(g)),R()}(),b!=g){var V=r.transition(S);V.tween?V.tween("ribbon",F):F()(1)}function F(){var e=r.interpolateNumber(g,b);return function(t){g=e(t),v.merge(C).attr("d",I)}}function H(e,t,n){return function(a){var i=this.__direction=-(this.__direction||1);r.select(this).text(i>0?e+" \xbb":"\xab "+e),a.categories.sort((function(){return i*t.apply(this,arguments)})),d=O(A,G,k),R(),q(n.merge(n.enter())),p.call("sortCategories")}}function R(){v=S.select(".ribbon").selectAll("path").data(d,(function(e){return e.path})),(C=v.enter().append("path").each((function(e){e.source.x0=e.source.x,e.target.x0=e.target.x}))).merge(v).attr("class",(function(e){return"category-"+e.major})).attr("d",I),C.merge(v).sort((function(e,t){return t.count-e.count})),v.exit().remove();var e=S.select(".ribbon-mouse").selectAll("path").data(d,(function(e){return e.path})),t=e.enter().append("path");t.merge(e).on("mousemove.parsets",(function(e){B(v.merge(C)).classed("active",!1),N||(U(e=e.node,!0),E(m.call(this,e)),r.event.stopPropagation())})).on("click.parsets",(function(e){v.merge(C).classed("active",!1),v.merge(C).classed("selected",!1),N||(K(e=e.node,!0),p.call("ribbonClick",this,{data:e,selected:!0}),r.event.stopPropagation())})),e.merge(t).sort((function(e,t){return t.count-e.count})).attr("d",j),e.exit().remove()}function z(e){var t=[e],n=v.merge(C).filter((function(n){var r,a;return n.source.node===e&&t.push(r=n.source),n.target.node===e&&t.push(a=n.target),r||a})),a=t.map((function(e){return r.interpolateNumber(e.x0,e.x)})),i=t.length;return function(e){for(var r=0;r<i;r++)t[r].x0=a[r](e);n.attr("d",I)}}function W(e){var t=v.merge(C).filter((function(t){return t.source.dimension.name==e.name||t.target.dimension.name==e.name})),n=r.interpolateNumber(e.y0,e.y);return function(r){e.y0=n(r),t.attr("d",I)}}function U(e,t){if(!N){var n=[];if(function e(t){for(var r in n.push(t),t.children)e(t.children[r])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(C).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("active",!0)}}function K(e,t){if(!N){var n=[];if(function e(t){for(var r in n.push(t),t.children)e(t.children[r])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(C).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("selected",!0).classed("active",!0)}}function B(e){return e.filter((function(e){return!r.select(this).classed("selected")}))}function J(){N||(B(v.merge(C)).classed("active",!1),M.style("display","none"))}function q(e){var n=e.selectAll("g.category").data((function(e){return e.categories}),(function(e){return e.dimension.name+"_"+e.name})),a=n.enter().append("g").attr("class","category");a.merge(n).attr("transform",(function(e){return"translate("+e.x+")"})),n.merge(a).on("mousemove.parsets",(function(e){B(v.merge(C)).classed("active",!1),N||(e.nodes.forEach((function(e){U(e)})),E(y.call(this,e)),r.event.stopPropagation())})).on("mouseout.parsets",J).on("mousedown.parsets",t).call(r.drag().on("start",(function(e){N=!0,e.x0=e.x})).on("drag",(function(t){t.x=r.event.x;for(var n=t.dimension.categories,a=0,i=n[0];++a<n.length;)if(i.x+i.dx/2>(i=n[a]).x+i.dx/2){n.sort((function(e,t){return e.x+e.dx/2-t.x-t.dx/2})),d=O(A,G,k),R(),q(e),U(t.node),p.call("sortCategories");break}var s=0,c=x/(n.length-1);n.forEach((function(e){t===e&&(e.x0=r.event.x),e.x=s,s+=e.count/h*(o-x)+c})),r.select(this).attr("transform",(function(e){return"translate("+e.x0+")"})).transition(),v.merge(C).filter((function(e){return e.source.node===t||e.target.node===t})).attr("d",I)})).on("end",(function(e){N=!1,J(),R(),P(r.select(this)).attr("transform","translate("+e.x+")").tween("ribbon",z)}))).on("click.parsets",(function(e){N||(v.merge(C).classed("active",!1),v.merge(C).classed("selected",!1),e.nodes.forEach((function(e){K(e)})),p.call("categoryClick",this,{data:e,selected:!0}),r.event.stopPropagation())})),n.merge(a).transition().duration(w).attr("transform",(function(e){return"translate("+e.x+")"})).tween("ribbon",z),a.append("rect").attr("width",(function(e){return e.dx})).attr("y",-20).attr("height",20),a.append("line").style("stroke-width",2),a.append("text").attr("dy","-.3em"),n.merge(a).select("rect").attr("width",(function(e){return e.dx})).attr("class",(function(e){return"category-"+(e.dimension===G[0]?k(e.name):"background")})),n.merge(a).select("line").attr("x2",(function(e){return e.dx})),n.merge(a).select("text").text(function(e,t){return function(n,r){var a=this.textContent=e(n,r),i=t(n,r);if(this.getComputedTextLength()<i)return a;this.textContent="\u2026"+a;for(var o=0,s=a.length+1;o<s;){var c=o+s>>1;this.getSubStringLength(0,c)<i?o=c+1:s=c}return o>1?a.substr(0,o-2)+"\u2026":""}}((function(e){return e.name}),(function(e){return e.dx})))}}))}r.rebind=function(e,t){for(var n,r=1,a=arguments.length;++r<a;)e[n=arguments[r]]=C(e,t,t[n]);return e},k.dimensionFormat=function(e){return arguments.length?(v=e,k):v},k.dimensions=function(e){return arguments.length?(_=S(e),k):_},k.value=function(e){return arguments.length?(i=S(e),k):i},k.width=function(e){return arguments.length?(o=+e,k):o},k.height=function(e){return arguments.length?(f=+e,k):f},k.spacing=function(e){return arguments.length?(x=+e,k):x},k.tension=function(e){return arguments.length?(b=+e,k):b},k.duration=function(e){return arguments.length?(w=+e,k):w},k.tooltip=function(e){return arguments.length?(m=null==e?d:e,k):M},k.categoryTooltip=function(e){return arguments.length?(y=null==e?h:e,k):y};var N=r.select("body"),M=N.append("div").style("display","none").attr("class","parsets tooltip");return r.rebind(k,p,"on").value(1).width(960).height(600);function L(e,t){return v.call(this,e.name,t)}function E(e){var t=r.mouse(N.node());M.style("display",null).style("left",t[0]+30+"px").style("top",t[1]-20+"px").html(e)}function P(e){return w?e.transition().duration(w).ease(s):e}function O(e,t,n){var r=[],a=t.length,i=(f-45-2)/(a-1);t.forEach((function(e,t){e.categories.forEach((function(t){t.dimension=e,t.count=0,t.nodes=[]})),e.y=45+t*i}));var s=function e(n,r){if(!n.children)return n.count;var a=t[r],i=0;return a.categories.forEach((function(t){var a=n.children[t.name];if(a){t.nodes.push(a);var o=e(a,r+1);t.count+=o,i+=o}})),i}(e,0);return t.forEach((function(e){e.categories=e.categories.filter((function(e){return e.count}));var t=0,n=x/(e.categories.length-1);e.categories.forEach((function(e){e.x=t,e.dx=e.count/s*(o-x),e.in={dx:0},e.out={dx:0},t+=e.dx+n}))})),t[0].categories.forEach((function(a){var i=a.name;e.children.hasOwnProperty(i)&&function e(n,a,i,c){var l=a.node,u=t[i];u.categories.forEach((function(d){var h=d.name;if(l.children.hasOwnProperty(h)){var f=l.children[h];f.path=a.path+"\0"+h;var g=f.target||{node:d,dimension:u};g.x=d.in.dx,g.dx=f.count/s*(o-x),d.in.dx+=g.dx;var p=f.source||{node:n,dimension:t[i-1]};p.x=n.out.dx,p.dx=g.dx,n.out.dx+=p.dx,f.node=f,f.source=p,f.target=g,f.major=c,r.push(f),i+1<t.length&&e(d,f,i+1,c)}}))}(a,{node:e.children[i],path:i},1,n(i))})),r}function I(e){var t=e.source,n=e.target;return D(t.node.x0+t.x0,t.dimension.y0,t.dx,n.node.x0+n.x0,n.dimension.y0,n.dx,g)}function j(e){var t=e.source,n=e.target;return D(t.node.x+t.x,t.dimension.y,t.dx,n.node.x+n.x,n.dimension.y,n.dx,b)}function D(e,t,n,r,a,i,o){var s,c;return(1===o?["M",[e,t],"L",[r,a],"h",i,"L",[e+n,t],"Z"]:["M",[e,t],"C",[e,s=o*t+(1-o)*a]," ",[r,c=o*a+(1-o)*t]," ",[r,a],"h",i,"C",[r+i,c]," ",[e+n,s]," ",[e+n,t],"Z"]).join("")}function T(e,t){return(e=f*e.y)<(t=f*t.y)?-1:e>t?1:e>=t?0:e<=e?-1:t<=t?1:NaN}},r.parsets.tree=l;var i=r.format(".2%"),o=r.format("d"),s=r.easeElastic,c=0;function l(e,t,n,r){!function e(t){if(t.count=0,t.children)for(var n in t.children)e(t.children[n])}(e);for(var a=t.length,i=n.length,o=0;o<a;o++){for(var s=t[o],c=+r(s,o),l=e,u=0;u<i;u++){var d=n[u],h=s[d],f=l.children;l.count+=c,l=f.hasOwnProperty(h)?f[h]:f[h]={children:u===i-1?null:{},count:0,parent:l,dimension:d,name:h}}l.count+=c}return e}function u(e){return"translate(0,"+e.y+")"}function d(e){for(var t=e.count,n=[];e.parent;)e.name&&n.unshift(e.name),e=e.parent;return n.join(" \u2192 ")+"<br>"+o(t)+" ("+i(t/e.count)+")"}function h(e){return e.name+"<br>"+o(e.count)+" ("+i(e.count/e.dimension.count)+")"}}()},286:function(e,t,n){},289:function(e,t,n){"use strict";n.r(t);var r=n(27),a=n(170),i=n.n(a);t.default=function(){var e,t=[],n=75,a=!0,o=!1,s=!0,c={start:function(){},draw:function(){},end:function(){}};function l(l){var u,d,h,f,g=l.append("g").attr("class","lasso"),p=g.append("path").attr("class","drawn"),_=g.append("path").attr("class","loop_close"),v=g.append("circle").attr("class","origin"),m=r.drag().on("start",(function(){f=[],u="",p.attr("d",null),_.attr("d",null),t.nodes().forEach((function(e){e.__lasso.possible=!1,e.__lasso.selected=!1,e.__lasso.hoverSelect=!1,e.__lasso.loopSelect=!1;var t=e.getBoundingClientRect();e.__lasso.lassoPoint=[Math.round(t.left+t.width/2),Math.round(t.top+t.height/2)]})),s&&t.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0}));c.start()})).on("drag",(function(){var e,s;"touchmove"===r.event.sourceEvent.type?(e=r.event.sourceEvent.touches[0].clientX,s=r.event.sourceEvent.touches[0].clientY):(e=r.event.sourceEvent.clientX,s=r.event.sourceEvent.clientY);var l=r.mouse(this)[0],g=r.mouse(this)[1];""===u?(u=u+"M "+l+" "+g,d=[e,s],h=[l,g],v.attr("cx",l).attr("cy",g).attr("r",7).attr("display",null)):u=u+" L "+l+" "+g;f.push([e,s]);var m=Math.sqrt(Math.pow(e-d[0],2)+Math.pow(s-d[1],2)),y="M "+l+" "+g+" L "+h[0]+" "+h[1];p.attr("d",u),_.attr("d",y),(o=m<=n)&&a?_.attr("display",null):_.attr("display","none");t.nodes().forEach((function(e){e.__lasso.loopSelect=!(!o||!a)&&i()(f,e.__lasso.lassoPoint)<1,e.__lasso.possible=e.__lasso.hoverSelect||e.__lasso.loopSelect})),c.draw()})).on("end",(function(){t.on("mouseover.lasso",null),t.nodes().forEach((function(e){e.__lasso.selected=e.__lasso.possible,e.__lasso.possible=!1})),p.attr("d",null),_.attr("d",null),v.attr("display","none"),c.end()}));e.call(m)}return l.items=function(e){if(!arguments.length)return t;var n=(t=e).nodes();return n.forEach((function(e){e.__lasso={possible:!1,selected:!1}})),l},l.possibleItems=function(){return t.filter((function(){return this.__lasso.possible}))},l.selectedItems=function(){return t.filter((function(){return this.__lasso.selected}))},l.notPossibleItems=function(){return t.filter((function(){return!this.__lasso.possible}))},l.notSelectedItems=function(){return t.filter((function(){return!this.__lasso.selected}))},l.closePathDistance=function(e){return arguments.length?(n=e,l):n},l.closePathSelect=function(e){return arguments.length?(a=!0===e,l):a},l.isPathClosed=function(e){return arguments.length?(o=!0===e,l):o},l.hoverSelect=function(e){return arguments.length?(s=!0===e,l):s},l.on=function(e,t){if(!arguments.length)return c;if(1===arguments.length)return c[e];var n=["start","draw","end"];return n.indexOf(e)>-1&&(c[e]=t),l},l.targetArea=function(t){return arguments.length?(e=t,l):e},l}},295:function(e,t,n){var r=r||{REVISION:"ALPHA"};!function(e){"use strict";var t=function(e,t){if(!e)throw t||"Assertion failed"},n=function(e,t,n){return e.hasOwnProperty(t)?e[t]:n},r=!1,a=0,i=function(e,t){return e+function e(){if(r)return r=!1,a;var t=2*Math.random()-1,n=2*Math.random()-1,i=t*t+n*n;if(0==i||i>1)return e();var o=Math.sqrt(-2*Math.log(i)/i);return a=n*o,r=!0,t*o}()*t},o=function(e){if("undefined"===typeof e||isNaN(e))return[];if("undefined"===typeof ArrayBuffer){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t}return new Float64Array(e)},s=function(e,t,n){for(var r="undefined"!==typeof n,a=[],o=0;o<e;o++){for(var s=[],c=0;c<t;c++)r?s.push(n):s.push(i(0,1e-4));a.push(s)}return a},c=function(e,t){for(var n=e.length,r=0,a=0;a<n;a++){var i=e[a],o=t[a];r+=(i-o)*(i-o)}return r},l=function(e,n,r){var a=Math.sqrt(e.length),i=Math.floor(a);t(i===a,"D should have square number of elements.");for(var s=Math.log(n),c=o(i*i),l=o(i),u=0;u<i;u++){for(var d=-1/0,h=1/0,f=1,g=!1,p=0;!g;){for(var _=0,v=0;v<i;v++){var m=Math.exp(-e[u*i+v]*f);u===v&&(m=0),l[v]=m,_+=m}var y=0;for(v=0;v<i;v++){if(0==_)m=0;else m=l[v]/_;l[v]=m,m>1e-7&&(y-=m*Math.log(m))}y>s?(d=f,h===1/0?f*=2:f=(f+h)/2):(h=f,d===-1/0?f/=2:f=(f+d)/2),p++,Math.abs(y-s)<r&&(g=!0),p>=50&&(g=!0)}for(v=0;v<i;v++)c[u*i+v]=l[v]}var x=o(i*i),b=2*i;for(u=0;u<i;u++)for(v=0;v<i;v++)x[u*i+v]=Math.max((c[u*i+v]+c[v*i+u])/b,1e-100);return x};function u(e){return e>0?1:e<0?-1:0}var d=function(e){e=e||{};this.perplexity=n(e,"perplexity",30),this.dim=n(e,"dim",2),this.epsilon=n(e,"epsilon",10),this.iter=0};d.prototype={initDataRaw:function(e){var n=e.length,r=e[0].length;t(n>0," X is empty? You must have some data!"),t(r>0," X[0] is empty? Where is the data?");var a=function(e){for(var t=e.length,n=o(t*t),r=0;r<t;r++)for(var a=r+1;a<t;a++){var i=c(e[r],e[a]);n[r*t+a]=i,n[a*t+r]=i}return n}(e);this.P=l(a,this.perplexity,1e-4),this.N=n,this.initSolution()},initDataDist:function(e){var n=e.length;t(n>0," X is empty? You must have some data!");for(var r=o(n*n),a=0;a<n;a++)for(var i=a+1;i<n;i++){var s=e[a][i];r[a*n+i]=s,r[i*n+a]=s}this.P=l(r,this.perplexity,1e-4),this.N=n,this.initSolution()},initSolution:function(){this.Y=s(this.N,this.dim),this.gains=s(this.N,this.dim,1),this.ystep=s(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var e=this.N,t=this.costGrad(this.Y),n=t.cost,r=t.grad,a=o(this.dim),i=0;i<e;i++)for(var s=0;s<this.dim;s++){var c=r[i][s],l=this.ystep[i][s],d=this.gains[i][s],h=u(c)===u(l)?.8*d:d+.2;h<.01&&(h=.01),this.gains[i][s]=h;var f=(this.iter<250?.5:.8)*l-this.epsilon*h*r[i][s];this.ystep[i][s]=f,this.Y[i][s]+=f,a[s]+=this.Y[i][s]}for(i=0;i<e;i++)for(s=0;s<this.dim;s++)this.Y[i][s]-=a[s]/e;return n},debugGrad:function(){for(var e=this.N,t=this.costGrad(this.Y),n=(t.cost,t.grad),r=1e-5,a=0;a<e;a++)for(var i=0;i<this.dim;i++){var o=this.Y[a][i];this.Y[a][i]=o+r;var s=this.costGrad(this.Y);this.Y[a][i]=o-r;var c=this.costGrad(this.Y),l=n[a][i],u=(s.cost-c.cost)/(2*r);console.log(a+","+i+": gradcheck analytic: "+l+" vs. numerical: "+u),this.Y[a][i]=o}},costGrad:function(e){for(var t=this.N,n=this.dim,r=this.P,a=this.iter<100?4:1,i=o(t*t),s=0,c=0;c<t;c++)for(var l=c+1;l<t;l++){for(var u=0,d=0;d<n;d++){var h=e[c][d]-e[l][d];u+=h*h}var f=1/(1+u);i[c*t+l]=f,i[l*t+c]=f,s+=2*f}for(var g=t*t,p=o(g),_=0;_<g;_++)p[_]=Math.max(i[_]/s,1e-100);var v=0,m=[];for(c=0;c<t;c++){var y=new Array(n);for(d=0;d<n;d++)y[d]=0;for(l=0;l<t;l++){v+=-r[c*t+l]*Math.log(p[c*t+l]);var x=4*(a*r[c*t+l]-p[c*t+l])*i[c*t+l];for(d=0;d<n;d++)y[d]+=x*(e[c][d]-e[l][d])}m.push(y)}return{cost:v,grad:m}}},e.tSNE=d}(r),function(t){"use strict";"undefined"===typeof e.exports?window.tsnejs=t:e.exports=t}(r)},317:function(e,t,n){},318:function(e,t,n){},319:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(5),o=n.n(i),s=(n(184),n(11)),c=n(12),l=n(9),u=n(16),d=n(17),h=n(337),f=n(166),g=n.n(f),p=(n(185),n(23)),_=n.n(p),v=n(34),m=(n(187),n(41)),y=n(334),x=n(339),b=n(335),w=n(85),C=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],S=["#498B77","#89C2AE","#C1D6D3"],k=["#3E97C7","#72B3CF","#8FCCDD","#C8DADE"],N=["#DC143C"],M=["#999999"],L=function(e,t){var n=e.length,r=1/(n-1),a=Math.floor(t/r);a==n-1&&(a-=1);var i=(t-a*r)/r;return E(e[a],e[a+1],i)},E=function(e,t,n){var r=function(e){if((e=e.toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){for(var t="#",n=1;n<4;n+=1)t+=e.slice(n,n+1).concat(e.slice(n,n+1));e=t}var r=[];for(n=1;n<7;n+=2)r.push(parseInt("0x"+e.slice(n,n+2)));return r}return e};e=e.replace(/\s+/g,""),t=t.replace(/\s+/g,"");var a=r(e),i=a[0],o=a[1],s=a[2],c=r(t),l=c[0],u=c[1],d=c[2];n>1?(console.log("out of range step: ",n),n=1):n<0&&(console.log("out of range step: ",n),n=0);var h=(u-o)*n,f=(d-s)*n,g=parseInt((l-i)*n+i),p=parseInt(h+o),_=parseInt(f+s),v="#",m=new Array;m[0]=g,m[1]=p,m[2]=_;for(var y=0;y<3;y++){var x=Number(m[y]).toString(16),b=Number(m[y])<10?"0"+x:x;"0"===b&&(b+=b),v+=b}return v},P=k[1],O=k[0],I=N[0],j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return 1===t||2===t||3===t?C[e]:5===t?e?S[0]:N[0]:void 0},D=function(e){return 0===e?k[0]:M[0]},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(1==e){if(1==t[0])return N[0];if(-1==t[0]&&-1==t[1])return k[0];if(-1==t[0]&&1==t[1])return S[0]}else if(2==e){if(1==t[0])return N[0];if(0==t[0])return k[0]}else{if(3==e){var r=1/(1+Math.exp(-t[0]));return L([O,"#FFFFFF",I],r)}if(4==e){if(0===n){var a=1/(1+Math.exp(-t));return L([O,"#FFFFFF",I],a)}if(1===n){var i=t;return i>1?(console.log("Out of Range Value: ",i),i=1):i<0&&(console.log("Out of Range Value: ",i),i=0),L(["#FFFFFF",I],i)}if(2===n){var o=t;return o>1?(console.log("Out of Range Value: ",o),o=1):o<0&&(console.log("Out of Range Value: ",o),o=0),L([O,"#FFFFFF",I],o)}}}return P},G=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(1==e||2==e||3==e){if(1==t[0])return k[2];if(-1==t[0])return M[0]}else if(4==e){if(0===n){var r=1/(1+Math.exp(-t));return L([O,"#DDDDDD",I],r)}if(1===n){var a=t;return a>1?(console.log("Out of Range Value: ",a),a=1):a<0&&(console.log("Out of Range Value: ",a),a=0),L(["#DDDDDD",I],a)}}return P};function A(e){for(var t=e.senders,n=e.receivers,r=e.feature.length,a={},i=0;i<r;i++)a[i]=[];for(var o=0;o<n.length;o++){var s=n[o];s in a||(a[s]=[]),a[s].push(t[o])}return a}function V(e){for(var t=e.senders,n=e.receivers,r=e.values,a={},i=0;i<n.length;i++){var o=n[i];o in a||(a[o]={}),a[o][t[i]]=r[i]}return a}function F(e,t){return t.has(e)?"#000":"#fff"}function H(e,t){var n=e+"/"+t;return 0===t||(n=n+" ("+(e/t*100).toFixed(2)+"%)"),n}var R=["Train","Valid","Test","Others"];function z(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}function W(e,t){return e.sort((function(e,t){return e.anchor_similarity>t.anchor_similarity?-1:1})),t<1&&(t=1),t>e.length&&(t=e.length),e=e.slice(0,t)}var U=n(330),K=n(20),B=n(6),J=n(331),q=n(338),X=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).handleOk=function(e){console.log(e),r.props.changeGraphViewSettingsModal_visible(!1)},r.handleCancel=function(e){console.log(e),r.props.changeGraphViewSettingsModal_visible(!1)},r.handleUnfocusedNodesChange=function(e){var t=e.target.checked,n=r.props.GraphViewState;r.props.changeGraphViewState(Object(B.a)(Object(B.a)({},n),{},{DisplayUnfocusedNodes:t}))},r.handleOverviewChange=function(e){var t=e.target.checked,n=r.props.GraphViewState;r.props.changeGraphViewState(Object(B.a)(Object(B.a)({},n),{},{DisplayOverview:t}))},r.state={},r}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.GraphViewState;return r.createElement(J.a,{title:"Graph View Settings",visible:this.props.GraphViewSettingsModal_visible,onOk:this.handleOk,onCancel:this.handleCancel,footer:[r.createElement(w.a,{key:"OK",type:"primary",onClick:this.handleOk},"OK")]},"Rendering Options:",r.createElement("div",null,r.createElement(q.a,{checked:e.DisplayUnfocusedNodes,onChange:this.handleUnfocusedNodesChange},"Display unfocused nodes."),r.createElement("br",null),r.createElement(q.a,{checked:e.DisplayOverview,onChange:this.handleOverviewChange},"Display overview.")))}}]),n}(r.Component),Y=function(e){return{type:"MATRIX_FILTERS_CHANGE",matrixFilters:e}},Z=function(e){return{type:"PSSETTINGMODAL_VISIBLE_CHANGE",PSSettingsModal_visible:e}},$=function(e){return{type:"GRAPHVIEWSETTINGMODAL_VISIBLE_CHANGE",GraphViewSettingsModal_visible:e}},Q=function(e){return{type:"KVALUE_CHANGE",K_value:e}},ee=function(e){return{type:"PSDIMENSIONS_CHANGE",PSDimensions:e}},te=function(e){return{type:"SELECT_INSPECT_NODE_CHANGE",select_inspect_node:e}},ne=function(e){return{type:"SHOW_SOURCE_CHANGE",showSource:e}},re=Object(K.b)((function(e){return{GraphViewSettingsModal_visible:e.GraphViewSettingsModal_visible,GraphViewState:e.GraphViewState}}),(function(e){return{changeGraphViewSettingsModal_visible:function(t){return e($(t))},changeGraphViewState:function(t){return e(function(e){return{type:"GRAPHVIEWSTATE_CHANGE",GraphViewState:e}}(t))}}}))(X),ae=(n(234),n(27)),ie="#bbb",oe=2,se="2,3",ce=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).global_simulation=null,r.saved_transform=null,r.refresh_number=0,r.updateTransform=r.updateTransform.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderCanvas()}},{key:"componentDidUpdate",value:function(e,t){e.graph_json.name===this.props.graph_json.name&&e.width===this.props.width&&e.GraphViewState===this.props.GraphViewState||this.renderCanvas()}},{key:"updateTransform",value:function(e){this.saved_transform=e}},{key:"renderLegend",value:function(e){var t=e.width,n=e.height,r=e.radius,a=e.radius_gap,i=e.colorLegend,o=e.pieLegend.pie_name,s=r-a,c=n-10-100,l=ae.select("#force_directed_graph").select("#svgChart").attr("width",t).attr("height",n),u=l.select("#ForceDirectedLegend").attr("width",100).attr("height",100).attr("transform","translate(10,"+c+")"),d=ae.pie().startAngle(-60/180*Math.PI).endAngle((2-60/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index}))([{index:0,value:1/3},{index:1,value:1/3},{index:2,value:1/3}]);var h=[{text:"Label","text-anchor":"begin","dominant-baseline":"central",y_offset:1},{text:o[0],"text-anchor":"begin","dominant-baseline":"central",y_offset:-7.5},{text:o[1],"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:o[2],"text-anchor":"begin","dominant-baseline":"central",y_offset:19}],f=0;h.forEach((function(e){var t=""+e.text;t.length>f&&(f=t.length)}));var g=8*f+80;this.refresh_number=this.refresh_number+1;var p=u.selectAll("g.legend_pie").data([this.refresh_number],(function(e){return e}));p.exit().remove();var _=p.enter().append("g").attr("class","legend_pie").attr("transform","translate(30,50)");_.append("rect").attr("x",-30).attr("y",-50).attr("width",g).attr("height",100).attr("fill","#fff").attr("opacity",.8).attr("stroke","#bbb").attr("stroke-width",1).attr("rx",3).attr("ry",3);var v=["#1f77b4","#ff7f0e","#2ca02c","#d62728"];_.append("circle").attr("class","inner_circle").attr("r",3*s).attr("fill",(function(e){return v[0]})).attr("stroke","white");for(var m=function(e){var t=_.append("path").attr("class","arc_"+e),n=_.select("path.arc_"+e);t.merge(n).style("fill",(function(t){return v[e+1]})).attr("d",function(e){return ae.arc().innerRadius(e).outerRadius(2*e)}(3*r)(d[e])).style("stroke","#ddd").style("stroke-width",1);var a=[4.5*r*Math.sin(120*e/180*Math.PI),4.5*r*-Math.cos(120*e/180*Math.PI)],i=[4.5*r*Math.sin(120*e/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+h[e+1].y_offset];1===e&&(i=[7.5*r*Math.sin(120*e/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+h[e+1].y_offset]);var o=[7.5*r*Math.sin(60/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+h[e+1].y_offset];_.append("path").attr("stroke",ie).attr("stroke-width",oe).style("stroke-dasharray",se).attr("d",function(e){for(var t="",n=0;n<e.length;n++){var r="M";n>0&&(r="L"),t=t+r+e[n][0]+" "+e[n][1]+" "}return t}([a,i,o])).attr("fill","none"),_.append("text").attr("x",o[0]).attr("y",o[1]).attr("text-anchor",h[e+1]["text-anchor"]).attr("dominant-baseline",h[e+1]["dominant-baseline"]).text(h[e+1].text)},y=0;y<3;y++)m(y);var x=7.5*r*Math.sin(60/180*Math.PI),b=7.5*r*-Math.cos(60/180*Math.PI)+h[0].y_offset;_.append("line").attr("stroke",ie).attr("stroke-width",oe).style("stroke-dasharray",se).attr("x1",0).attr("y1",0).attr("x2",x).attr("y2",b),_.append("text").attr("x",x).attr("y",b).attr("text-anchor",h[0]["text-anchor"]).attr("dominant-baseline",h[0]["dominant-baseline"]).text(h[0].text);var w=0;i.forEach((function(e){var t=""+e.text;t.length>w&&(w=t.length)}));var C=8*w+24,S=20*i.length,k=c-S-10,N=l.select("#ForceDirectedColorLegend").attr("width",C).attr("height",S).attr("transform","translate(10,"+k+")"),M=N.selectAll("rect").data([0]);M.enter().append("rect").merge(M).attr("x",0).attr("y",0).attr("width",C).attr("height",S).attr("fill","#fff").attr("opacity",.8).attr("stroke","#bbb").attr("stroke-width",1).attr("rx",3).attr("ry",3);var L=N.selectAll("g.legend_row_color").data(i,(function(e,t){return e.text+"_"+t+"_"+e.color})),E=L.enter().append("g").attr("class","legend_row_color").attr("transform",(function(e,t){return"translate(10,"+(10+20*t)+")"}));E.append("circle").attr("r",5).attr("fill",(function(e){return e.color})),E.append("text").attr("x",10).attr("y",5).text((function(e){return e.text})),L.exit().remove()}},{key:"renderCanvas",value:function(){var e=this.props.onNodeClick,t=this.props.graph_json.nodenum,n=this.props.graph_json.enable_forceDirected,r=this.props.graph_json.NeighborSet,a=this.props.graph_json.colorLegend,i=this.props.graph_json.pieLegend,o=(i.pie_name,{strength:.01,radius:15,showlabel:!0,showarrow:!0,width:this.props.width,height:this.props.height}),s=this.props.GraphViewState,c=s.DisplayUnfocusedNodes,l=s.DisplayOverview;t>=100&&(o={strength:.4,radius:3,showlabel:!1,showarrow:!1,width:this.props.width,height:this.props.height});var u=o.width,d=o.height,h=o.radius,f=this.props.width,g=ae.select("#force_directed_graph").select("#bottom").attr("width",f+"px").attr("height",d+"px").node().getContext("2d"),p=ae.select("#force_directed_graph").select("#middle").attr("width",f+"px").attr("height",d+"px").node(),_=p.getContext("2d"),v=ae.select("#force_directed_graph").select("#overview").attr("width",f+"px").attr("height",d+"px").node().getContext("2d"),m=ae.select("#force_directed_graph").select("#event").attr("width",f+"px").attr("height",d+"px").node(),y=f-100-10,x=d-100-10,b=y+100,w=x+100,C=3*h+.3*3;this.global_simulation&&(this.global_simulation.stop(),delete this.global_simulation);var S=ae.forceSimulation().force("center",ae.forceCenter(f/2,d/2)).force("x",ae.forceX(f/2).strength(.1)).force("y",ae.forceY(d/2).strength(.1)).force("charge",ae.forceManyBody().strength(-50)).force("link",ae.forceLink().strength(1).id((function(e){return e.id}))).force("collide",ae.forceCollide().radius((function(e){return C}))).alphaTarget(0).alphaDecay(.05);this.global_simulation=S;var k={width:u,height:d,radius:h,radius_gap:.3,colorLegend:a,pieLegend:i};this.renderLegend(k);var N,M=this.updateTransform,L={x:0,y:0,k:1};function E(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#bbb";e.beginPath(),e.strokeStyle=i,e.rect(t,n,r,a),e.stroke()}function P(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.8;e.fillStyle=i,e.globalAlpha=o,e.fillRect(t,n,r,a),e.globalAlpha=1}function O(e,t,n,r,a,i){e.lineWidth=i,e.strokeStyle=t,e.beginPath(),e.arc(r,a,n,0,2*Math.PI,!0),e.stroke()}function I(e,t,n,r,a){e.beginPath(),e.arc(r,a,n,0,2*Math.PI,!0),e.fillStyle=t,e.fill()}function j(e,t,n,r,a,i,o){e.beginPath(),e.moveTo(r,a),e.arc(r,a,n,i,o),e.fillStyle=t,e.closePath(),e.fill()}function D(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];I(e,t[4],a,i,o),s&&O(e,"#000",a,i,o,2),j(e,t[1],a,i,o,-150/180*Math.PI,-30/180*Math.PI),j(e,t[2],a,i,o,-30/180*Math.PI,.5*Math.PI),j(e,t[3],a,i,o,.5*Math.PI,210/180*Math.PI);for(var c=0;c<3;c++){var l=(120*c-150)/180*Math.PI,u=i+r*Math.cos(l),d=o+r*Math.sin(l),h=i+a*Math.cos(l),f=o+a*Math.sin(l);T(e,t[4],u,d,h,f,r-n)}I(e,t[4],r,i,o),I(e,t[0],n,i,o)}function T(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;e.strokeStyle=t,o&&(e.lineWidth=o),e.beginPath(),e.moveTo(n,r),e.lineTo(a,i),e.stroke()}function G(e,t){var n=e.hasOwnProperty("hover_cons")?e.hover_cons:1,r=t.hasOwnProperty("hover_cons")?t.hover_cons:1;return e.radius*n*2<e.radius*r*2?-1:1}function A(e,t){return e.hasOwnProperty("hovered")&&!1!==e.hovered?!0!==t:!1!==t}function V(){ae.select("#force_directed_graph").select("#tooltip").style("opacity",0)}N=this.saved_transform?this.saved_transform:ae.zoomIdentity;var F=this.props.graph_json,H=m,R=null;function z(e,t){var n,r,a,i=N.invertX(e),o=N.invertY(t),s=F.nodes.slice().sort(G);for(n=s.length-1;n>=0;--n){var l=s[n];if(c||l.highlight){r=i-l.x,a=o-l.y;var u=l.hasOwnProperty("hover_cons")?l.hover_cons:1,d=2*l.radius*u;if(r*r+a*a<d*d)return l}}return null}function W(e,t){return e>=y&&e<=b&&t>=x&&t<=w&&l?"OverviewCanvas":"GraphCanvas"}function U(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?e=R:(e=ae.mouse(this),R=e);var a=n;if(e){var i=W(e[0],e[1]),o=z(e[0],e[1]);if("GraphCanvas"===i&&o){a=!0;var s=o.id;ae.select("#force_directed_graph").select("#tooltip").style("opacity",.8).style("top",e[1]+5+"px").style("left",e[0]+5+"px").html(s);var c=r[o.id];F.nodes.forEach((function(e){s===e.id?(e.hovered=!0,e.hover_cons=3):c.indexOf(e.id)>=0?(e.hovered=!0,e.hover_cons=2):(e.hovered=!1,e.hover_cons=1)}))}else F.nodes.forEach((function(e){a=a||A(e,!1),e.hovered=!1,e.hover_cons=1})),V()}else F.nodes.forEach((function(e){a=a||A(e,!1),e.hovered=!1,e.hover_cons=1})),V();a&&Y()}function K(e,t){var n=e.x,r=e.y,a=e.width,i=e.height,o=-t.x,s=-t.y,c=1/t.k;return{x:(n+o)*c,y:(r+s)*c,width:a*c,height:i*c}}function B(e,t){var n=e.x,r=e.y,a=-t.x,i=-t.y,o=1/t.k;return{x:(n+a)*o,y:(r+i)*o}}function J(e,t){var n={x:f/2,y:d/2},r=B(n,N),a={x:e,y:t},i=B(a,L),o=-(i.x-r.x)*N.k+N.x,s=-(i.y-r.y)*N.k+N.y;console.log({ori_point:n,ori_inverse_point:r,overview_point:a,overview_inverse_point:i,new_x:o,new_y:s}),N.x=o,N.y=s,M(N),X()}function q(e){c&&(F.links.filter((function(e){return!e.source.highlight||!e.target.highlight})).forEach((function(t){T(e,t.color,t.source.x,t.source.y,t.target.x,t.target.y)})),F.nodes.filter((function(e){return!e.highlight})).forEach((function(t,n){var r=t.radius-.3,a=t.radius,i=2*t.radius;D(e,t.color,r,a,i,t.x,t.y)}))),F.links.filter((function(e){return!(!e.source.highlight||!e.target.highlight)})).forEach((function(t){T(e,t.color,t.source.x,t.source.y,t.target.x,t.target.y)})),F.nodes.filter((function(e){return e.highlight})).forEach((function(t,n){var r=t.radius-.3,a=t.radius,i=2*t.radius;D(e,t.color,r,a,i,t.x,t.y)}))}function X(){if(g.save(),g.clearRect(0,0,f,d),g.translate(N.x,N.y),g.scale(N.k,N.k),console.log("simulationUpdate",N),q(g),g.restore(),l){var e=function(){var e=0,t=0,n=0,r=0,a=!1;return F.nodes.forEach((function(i){if(c||!c&&i.highlight){var o=i.x,s=i.y;a?(e>o&&(e=o),n<o&&(n=o),t>s&&(t=s),r<s&&(r=s)):(e=o,t=s,n=o,r=s,a=!0)}})),{leftbound:e-6-14,upperbound:t-6-14,occupyWidth:n-e+12+28,occupyHeight:r-t+12+28}}();L=function(e,t,n,r,a){var i=a.leftbound,o=a.upperbound,s=a.occupyHeight,c=a.occupyWidth,l=n/c,u=r/s,d=Math.min(l,u);return{k:d,x:(n-c*d)/2-i*d+e,y:(r-s*d)/2-o*d+t}}(y,x,100,100,e),console.log("calTransform",L);var t={x:0,y:0,width:f,height:d},n=K({x:y,y:x,width:100,height:100},L),r={leftbound:n.x,upperbound:n.y,occupyWidth:n.width,occupyHeight:n.height},a=function(e,t){var n=e.x,r=e.y,a=e.width,i=e.height,o=t.x,s=t.y,c=t.k;return{x:n*c+o,y:r*c+s,width:a*c,height:i*c}}(function(e,t,n){var r=n.leftbound,a=n.upperbound,i=n.occupyHeight,o=n.occupyWidth,s=r+o,c=a+i,l=K(e,t),u=l.x,d=l.y,h=l.x+l.width,f=l.y+l.height;u<r&&(u=r),h>s&&(h=s),d<a&&(d=a),f>c&&(f=c);var g=h-u,p=f-d;return g<0?g=0:g>o&&(g=o),p<0?p=0:p>i&&(p=i),{x:u,y:d,width:g,height:p}}(t,N,r),L);v.save(),v.clearRect(0,0,f,d),E(v,y,x,100,100),P(v,y,x,100,100),v.translate(L.x,L.y),v.scale(L.k,L.k),q(v),v.scale(1/L.k,1/L.k),v.translate(-L.x,-L.y),E(v,a.x,a.y,a.width,a.height,"#000"),P(v,a.x,a.y,a.width,a.height,"#ccc",.5),v.restore()}U(p,!0)}function Y(){var e=function(e){return!(!e.hasOwnProperty("hovered")||!e.hovered)};_.save(),_.clearRect(0,0,f,d),_.translate(N.x,N.y),_.scale(N.k,N.k),F.links.filter((function(t){return!(!e(t.source)||!e(t.target))})).forEach((function(e){T(_,e.real_color,e.source.x,e.source.y,e.target.x,e.target.y)})),F.nodes.filter((function(t){return e(t)})).sort(G).forEach((function(e,t){var n=e.radius-.3,r=e.radius,a=2*e.radius;D(_,e.real_color,n*e.hover_cons,r*e.hover_cons,a*e.hover_cons,e.x,e.y,!0)})),_.restore()}ae.select(H).on("click",(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(ae.event.defaultPrevented)return;n?t=R:(t=ae.mouse(this),R=t);if(t)if("OverviewCanvas"===W(t[0],t[1]))J(t[0],t[1]);else{var r=z(t[0],t[1]);r&&e(r.id)}})).on("mousemove",U).on("mouseout",(function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=e;R=null,F.nodes.forEach((function(e){t=t||A(e,!1),e.hovered=!1,e.hover_cons=1})),V(),t&&Y()})),ae.select(H).call(ae.zoom().scaleExtent([.1,8]).on("zoom",(function(){var e=ae.mouse(this);R=e,N=ae.event.transform,"GraphCanvas"===W(e[0],e[1])&&(M(N),X())}))),n?(S.nodes(F.nodes).on("tick",X),S.force("link").links(F.links)):(S.stop(),S.nodes(F.nodes),S.force("link").links(F.links),X())}},{key:"render",value:function(){return r.createElement("div",{id:"force_directed_graph"},r.createElement("canvas",{id:"bottom",className:"AbsPos"}),r.createElement("canvas",{id:"middle",className:"AbsPos"}),r.createElement("canvas",{id:"overview",className:"AbsPos"}),r.createElement("svg",{id:"svgChart",xmlns:"http://www.w3.org/2000/svg",className:"AbsPos"},r.createElement("g",{id:"ForceDirectedLegend"}),r.createElement("g",{id:"ForceDirectedColorLegend"})),r.createElement("div",{id:"tooltip",className:"AbsPos"}),r.createElement("canvas",{id:"event",className:"AbsPos"}))}}]),n}(r.Component),le=Object(K.b)((function(e){return{GraphViewState:e.GraphViewState}}),(function(e){return{}}))(ce),ue=y.a.Option,de=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prevGraphJson=null,r.onEnableForceDirected=r.onEnableForceDirected.bind(Object(l.a)(r)),r.onExtendedModeChange=r.onExtendedModeChange.bind(Object(l.a)(r)),r.onNodeClick=r.onNodeClick.bind(Object(l.a)(r)),r.onChangeSelectInspectNode=r.onChangeSelectInspectNode.bind(Object(l.a)(r)),r.state={enableForceDirected:!1},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onNodeClick",value:function(e){!1===this.props.showSource?(this.props.changeSelectInspectNode(e),this.props.changeShowSource(!0),this.props.changeExtendedMode(3)):this.props.changeSelectInspectNode(e)}},{key:"constructGraphJson",value:function(e,t,n,r,a,i,o,s,c,l,u,d){var h,f=i.join("_"),g=e,p=e;g=e.common,p=e.individual,h=g.name+"_"+g.dataset_id+"_"+t+"_"+g.data_type_id+"_SELECTED_"+f+"_SELECTEDEND_"+o+"_"+u+"_"+d+"_"+l+"_",4==t&&(h=h+"_"+n);var _,v,y=g.graph_in,x=g.graph_target,b=g.graph_explaination,w=g.graph_layout,C=g.mask,S=new Set(C.train);if(_={GCN:p.GCN.graph_out,MLP:p.MLP.graph_out,GCN_Identity_features:p.GCN_Identity_features.graph_out},0===i.length){i=[];for(var k=0;k<w.length;k++)i.push(k)}if(l>=0){v=g.embedding[{0:"input",1:"hidden",2:"output"}[""+l]]}else v=w;var N=o;v.length>0&&(v=function(e){if(0===e.length)return e;var t=function(e){if(0===e.length)return{xmin:0,xmax:0,ymin:0,ymax:0};for(var t=e[0][0],n=e[0][0],r=e[0][1],a=e[0][1],i=0;i<e.length;i++){var o=e[i][0],s=e[i][1];t>o&&(t=o),n<o&&(n=o),r>s&&(r=s),a<s&&(a=s)}return{xmin:t,xmax:n,ymin:r,ymax:a}}(e),n=20;e.length>=100&&(n=20);var r=u-2*n,a=d-2*n,i=t.xmax-t.xmin,o=t.ymax-t.ymin;0===i&&(i=1e-16),0===o&&(o=1e-16);for(var s=Math.min(r/i,a/o),c=n+(r-s*i)/2,l=n+(a-s*o)/2,h=t.xmin,f=t.ymin,g=[],p=0;p<e.length;p++){var _=c+(e[p][0]-h)*s,v=l+(e[p][1]-f)*s;g.push([_,v])}return g}(v));var M=g.data_type_id,L=g.task;function E(e,t,n){return(e-n)/(t-n+1e-16)}if(1==M){var P,O,I,D,A=y.node_features.length,V=y.edge_features.length,H=y.senders,R=y.receivers,z=[],W=[],U=[],K=1;if("LRP"===b.type&&"node_classification"==L&&(K=0),"graph_classification"==L&&(K=2,2==t||3==t))return console.log("out of range show_mode for graph_classification task",t),a(1),{success:!1};if(n>=A)return console.log("out of range explained_node:",n),r(0),{success:!1};if(P=O=I=D=0,"graph_classification"==L){n=0;for(var B=b.node_importance[n],J=b.edge_importance[n],q=0,X=0,Y=0;Y<B.length;Y++)q<Math.abs(B[Y])&&(q=Math.abs(B[Y]));for(var Z=0;Z<J.length;Z++)X<Math.abs(J[Z])&&(X=Math.abs(J[Z]));P=q,O=-q,I=X,D=-X}else{var $=b.node_importance[n],Q=b.edge_importance[n];P=Math.max.apply(Math,Object(m.a)($)),O=Math.min.apply(Math,Object(m.a)($)),I=Math.max.apply(Math,Object(m.a)(Q)),D=Math.min.apply(Math,Object(m.a)(Q))}for(var ee=0;ee<A;ee++){var te="#999";if(1==t)te=T(t,y.node_features[ee]);else if(2==t)te=T(t,x.node_features[ee]);else if(3==t)te=T(t,_.node_features[ee]);else if(4==t){var ne=b.node_importance[n][ee];"SA"!==b.type&&"GBP"!==b.type&&"graph_classification"!=L||(ne=E(ne,P,O)),te=T(t,ne,K)}var re={id:ee,group:1,color:te};!1===N&&(re.x=w[ee][0],re.y=w[ee][1]),z.push(re)}for(var ae=0;ae<V;ae++){var ie=void 0;if(1==t||2==t||3==t)ie=G(t,y.edge_features[ae]);else{var oe=b.edge_importance[n][ae];"SA"!==b.type&&"GBP"!==b.type||(oe=E(oe,I,D)),ie=G(t,oe)}U.indexOf(ie)>=0||U.push(ie),W.push({source:H[ae],target:R[ae],value:1,color:ie})}return{success:!0,name:h,nodes:z,links:W,links_color:U,nodenum:A,edgenum:V,enable_forceDirected:N}}if(2==M){var se=y.senders,ce=y.receivers,le=x.node_features.length,ue=!1,de=this.prevGraphJson;de&&de.success&&de.nodes.length===le&&(ue=!0);for(var he=y.senders.length,fe=[],ge=[],pe=[],_e=0;_e<le;_e++){var ve=void 0,me=_e,ye=void 0,xe=void 0,be=1,we=x.node_features[me];ve=we;var Ce=_.GCN.node_features[me],Se=_.MLP.node_features[me],ke=_.GCN_Identity_features.node_features[me];xe=(ye=[j(we,2),j(Ce,3),j(Se,3),j(ke,3),F(me,S)]).slice(),i.indexOf(me)>=0||(ye=["#ddd","#ddd","#ddd","#ddd","#ddd"],be=0);var Ne=3;me===s&&!0===c&&(Ne=6);var Me={id:me,group:ve,color:ye,real_color:xe,radius:Ne,highlight:be};ue?(Me.x=de.nodes[_e].x,Me.y=de.nodes[_e].y):!1===N&&(Me.x=v[_e][0],Me.y=v[_e][1]),fe.push(Me)}for(var Le=0;Le<he;Le++){var Ee="#eee";i.indexOf(se[Le])>=0&&i.indexOf(ce[Le])>=0&&(Ee="#bbb"),pe.indexOf(Ee)>=0||pe.push(Ee),ge.push({source:se[Le],target:ce[Le],value:1,color:Ee,real_color:"#bbb"})}var Pe=[p.GCN.real_model_name,p.MLP.real_model_name,p.GCN_Identity_features.real_model_name];return{success:!0,name:h,nodes:fe,links:ge,links_color:pe,nodenum:le,edgenum:he,enable_forceDirected:N,colorLegend:function(){var e=g.graph_additional_info,t=e.num_class,n=[];if(Object.keys(e).indexOf("idx_to_class")>=0)for(var r=e.idx_to_class,a=0;a<t;a++)n.push({text:a+":"+r[a],color:j(a,2)});else for(var i=0;i<t;i++)n.push({text:i,color:j(i,2)});return n}(),pieLegend:{pie_name:Pe}}}return console.log("Unknown data type : ",M),{success:!1}}},{key:"onEnableForceDirected",value:function(e){this.setState({enableForceDirected:e})}},{key:"onExtendedModeChange",value:function(e){this.props.changeExtendedMode(e)}},{key:"constructExtendedSelectedNodeIdList",value:function(e,t){if(0===e.length)return[];for(var n=e.slice(),r=0;r<e.length;r++){var a=e[r];n=n.concat(t[a])}return n=Array.from(new Set(n))}},{key:"onChangeSelectInspectNode",value:function(e,t){var n=parseInt(e);(!n||n<0)&&(n=0),n>=t&&(n=t-1),console.log("graphview, new_node_id",n),this.props.changeSelectInspectNode(n)}},{key:"showGraphViewSettingModal",value:function(){this.props.changeGraphViewSettingsModal_visible(!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.show_mode,i=t.explained_node,o=t.onExplainNodeChange,s=t.onShowModeChange,c=(t.model,t.modelList,t.selectedNodeIdList),l=(t.selectedMessagePassingNodeIdList,t.showSource),u=t.select_inspect_node,d=t.width,h=t.height,f=t.extendedMode,g=this.onNodeClick,p=c;l&&(p=[u]);var _=n,v=A((_=n.common).graph_in);2===f?p=this.constructExtendedSelectedNodeIdList(p,v):3===f&&(p=this.constructExtendedSelectedNodeIdList(p,v),p=this.constructExtendedSelectedNodeIdList(p,v)),this.props.changeSpecificNodeIdList(p);var m=d-10,C=h-50,S=this.constructGraphJson(n,a,i,o,s,p,this.state.enableForceDirected,u,l,-1,m,C);if(S.NeighborSet=v,S.success&&(this.prevGraphJson=S),S.success){var k=S.nodenum,N=_.task;"node_classification"==N?2==_.data_type_id&&[[1,"Input Feature"],[2,"Ground Truth"],[3,"Model Output"],[5,"True / False"]]:"graph_classification"==N&&[[1,"Input Feature"],[4,"Explaination"]];return r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Graph View",r.createElement("div",{style:{float:"right"}},l?[r.createElement("span",{key:"span1"},"Id:"),r.createElement(b.a,{min:0,max:k,size:"small",value:u,onChange:function(t){e.onChangeSelectInspectNode(t,k)}}),r.createElement("span",{key:"span3"},"\xa0"),r.createElement(w.a,{size:"small",onClick:function(){e.props.changeShowSource(!1),e.props.changeExtendedMode(1)}},"X")]:[r.createElement("span",{key:"span2"})],r.createElement(re,null),"\xa0\xa0\xa0\xa0 Extended:\xa0",r.createElement(y.a,{placeholder:"Select an extended mode",value:f,style:{width:"90px"},onChange:this.onExtendedModeChange,size:"small"},[[1,"None"],[2,"One Hop"],[3,"Two Hop"]].map((function(e){return r.createElement(ue,{value:e[0],key:e[0]},e[1])}))),"\xa0\xa0\xa0\xa0",this.state.enableForceDirected?r.createElement(w.a,{type:"primary",size:"small",onClick:function(){e.onEnableForceDirected(!1)}},"Stop Layout"):r.createElement(w.a,{type:"default",size:"small",onClick:function(){e.onEnableForceDirected(!0)}},"Start Layout"),"\xa0\xa0\xa0\xa0",r.createElement(w.a,{type:"default",size:"small",onClick:function(){e.showGraphViewSettingModal()}},r.createElement(U.a,null)),"\xa0\xa0\xa0\xa0 #Nodes: ",r.createElement(x.a,null,H(p.length,k)," "))),r.createElement("div",{className:"ViewBox"},r.createElement("div",null),r.createElement("div",{style:{width:"100%"}},r.createElement(le,{graph_json:S,width:m,height:C,onNodeClick:g}))))}return r.createElement("div",null)}}]),n}(r.Component),he=Object(K.b)((function(e){return{selectedNodeIdList:e.selectedNodeIdList,selectedMessagePassingNodeIdList:e.selectedMessagePassingNodeIdList,showSource:e.showSource,select_inspect_node:e.select_inspect_node,extendedMode:e.extendedMode,GraphViewSettingsModal_visible:e.GraphViewSettingsModal_visible}}),(function(e){return{changeSpecificNodeIdList:function(t){return e(function(e){return{type:"SPECIFIC_NODE_ID_LIST_CHANGE",specificNodeIdList:e}}(t))},changeSelectInspectNode:function(t){return e(te(t))},changePrevGraphJson:function(t){return e(function(e){return{type:"PREV_GRAPH_JSON_CHANGE",prevGraphJson:e}}(t))},changeShowSource:function(t){return e(ne(t))},changeExtendedMode:function(t){return e(function(e){return{type:"EXTENDED_MODE_CHANGE",extendedMode:e}}(t))},changeGraphViewSettingsModal_visible:function(t){return e($(t))}}}))(de),fe=(n(242),n(27)),ge=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="RadialTree_",r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.graph_json.name!==this.props.graph_json.name&&(fe.selectAll("#RadialTree"+this.props.id).remove(),this.renderD3())}},{key:"renderD3",value:function(){var e=this.props.graph_json.RadialData,t=this.props.width,n=this.props.height,r=Math.min(t/2,n/2)-40,a=2.5,i=7;e.length>=50&&(a=2.5,i=7);var o=fe.select("#"+this.TAB+this.props.id),s=o.append("g").attr("id","RadialTree"+this.props.id).attr("width",t).attr("height",n),c=(s.append("rect").attr("width",t).attr("height",n).attr("fill","white"),s.append("g").attr("transform","translate("+t/2+","+n/2+")"));o.call(fe.zoom().extent([[0,0],[t,n]]).scaleExtent([.1,8]).on("zoom",(function(){s.attr("transform",fe.event.transform)})));var l=fe.stratify().parentId((function(e){return e.id.substring(0,e.id.lastIndexOf("."))}));function u(e,t){var n=(e-90)/180*Math.PI,r=t;return[r*Math.cos(n),r*Math.sin(n)]}var d=fe.tree().size([360,r]).separation((function(e,t){return(e.parent===t.parent?1:2)/e.depth}))(l(e)),h=(c.selectAll(".link").data(d.descendants().slice(1)).enter().append("path").attr("class","link").attr("stroke",(function(e){return e.data.link_color})).attr("d",(function(e){return"M"+u(e.x,e.y)+"C"+u(e.x,(e.y+e.parent.y)/2)+" "+u(e.parent.x,(e.y+e.parent.y)/2)+" "+u(e.parent.x,e.parent.y)})),c.selectAll(".node").data(d.descendants()).enter().append("g").attr("class",(function(e){return"node"+(e.children?" node--internal":" node--leaf")})).attr("transform",(function(e){return"translate("+u(e.x,e.y)+")"})));h.append("circle").attr("r",a).attr("fill",(function(e){return e.data.color})),h.append("text").attr("dy",".31em").attr("x",(function(e){return e.x<180===!e.children?6:-6})).attr("fill",(function(e){return e.data.text_color})).style("font-size",i+"px").style("text-anchor",(function(e){return e.x<180===!e.children?"start":"end"})).attr("transform",(function(e){return"rotate("+(e.x<180?e.x-90:e.x+90)+")"})).text((function(e){return e.id.substring(e.id.lastIndexOf(".")+1)}))}},{key:"render",value:function(){return r.createElement("g",{transform:"translate("+this.props.x+","+this.props.y+")",style:{height:this.props.height+"px",width:this.props.width+"px"},id:this.TAB+this.props.id})}}]),n}(r.Component),pe=y.a.Option,_e=(n(27),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onSelectNodeChange=r.onSelectNodeChange.bind(Object(l.a)(r)),r.onColorEncodeChange=r.onColorEncodeChange.bind(Object(l.a)(r)),r.onShowSourceChange=r.onShowSourceChange.bind(Object(l.a)(r)),r.state={color_encode:2},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onSelectNodeChange",value:function(e){this.props.changeSelectInspectNode(e)}},{key:"onColorEncodeChange",value:function(e){this.setState({color_encode:e})}},{key:"constructRadialTreeJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=e.name+"_"+e.dataset_id+"_"+e.model+"_"+e.explain_id+"_"+e.graph+"_"+e.data_type_id+"_"+t+"_"+n,i=(e.graph_in,e.graph_target),o=e.graph_out,s=e.graph_explaination,c=s.type,l=e.mask,u=l.train;if("MessagePassing"!==c)return console.log("Unsupported explaination type , ",c),{success:!1};var d=i.node_features.length;if(!(t>=0&&t<d))return console.log("Out of the range,  select_node , ",t),{success:!1};var h=e.message_passing,f=V(h);function g(e){var t=i.node_features[e];return 2===n?t=i.node_features[e]:3===n?t=o.node_features[e]:5===n&&(t=i.node_features[e]===o.node_features[e]),j(t,n)}function p(e){var t=u.indexOf(e);return D(t>=0?0:1)}function _(e,t,n){return(e-n)/(t-n+1e-16)}function v(e,t,n){var r=[],a=[];r.push({id:""+t,data_id:t,level:0,value:0,color:g(t),text_color:p(t)});for(var i=0;i<r.length;i++){var o=r[i],s=o.level;if(s>=n)break;for(var c=o.data_id,l=Object.keys(e[c]),u=0;u<l.length;u++){var d=parseInt(l[u]),h=e[c][d];a.push(h),r.push({id:o.id+"."+d,data_id:d,level:s+1,value:h,color:g(d),text_color:p(d)})}}for(var f=Math.min.apply(Math,a),v=Math.max.apply(Math,a),m=0;m<r.length;m++)if(r[m].level>=1){var y=r[m].value;y=_(y,v,f),r[m].link_color=G(4,y,1)}else r[m].link_color="#999999";return r}var m=e.data_type_id,y=(e.task,v(f,t,r));if(2===m){var x={success:!0,name:a,RadialData:y,nodenum:y.length};return x}return console.log("Unknown data type : ",m),{success:!1}}},{key:"constructPathGraphJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=e.name+"_"+e.dataset_id+"_"+e.model+"_"+e.explain_id+"_"+e.graph+"_"+e.data_type_id+"_"+t+"_"+n,i=(e.graph_in,e.graph_target),o=e.graph_out,s=e.graph_explaination,c=s.type;if("MessagePassing"!==c)return console.log("Unsupported explaination type , ",c),{success:!1};var l=i.node_features.length;if(!(t>=0&&t<l))return console.log("Out of the range,  select_node , ",t),{success:!1};var u=e.message_passing;function d(e){for(var t=e.senders,n=e.receivers,r=e.values,a={},i=0;i<n.length;i++){var o=n[i];o in a||(a[o]={}),a[o][t[i]]=r[i]}return a}var h=d(u);function f(e,t,n){var r=[],a=[],i=[],o=[],s=0,c={};function l(e){return e in c||(c[e]=s,s+=1),c[e]}r.push([t]),l(t+"_0");for(var u=0;u<n;u++){for(var d=r[u],h=u+1,f=[],g=0;g<d.length;g++)for(var p=d[g],_=l(p+"_"+u),v=Object.keys(e[p]),m=0;m<v.length;m++){var y=parseInt(v[m]),x=void 0;f.indexOf(y)>=0||f.push(y),x=l(y+"_"+h),a.push(x),i.push(_),o.push(e[p][y])}r.push(f)}return{PathLevel:r,sourcelist:a,targetlist:i,valuelist:o,nodeid_dict:c}}var g=e.data_type_id,p=(e.task,f(h,t,r));function _(e,t,n){return(e-n)/(t-n+1e-16)}if(2==g){for(var v=p.PathLevel,y=p.sourcelist,x=p.targetlist,b=p.valuelist,w=Math.min.apply(Math,Object(m.a)(b)),C=Math.max.apply(Math,Object(m.a)(b)),S=p.nodeid_dict,k=y.length,N=[],M=[],L=[],E=0;E<v.length;E++)for(var P=v[E],O=700-(300*E+20),I=P.length+2,D=300,T=D/I,A=0+T,V=0;V<P.length;V++){var F=A+T*V,H=P[V],R=S[H+"_"+E],z=i.node_features[H];2===n?z=i.node_features[H]:3===n&&(z=o.node_features[H]);var W={id:R,data_id:H,group:z,color:j(z),x:O,y:F};N.push(W)}for(var U=0;U<k;U++){var K="#999",B=b[U];B=_(B,C,w),K=G(4,B,1),L.indexOf(K)>=0||L.push(K),M.push({source:y[U],target:x[U],value:1,color:K})}var J={success:!0,name:a,nodes:N,links:M,links_color:L,nodenum:N.length,edgenum:k};return J}return console.log("Unknown data type : ",g),{success:!1}}},{key:"getAccuracy",value:function(e,t,n){for(var r=0,a=0;a<e.length;a++){t[e[a]]!==n[e[a]]&&(r+=1)}return 1-r/e.length}},{key:"getMisclassified",value:function(e){for(var t=[],n=e.graph_target,r=e.graph_out,a=n.node_features.length,i=0;i<a;i++){var o=n.node_features[i],s=r.node_features[i];o!==s&&t.push([i,o,s])}var c=1-t.length/a,l=e.mask,u=n.node_features,d=r.node_features;return{overall_accuracy:c,train_accuracy:this.getAccuracy(l.train,u,d),test_accuracy:this.getAccuracy(l.test,u,d),valid_accuracy:this.getAccuracy(l.valid,u,d),Misclassified:t}}},{key:"notifyMessagePassingNodeIdList",value:function(e){if(e.success){var t=e.RadialData.map((function(e){return e.data_id}));t=Array.from(new Set(t)),this.props.changeMessagePassingNodeIdList(t)}else this.props.changeMessagePassingNodeIdList([])}},{key:"onShowSourceChange",value:function(e){this.props.changeShowSource(e.target.checked)}},{key:"render",value:function(){var e=this.props,t=e.graph_object;e.model,e.modelList,this.getMisclassified(t);var n,a,i,o=t.graph_explaination.type,s=(t.graph_target,t.graph_out,this.props.select_inspect_node);if("MessagePassing"==o){var c=this.constructRadialTreeJson(t,s,this.state.color_encode);this.notifyMessagePassingNodeIdList(c);var l=this.props,u=l.width,d=l.height,h=u+"px",f=d+"px",g=u-20,p=d-20,_=t.graph_target.node_features.length;return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Message Passing View"),r.createElement("div",{className:"ViewBox"},"Select Node: ",function(e,t,n){for(var a=[],i=0;i<e;i++)a.push(i);return r.createElement(y.a,{showSearch:!0,placeholder:"Select a node",value:t,style:{width:"100px"},onChange:n},a.map((function(e){return r.createElement(pe,{key:e,value:e},e)})))}(_,s,this.onSelectNodeChange),"Color Encode: ",(n=[[2,"Ground Truth"],[3,"Model Output"],[5,"True / False"]],a=this.state.color_encode,i=this.onColorEncodeChange,r.createElement(y.a,{placeholder:"Select a color",value:a,style:{width:"200px"},onChange:i},n.map((function(e){return r.createElement(pe,{key:e[0],value:e[0]},e[1])})))),5===this.state.color_encode?r.createElement(x.a,{color:j(1,5)},"True"):"",5===this.state.color_encode?r.createElement(x.a,{color:j(0,5)},"False"):"","Text Encode: ",r.createElement(x.a,{color:D(0)},"Train"),"   ",r.createElement(x.a,{color:D(1)},"Others"),r.createElement(q.a,{checked:this.props.showSource,onChange:this.onShowSourceChange},"Show Select Node in Graph View"),r.createElement("div",{style:{height:f,width:h,borderTop:".6px solid rgba(0,0,0, 0.4)"}},r.createElement("svg",{style:{height:"100%",width:"100%"},id:"TopSVGChart",xmlns:"http://www.w3.org/2000/svg"},r.createElement(ge,{x:20,y:20,width:g,height:p,graph_json:c,id:1}," ")))))}return r.createElement("div",null,"Please choose message passing explanation method.")}}]),n}(r.Component)),ve=(Object(K.b)((function(e){return{showSource:e.showSource,select_inspect_node:e.select_inspect_node}}),(function(e){return{changeMessagePassingNodeIdList:function(t){return e(function(e){return{type:"SELECTED_MESSAGE_PASSING_NODE_ID_LIST_CHANGE",selectedMessagePassingNodeIdList:e}}(t))},changeShowSource:function(t){return e(ne(t))},changeSelectInspectNode:function(t){return e(te(t))}}}))(_e),n(243),n(27)),me=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="ScatterPlot_",r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.graph_json.name===this.props.graph_json.name&&e.id===this.props.id||this.renderD3()}},{key:"renderD3",value:function(){var e=this.props.graph_json.nodenum,t={radius:15,showlabel:!0,width:this.props.width,height:this.props.height};console.log("ScatterPlot",e),e>=100&&(t={radius:1,showlabel:!1,width:this.props.width,height:this.props.height});var n=ve.select("#TopSVGChart_ScatterPlot"),r=ve.select("#"+this.TAB),a=t.width,i=t.height,o=r.select("#ScatterPlot_sub");o.attr("width",a).attr("height",i),n.call(ve.zoom().extent([[0,0],[a,i]]).scaleExtent([.1,8]).on("zoom",(function(){r.attr("transform",ve.event.transform)})));var s=ve.transition().duration(1e3).ease(ve.easeLinear);!function(e){var n=o.select("g.nodes").selectAll("g").data(e.nodes,(function(e){return e.id}));console.log("EmbeddingView nodes enter update exit"),console.log(n.enter().size()),console.log(n.size()),console.log(n.exit().size());var r=n.enter().append("g");n.merge(r),n.exit().remove();var a=r.append("circle"),i=n.select("circle"),c=i.merge(a);if(console.log("Circles",a,a.size(),i,i.size()),c.transition(s).attr("r",t.radius).attr("fill",(function(e){return e.color})),t.showlabel){var l=r.append("text"),u=n.select("text");l.merge(u).text((function(e){return e.id})).attr("fill","#000").attr("text-anchor","middle").attr("x",0).attr("y",4),c.attr("stroke","#222")}var d=r.append("title");n.select("title").merge(d).text((function(e){return e.id})),r.merge(n).transition(s).attr("transform",(function(e){return"translate("+e.x+","+e.y+")"}))}(this.props.graph_json)}},{key:"render",value:function(){return r.createElement("svg",{style:{height:"100%",width:"100%"},id:"TopSVGChart_ScatterPlot",xmlns:"http://www.w3.org/2000/svg"},r.createElement("g",{transform:"translate("+this.props.x+","+this.props.y+")",style:{height:this.props.height+"px",width:this.props.width+"px"},id:this.TAB},r.createElement("g",{id:"ScatterPlot_sub"},r.createElement("g",{className:"nodes"}))))}}]),n}(r.Component),ye=y.a.Option,xe=(n(27),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onSelectNodeChange=r.onSelectNodeChange.bind(Object(l.a)(r)),r.onColorEncodeChange=r.onColorEncodeChange.bind(Object(l.a)(r)),r.onEmbeddingLayerChange=r.onEmbeddingLayerChange.bind(Object(l.a)(r)),r.state={select_node:0,color_encode:2,embeddinglayer:1},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onSelectNodeChange",value:function(e){this.setState({select_node:e})}},{key:"onColorEncodeChange",value:function(e){this.setState({color_encode:e})}},{key:"onEmbeddingLayerChange",value:function(e){console.log("onembeddinglayerchange"),this.setState({embeddinglayer:e})}},{key:"getAccuracy",value:function(e,t,n){for(var r=0,a=0;a<e.length;a++){t[e[a]]!==n[e[a]]&&(r+=1)}return 1-r/e.length}},{key:"getMisclassified",value:function(e){for(var t=[],n=e.graph_target,r=e.graph_out,a=n.node_features.length,i=0;i<a;i++){var o=n.node_features[i],s=r.node_features[i];o!==s&&t.push([i,o,s])}var c=1-t.length/a,l=e.mask,u=n.node_features,d=r.node_features;return{overall_accuracy:c,train_accuracy:this.getAccuracy(l.train,u,d),test_accuracy:this.getAccuracy(l.test,u,d),valid_accuracy:this.getAccuracy(l.valid,u,d),Misclassified:t}}},{key:"constructScatterPlotJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],c=s.join("_"),l=e.name+"_"+e.dataset_id+"_"+e.model+"_"+e.explain_id+"_"+e.graph+"_"+e.data_type_id+"_"+o+"_"+n+"_"+r+"_SELECTED_"+c+"_SELECTED_END_",u=(e.graph_in,e.graph_target),d=e.graph_out,h=e.graph_explaination,f=h.type;if("MessagePassing"!==f)return console.log("Unsupported explaination type , ",f),{success:!1};if(0===s.length)return{success:!1};var g=e.embedding,p=g[t];function _(e){if(0===e.length)return{xmin:0,xmax:0,ymin:0,ymax:0};for(var t=e[0][0],n=e[0][0],r=e[0][1],a=e[0][1],i=0;i<e.length;i++){var o=e[i][0],s=e[i][1];t>o&&(t=o),n<o&&(n=o),r>s&&(r=s),a<s&&(a=s)}return{xmin:t,xmax:n,ymin:r,ymax:a}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;if(0===e.length)return e;var i=_(e);e.length>=100&&(r=a);for(var o=t-2*r,s=n-2*r,c=i.xmax-i.xmin,l=i.ymax-i.ymin,u=Math.min(o/c,s/l),d=r+(o-u*c)/2,h=r+(s-u*l)/2,f=i.xmin,g=i.ymin,p=[],v=0;v<e.length;v++){var m=e[v][0],y=e[v][1],x=d+(m-f)*u,b=h+(y-g)*u;p.push([x,b])}return p}var m=e.data_type_id;e.task;if(p=v(p,n,r,a,i),2==m){for(var y=u.node_features.length,x=[],b=0;b<y;b++){var w=u.node_features[b];2===o?w=u.node_features[b]:3===o?w=d.node_features[b]:5===o&&(w=u.node_features[b]===d.node_features[b]);var C=j(w,o);s.indexOf(b)>=0||(C="#ddd");var S={id:b,group:w,color:C,x:p[b][0],y:p[b][1]};x.push(S)}var k={success:!0,name:l,nodes:x,nodenum:y};return k}return console.log("Unknown data type : ",m),{success:!1}}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=(t.model,t.modelList,t.width),i=t.height,o=t.specificNodeIdList,s=i,c=a,l=i+"px";this.getMisclassified(n);var u,d,h,f=n.graph_explaination.type;n.graph_target,n.graph_out,this.state.select_node;if("MessagePassing"==f){n.graph_target.node_features.length;return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Embedding View"),r.createElement("div",{className:"ViewBox"},"Select Embedding Layer:",(u=[[1,"Input Layer"],[2,"Hidden Layer"],[3,"Output Layer"]],d=this.state.embeddinglayer,h=this.onEmbeddingLayerChange,r.createElement(y.a,{placeholder:"Select a embedding layer",value:d,style:{width:"200px"},onChange:h},u.map((function(e){return r.createElement(ye,{key:e[0],value:e[0]},e[1])})))),"Select Color Encode:",function(e,t,n){return r.createElement(y.a,{placeholder:"Select a color",value:t,style:{width:"200px"},onChange:n},e.map((function(e){return r.createElement(ye,{key:e[0],value:e[0]},e[1])})))}([[2,"Ground Truth"],[3,"Model Output"],[5,"True / False"]],this.state.color_encode,this.onColorEncodeChange),r.createElement("div",{style:{height:l,width:"100%",borderTop:".6px solid rgba(0,0,0, 0.4)"}},function(t){console.log("embeddinglayer",t);c*=2,s*=2;var l=e.constructScatterPlotJson(n,["","input","hidden","output"][t],c,s,30,30,e.state.color_encode,o);return l.success?1===t?r.createElement(me,{x:0,y:0,width:a,height:i,graph_json:l,id:1,caption:"Input Layer"}," "):2===t?r.createElement(me,{x:0,y:0,width:a,height:i,graph_json:l,id:2,caption:"Hidden Layer"}," "):3===t?r.createElement(me,{x:0,y:0,width:a,height:i,graph_json:l,id:3,caption:"Output Layer"}," "):r.createElement("div",null):r.createElement("div",null)}(this.state.embeddinglayer))))}return r.createElement("div",null,"Please choose message passing explanation method.")}}]),n}(r.Component)),be=(Object(K.b)((function(e){return{specificNodeIdList:e.specificNodeIdList}}),(function(e){return{}}))(xe),n(137),n(27)),we=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="Matrix_",r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name===this.props.feature_matrix_json.name&&e.MatrixFilters.refreshnumber===this.props.MatrixFilters.refreshnumber&&e.MatrixRowFilters.refreshnumber===this.props.MatrixRowFilters.refreshnumber||this.renderD3()}},{key:"renderD3",value:function(){var e=this.props.feature_matrix_json,t=this.props.layout_config,n=e.showSource,r=0,a=30,i=100,o=0,s=t.width-o-a,c=e.y_axis,l=e.x_axis,u=e.matrix,d=e.type,h=e.color_info,f=e.highlight_flag,g=this.props.MatrixFilters,p=this.props.MatrixRowFilters;function _(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n}var v=Math.max(1,Math.floor(s/15));g.hasOwnProperty("index")||(g.index=[0,v]),g.index[1]-g.index[0]>=v&&(g.index[1]=g.index[0]+v);var m=h.y_axis_color;p.hasOwnProperty("row_index")&&n?(l=l.slice(g.index[0],g.index[1]),c=_(p.row_index,c),m=_(p.row_index,m),u=function(e,t,n){for(var r=[],a=new Set(n),i={},o=0;o<n.length;o++)i[n[o]]=o;for(var s=0;s<e.length;s++)if(e[s].x>=t[0]&&e[s].x<t[1]){var c=e[s].y;a.has(c)&&r.push({x:e[s].x-t[0],y:i[c],value:e[s].value})}return r}(u,g.index,p.row_index)):(l=l.slice(g.index[0],g.index[1]),u=function(e,t){for(var n=[],r=0;r<e.length;r++)e[r].x>=t[0]&&e[r].x<t[1]&&n.push({x:e[r].x-t[0],y:e[r].y,value:e[r].value});return n}(u,g.index)),n||c.length===m.length||(c=[],l=[],u=[]);var y,x,b=Math.floor(s/v),w=b*c.length+20;1===e.distance_select&&"discrete"===d?(y=2,x=["#ffffd9","#081d58"]):(y=9,x=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]);var C,S=function(){for(var e=[],t=0;t<l.length;t++)for(var n=0;n<c.length;n++)e.push({x:t,y:n,value:0});return e}();C="discrete"===d?S.concat(u):u;var k=be.max(C,(function(e){return e.value})),N=be.min(C,(function(e){return e.value})),M=be.select("#FeatureMatrix_"+this.props.id).attr("width",s+o+a).attr("height",w+r+i).attr("transform","translate("+t.x+","+t.y+")").select("#Matrix").attr("transform","translate("+o+","+r+")");n&&(c=[]);var L=M.selectAll(".y_axisLabel").data(c,(function(e){return e})),E=Math.min(5,b/4),P=2*-E-.3,O=2*E,I=L.enter().append("g").attr("class","y_axisLabel");I.merge(L).attr("transform",(function(e,t){return"translate("+P+","+(t*b+O)+")"})),L.exit().remove();var j,D,T,G,A,V,F;h.enable_y_axis_color&&function(){var e=h.y_axis_color;j=[{index:0,value:1/3},{index:1,value:1/3},{index:2,value:1/3}],D=be.pie().startAngle(-60/180*Math.PI).endAngle((2-60/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),T=D(j),G=I.append("circle").attr("class","outer_circle"),A=L.select("circle.outer_circle"),G.merge(A).attr("r",(function(e){return 2*E})).attr("fill",(function(t,n){return e[n][4]}));for(var t=[],n=function(n){var r=I.append("path").attr("class","arc_"+n),a=L.select("path.arc_"+n),i=r.merge(a);i.style("fill",(function(t,r){return e[r][n+1]})).attr("d",(function(e){return function(e){return be.arc().innerRadius(e).outerRadius(2*e)}(E)(T[n])})),t.push(i)},r=0;r<3;r++)n(r);V=I.append("circle").attr("class","inner_circle"),F=L.select("circle.inner_circle"),V.merge(F).attr("r",(function(e){return E-.3})).attr("fill",(function(t,n){return e[n][0]}))}();I.append("text").merge(L.select("text")).text((function(e){return e})).style("text-anchor","end").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").style("dominant-baseline","central").attr("transform","translate("+P+",0)").attr("class","y-axis");var H=M.selectAll(".x_axisLabel").data(l,(function(e){return e})),R=H.enter().append("g").attr("class","x_axisLabel");R.merge(H).attr("transform",(function(e,t){return"translate("+t*b+",0)"})),H.exit().remove();R.append("text").merge(H.select("text")).text((function(e){return e})).style("text-anchor","begin").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").attr("transform","translate("+.25*b+", -2)rotate(-45)").attr("class","x-axis");for(var z=[],W=(k-N)/(y-1),U=0;U<y;U++)z.push(U*W+N);be.scaleLinear().domain(z).range(x);var K=M.selectAll(".hour").data(C,(function(e){return e.x+":"+e.y}));K.enter().append("rect").attr("class","hour bordered").merge(K).attr("x",(function(e){return e.x*b})).attr("y",(function(e){return e.y*b})).attr("rx",4).attr("ry",4).attr("width",b).attr("height",b).style("fill-opacity",(function(e){return e.value})).style("fill",(function(e){return t=e.value,n=e.y,t>0?m[n][1]:x[0];var t,n})).style("stroke",(function(e){var t=e.y;return t>f.length?"#eee":!0===f[t]?"#222":"#eee"})).style("stroke-width","2").style("stroke-opacity",(function(e){var t=e.y;return t>f.length?0:!0===f[t]?1:0})).on("mouseover",(function(e){return B.style("visibility","visible").text(e.value.toFixed(4))})).on("mousemove",(function(e){return B.style("top",be.event.pageY-10+"px").style("left",be.event.pageX+10+"px")})).on("mouseout",(function(e){return B.style("visibility","hidden")})),K.exit().remove();var B=be.select("body").select("#tooltip_matrix").style("position","absolute").style("z-index","10").style("visibility","hidden").text("a simple tooltip")}},{key:"render",value:function(){return r.createElement("g",{id:"FeatureMatrix_"+this.props.id},r.createElement("g",{id:"Matrix"}))}}]),n}(r.Component),Ce=Object(K.b)((function(e){return{MatrixFilters:e.matrixFilters,MatrixRowFilters:e.matrixRowFilters}}),(function(e){return{changeMatrixFilters:function(t){return e(Y(t))}}}))(we),Se=n(27),ke=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="BrushBarChart_",r.updateMatrixFilters=r.updateMatrixFilters.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name!==this.props.feature_matrix_json.name&&(Se.selectAll("#"+this.TAB+this.props.id).remove(),this.renderD3())}},{key:"updateMatrixFilters",value:function(e){var t=Object.assign({},this.props.MatrixFilters);t.refreshnumber=t.refreshnumber+1,t.index=e.index,this.props.changeMatrixFilters(t)}},{key:"renderD3",value:function(){var e,t,n,r,a,i,o=this.props.feature_matrix_json.selectedFeatureStatistics,s=this.props.layout_config,c=Se.select("#chart_"+this.props.id).append("g").attr("id",this.TAB+this.props.id).attr("width",s.width).attr("height",s.height).attr("transform","translate("+s.x+","+s.y+")"),l=20,u=30,d=0,h=0,f=+s.width-h-u,g=+s.height-l-d,p=this.props.layout_config.max_row_num_block,_=Se.scaleBand().range([0,f]).padding(.1),v=Se.scaleBand().range([0,f]).padding(.1),m=Se.scaleLinear().range([g,0]),y=Se.scaleLinear().range([g,0]);t=o.map((function(e,t){return{id:t,ratio:e}})),n=[].concat(t),r=n.length;var x=this.updateMatrixFilters;e=Se.brushX().extent([[0,0],[f,g]]).on("brush end",(function(){if(!Se.event.sourceEvent||"zoom"!==Se.event.sourceEvent.type){var t,o,s=Se.event.selection||v.range();i=[Math.round(s[0]/(f/r)),Math.round(s[1]/(f/r))],_.domain(n.slice(i[0],i[1]).map((function(e){return e.id}))),i[1]-i[0]>=p+1?(i[1]=i[0]+p,Se.select(this).call(e.move,i.map((function(e){return e*f/r})))):(t=i[0],o=i[1],a.selectAll(".bar").style("fill-opacity",(function(e,n){return n>=t&&n<o?"1":"0.3"})),x({index:[i[0],i[1]]}))}})),a=c.append("g").attr("class","context").attr("transform","translate("+h+","+l+")"),_.domain(n.map((function(e){return e.id}))),m.domain([0,Se.max(n,(function(e){return e.ratio}))]),v.domain(_.domain()),y.domain(m.domain()),function(){var e=a.selectAll(".bar").data(n);e.attr("x",(function(e){return v(e.id)})).attr("width",v.bandwidth()).attr("y",(function(e){return y(e.ratio)})).attr("height",(function(e){return g-y(e.ratio)})).style("fill",(function(e){return"steelblue"})),e.enter().insert("rect").attr("class","bar").attr("x",(function(e){return v(e.id)})).attr("width",v.bandwidth()).attr("y",(function(e){return y(e.ratio)})).attr("height",(function(e){return g-y(e.ratio)})).style("fill",(function(e){return"steelblue"})),e.exit().remove()}(),a.append("g").attr("class","brush").call(e).call(e.move,v.range())}},{key:"render",value:function(){return r.createElement("g",{id:"chart_"+this.props.id})}}]),n}(r.Component),Ne=Object(K.b)((function(e){return{MatrixFilters:e.matrixFilters}}),(function(e){return{changeMatrixFilters:function(t){return e(Y(t))}}}))(ke),Me=(n(244),n(27)),Le=(Me.tree,Me.hierarchy,Me.select),Ee=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="IndentedTree_",r.updateMatrixFilters=r.updateMatrixFilters.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name!==this.props.feature_matrix_json.name&&(Me.selectAll("#IndentedTree").remove(),this.renderD3())}},{key:"updateMatrixFilters",value:function(e){var t=Object.assign({},this.props.MatrixRowFilters);t.refreshnumber=t.refreshnumber+1,t.row_index=e,this.props.changeMatrixRowFilters(t)}},{key:"renderD3",value:function(){var e=this.props.feature_matrix_json.indentedList,t=this.props.layout_config,n=10,r=10,a=20,i=10,o=t.width-r-i,s=t.width-n-a,c=t.barHeight,l=Le("#hierarchy-container").attr("width",o+r+i).attr("height",s+n+a).attr("transform","translate("+t.x+","+t.y+")").append("g").attr("id","IndentedTree").attr("transform","translate("+i+","+n+")").selectAll(".y_axisLabel").data(e,(function(e){return e.id})),u=c,d=Math.min(5,u/4),h=2*d+.3,f=l.enter().append("g").attr("class","y_axisLabel");f.merge(l).attr("transform",(function(e,t){return"translate("+(h+30*e.level)+","+(t*u+0)+")"})),l.exit().remove();var g=Me.pie().startAngle(-60/180*Math.PI).endAngle((2-60/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index}))([{index:0,value:1/3},{index:1,value:1/3},{index:2,value:1/3}]),p=f.append("circle").attr("class","outer_circle"),_=l.select("circle.outer_circle");p.merge(_).attr("r",(function(e){return 2*d})).attr("fill",(function(e,t){return e.color[4]}));for(var v=[],m=function(e){var t=f.append("path").attr("class","arc_"+e),n=l.select("path.arc_"+e),r=t.merge(n);r.style("fill",(function(t,n){return t.color[e+1]})).attr("d",(function(t){return function(e){return Me.arc().innerRadius(e).outerRadius(2*e)}(d)(g[e])})),v.push(r)},y=0;y<3;y++)m(y);var x=f.append("circle").attr("class","inner_circle"),b=l.select("circle.inner_circle");x.merge(b).attr("r",(function(e){return d-.3})).attr("fill",(function(e,t){return e.color[0]})),f.append("text").merge(l.select("text")).text((function(e){return e.id})).style("text-anchor","start").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").style("dominant-baseline","central").attr("transform","translate("+h+",0)").attr("class","y-axis")}},{key:"render",value:function(){return r.createElement("g",{id:"hierarchy-container"})}}]),n}(r.Component),Pe=Object(K.b)((function(e){return{MatrixRowFilters:e.matrixRowFilters}}),(function(e){return{changeMatrixRowFilters:function(t){return e(function(e){return{type:"MATRIX_ROW_FILTERS_CHANGE",matrixRowFilters:e}}(t))}}}))(Ee),Oe=(n(245),n(27)),Ie=n(320),je=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="VerticalSlider_",r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.layout_config.name!==this.props.layout_config.name&&(Oe.selectAll("#"+this.TAB+this.props.id).remove(),this.renderD3())}},{key:"renderD3",value:function(){var e=this.props.layout_config,t=e.node_start_index,n=e.node_max_index;console.log("rerender d3",t,n);var r=Oe.select("#chart_"+this.props.id).append("g").attr("id",this.TAB+this.props.id).attr("width",e.width).attr("height",e.height).attr("transform","translate("+e.x+","+e.y+")"),a=0,i=0,o=0,s=0,c=(e.width,+e.height-a-o),l=this.props.changeNodeStartIndex,u=Ie.sliderLeft().min(0).max(n).height(c).displayValue(!1).default(n-t).step(1).handle(Oe.symbol().type(Oe.symbolCircle).size(200)()).on("onchange",(function(e){console.log("onchange, choose value",e,n-e),l(n-e)})),d=r.append("g").attr("transform","translate(30,0)");d.call(u),d.select("g.axis").remove()}},{key:"render",value:function(){return r.createElement("g",{id:"chart_"+this.props.id})}}]),n}(r.Component),De=Object(K.b)((function(e){return{}}),(function(e){return{}}))(je),Te=(n(138),n(139),n(247).default),Ge=y.a.Option,Ae=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onAxisChange=r.onAxisChange.bind(Object(l.a)(r)),r.onDistanceChange=r.onDistanceChange.bind(Object(l.a)(r)),r.onDataSourceChange=r.onDataSourceChange.bind(Object(l.a)(r)),r.onColorEncodeChange=r.onColorEncodeChange.bind(Object(l.a)(r)),r.onEnableSort=r.onEnableSort.bind(Object(l.a)(r)),r.changeNodeStartIndex=r.changeNodeStartIndex.bind(Object(l.a)(r)),r.state={axis_select:2,distance_select:1,dataSource_select:1,color_encode:2,enableSorting:!0,node_start_index:0},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"calculateFeatureCosDistance",value:function(e,t,n,r){for(var a=e.length,i=n.length,o=0,s=0;s<a;s++){var c=n.indexOf(e[s]);c>=0&&(o+=t[s]*r[c])}for(var l=0,u=0,d=0;d<a;d++)l+=t[d]*t[d];for(var h=0;h<i;h++)u+=r[h]*r[h];return o/((l=Math.sqrt(l))*(u=Math.sqrt(u))+1e-8)}},{key:"calculateFeatureDistance",value:function(e,t){for(var n=e.length,r=t.length,a=0,i=0;i<n;i++)t.indexOf(e[i])>=0&&(a+=1);return n+r-2*a}},{key:"calculateEuclideanDistance",value:function(e,t){for(var n=e.length,r=0,a=0;a<n;a++)r+=(e[a]-t[a])*(e[a]-t[a]);return r=Math.sqrt(r)}},{key:"constructIndentedList",value:function(e,t,n,r,a){var i=a.getNodeColorInfo,o=a.features,s=a.features_value,c=[],l=[],u=[];c.push({id:t,color:i(t),level:n,dist:2});for(var d=o[t],h=s[t];c.length>0;){var f=c[0],g=f.id,p=f.level;if(c.shift(),!(l.indexOf(g)>=0)&&!(p>r)){u.push(f),l.push(g);var _=Object.keys(e[g]);if(p+1<=r)for(var v=p+1,m=0;m<_.length;m++){var y=parseInt(_[m]);if(!(l.indexOf(y)>=0)){var x=o[y],b=s[y],w=this.calculateFeatureCosDistance(d,h,x,b);c.push({id:y,color:i(y),level:v,dist:w})}}}}return u.sort((function(e,t){return e.dist>t.dist?-1:1})),u}},{key:"constructIndentedListFromKFS",value:function(e,t,n){var r=n.getNodeColorInfo,a=[];a.push({id:e,color:r(e),level:0,dist:2});W(t[e].details,this.props.K_value).forEach((function(e){var t=e.anchor_id;a.push({id:t,color:r(t),level:1,dist:e.anchor_similarity})}));return a.sort((function(e,t){return e.dist>t.dist?-1:1})),a}},{key:"constructIndentedTree",value:function(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=o.getNodeColorInfo,l=o.features,u=o.features_value;if(n>=r)return{name:""+t,children:[],row_id:a,next_row_id:a+1,edge_weight:s,color:c(t)};for(var d=Object.keys(e[t]),h=[],f=a,g=a+1,p=[],_=l[i],v=u[i],m=0;m<d.length;m++){var y=parseInt(d[m]);if(y!==t&&y!==i){var x=l[y],b=u[y],w=this.calculateFeatureCosDistance(_,v,x,b);p.push({id:y,dist:w})}}p.sort((function(e,t){return e.dist>t.dist?-1:1}));for(var C=0;C<p.length;C++){var S=p[C].id,k=e[t][S],N=this.constructIndentedTree(e,S,n+1,r,g,i,o,k);g=N.next_row_id,h.push(N)}return{name:""+t,children:h,row_id:f,next_row_id:g,edge_weight:s,color:c(t)}}},{key:"sequentialIndentedTree",value:function(e){var t=[];t.push(parseInt(e.name));for(var n=0;n<e.children.length;n++)t=t.concat(this.sequentialIndentedTree(e.children[n]));return t}},{key:"sequentialIndentedTreeToList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r={id:parseInt(e.name),name:e.name,color:e.color,depth:t};n.push(r);for(var a=0;a<e.children.length;a++)n=n.concat(this.sequentialIndentedTreeToList(e.children[a],t+1));return n}},{key:"getNodeColorInfoFull",value:function(e,t,n,r){var a=t.node_features[e],i=n.GCN.graph_out.node_features[e],o=n.MLP.graph_out.node_features[e],s=n.GCN_Identity_features.graph_out.node_features[e];return[j(a,2),j(i,3),j(o,3),j(s,3),F(e,r)]}},{key:"hclusterSortingSelectedNode",value:function(e){for(var t=e.num_nodes,n=e.selectedNodeIdList,r=e.features,a=e.features_value,i=[],o=[],s=[],c=0;c<t;c++){for(var l=[],u=0;u<t;u++)l.push(0);i.push(l),o.push([n[c],0]),s.push(!1)}for(var d=0;d<t;d++)for(var h=n[d],f=r[h],g=a[h],p=0;p<d;p++){var _=n[p],v=r[_],m=a[_],y=1-this.calculateFeatureCosDistance(f,g,v,m);i[d][p]=y,i[p][d]=y}for(var x=Te.optimal_leaf_order().distance_matrix(i)(o),b=Te.stablepermute(o,x),w=[],C=0;C<t;C++)w.push(b[C][0]);n=w.slice();for(var S=[],k=1;k<t;k++){var N=n[k],M=r[N],L=a[N],E=k-1,P=n[E],O=r[P],I=a[P],j=1-this.calculateFeatureCosDistance(M,L,O,I);S.push(j),j<.2&&(s[k]=!0,s[E]=!0)}return{selectedNodeIdList:n,highlight_flag:s}}},{key:"hclusterSortingSelectedFeatures",value:function(e){for(var t=e.pre_selected_feature_stats_index,n=e.pre_selected_feature,r=[],a=t.length,i=[],o=0;o<a;o++){for(var s=[],c=0;c<a;c++)s.push(0);r.push(s),i.push([n[o],0])}for(var l=0;l<a;l++)for(var u=t[l],d=0;d<l;d++){var h=t[d],f=this.calculateFeatureDistance(u,h);r[l][d]=f,r[d][l]=f}return{perm:Te.optimal_leaf_order().distance_matrix(r)(i)}}},{key:"constructFeatureMatrixJson",value:function(e,t,n,r,a,i,o,s,c,l,u,d,h){var f,g=h.max_col_num_block,p=h.node_start_index,_=t.join("_"),v=e,m=e;v=e.common,m=e.individual,f=v.name+"_"+v.dataset_id+"_"+v.data_type_id+"_SELECTED_"+_+"_SELECTED_END_"+n+"_"+r+"_"+a+"_"+i+"_"+o+"_"+c+"_"+l+"_"+u+"_"+this.props.K_value,f=s?f+"_"+d:f+"_"+p+"_"+g;var y=v.graph_in,x=v.graph_target,b=v.graph_explaination.type;if("MessagePassing"!==b)return console.log("Unsupported explaination type , ",b),{success:!1};if(0===t.length)return{success:!1};V(m.GCN.message_passing);var w,C=new Set(v.mask.train),S=[];1===a&&(w=y.feature,S=y.feature_value);var k=this.getNodeColorInfoFull;function N(e){return k(e,x,m,C)}var M=[];if(s){var L={getNodeColorInfo:N,features:w,features_value:S};t=(M=this.constructIndentedListFromKFS(o,v.graph_additional_info.KFS,L)).map((function(e){return e.id})),console.log("Feature Matrix Common",v.graph_additional_info.KFS,M)}var E=[],P=[],O=[],I=[],j=0;function D(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}var T=v.graph_additional_info.num_class;if(!(t.length>0&&t.length<=300))return{success:!1};if(1===a){var G=t.length;if((j=t.length-g)<0&&(j=0),G>=2&&!s){var A={num_nodes:G,selectedNodeIdList:t,features:w,features_value:S},F=this.hclusterSortingSelectedNode(A);I=F.highlight_flag;var H=0;p>=(G=(t=F.selectedNodeIdList).length)?(console.log("node_start_index, num_nodes",p,G),p=0,H=G>=g?g:G):p<G&&(H=G>=p+g?p+g:G),t=t.slice(p,H),I=I.slice(p,H),G=t.length}for(var R=[],z=[],W=[],U=[],K=[],B=[],J=0;J<t.length;J++)for(var q=t[J],X=m.GCN.graph_out.node_features[q],Y=0;Y<w[q].length;Y++){var Z=w[q][Y];R.indexOf(Z)>=0||(R.push(Z),z.push(0),W.push(J),K.push([]),U.push([]),B.push({distribution:D(T)}));var $=R.indexOf(Z);z[$]=z[$]+1,K[$].push(q),U[$].push(J),B[$].distribution[X]=B[$].distribution[X]+1}for(var Q=0;Q<B.length;Q++){for(var ee=B[Q].distribution,te=0,ne=0;ne<ee.length;ne++)te+=ee[ne];if(te>0)for(var re=0;re<ee.length;re++)ee[re]=ee[re]/te;B[Q].distribution=ee}if(c){var ae=t[0],ie=m.GCN.graph_out.node_features[ae],oe=z.map((function(e,t){var n=1;return n=0===U[t][0]?1:0,{index:R[t],freq:e,pro:B[t].distribution[ie],first:n}}));oe.sort((function(e,t){return e.first>t.first?-1:e.first<t.first?1:e.pro>t.pro?-1:e.pro<t.pro?1:e.freq>t.freq?-1:1})),R=oe.map((function(e){return e.index})),z=oe.map((function(e){return e.freq}))}else{var se=U.map((function(e,t){return{index:R[t],stats:z[t],value:e}}));se.sort((function(e,t){for(var n=e.value,r=t.value,a=n.length,i=r.length,o=0,s=Math.min(a,i),c=0;c<s;c++){if(n[c]<r[c]){o=-1;break}if(n[c]>r[c]){o=1;break}}return 0===o&&(o=a>i?-1:a<i?1:0),o})),R=se.map((function(e){return e.index})),z=se.map((function(e){return e.stats}))}P=R,O=z;for(var ce=0;ce<t.length;ce++)for(var le=t[ce],ue=0;ue<w[le].length;ue++){var de,he=w[le][ue];de={x:P.indexOf(he),y:ce,value:S[le][ue]},E.push(de)}}for(var fe=[],ge=0;ge<t.length;ge++){var pe=N(t[ge]);fe.push(pe)}var _e=v.data_type_id;if(2===_e){var ve,me,ye,xe=v.graph_additional_info,be=[];if(Object.keys(xe).indexOf("idx_to_attr")>=0&&1===a)for(var we=xe.idx_to_attr,Ce=0;Ce<P.length;Ce++)be.push(we[P[Ce]]);else be=P;ve=1===a?"discrete":"continuous";var Se,ke;me=be,ye=t,!1,!0,Se=[],ke=fe;var Ne={enable_x_axis_color:!1,enable_y_axis_color:!0};Ne.x_axis_color=Se,Ne.y_axis_color=ke;var Me=!0;j<=0&&(Me=!1);var Le={node_start_index:p,node_max_index:j,display:Me};return console.log("verticalSliderConfig",Le),{success:!0,name:f,matrix:E,x_axis:me,y_axis:ye,distance_select:r,type:ve,color_info:Ne,selectedFeatureStatistics:O,indentedList:M,showSource:s,highlight_flag:I,verticalSliderConfig:Le}}return console.log("Unknown data type : ",_e),{success:!1}}},{key:"onAxisChange",value:function(e){this.setState({axis_select:e})}},{key:"onDistanceChange",value:function(e){this.setState({distance_select:e})}},{key:"onDataSourceChange",value:function(e){this.setState({dataSource_select:e})}},{key:"onColorEncodeChange",value:function(e){this.setState({color_encode:e})}},{key:"onEnableSort",value:function(e){this.setState({enableSorting:e})}},{key:"changeNodeStartIndex",value:function(e){this.setState({node_start_index:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.specificNodeIdList,i=n.common.graph_explaination.type,o=120;this.props.showSource||(o=100);var s=this.props.width-o-30,c=Math.max(1,Math.floor(s/15)),l=Math.floor(s/c),u=l,d=this.props.height-180-90,h={max_col_num_block:Math.max(1,Math.floor((d+22)/15)),node_start_index:this.state.node_start_index},f=this.constructFeatureMatrixJson(n,a,this.state.axis_select,this.state.distance_select,this.state.dataSource_select,this.state.color_encode,this.props.select_inspect_node,this.props.showSource,this.state.enableSorting,this.props.width,this.props.height,this.props.extendedMode,h);if("MessagePassing"==i&&f.success){var g=180+f.y_axis.length*u+20,p=f.verticalSliderConfig,_={width:this.props.width-o,height:100,x:o,y:0,max_row_num_block:c},v={width:this.props.width-o,height:g-180,x:o,y:180,gridSize:l,max_row_num_block:c},m={width:o,height:g-180,x:0,y:180,barHeight:u},x={width:o-60,height:d,x:0,y:190,node_start_index:p.node_start_index,node_max_index:p.node_max_index,name:"verticalslider_"+p.node_max_index};return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Feature Matrix View",r.createElement("div",{style:{float:"right"}},"Sort features by:\xa0",r.createElement(y.a,{placeholder:"Select a sort mode.",value:e.state.enableSorting?1:0,style:{width:"120px"},onChange:function(t){0===t?e.onEnableSort(!1):e.onEnableSort(!0)},size:"small"},[[0,"Node order"],[1,"Frequency of features"]].map((function(e){return r.createElement(Ge,{value:e[0],key:e[0]},e[1])}))))),r.createElement("div",{className:"ViewBox",style:{width:"100%",height:this.props.height-40+"px",overflowX:"scroll"}},r.createElement("div",{style:{width:"100%"}},r.createElement("div",{style:{width:"100%",height:g+"px"}},r.createElement("svg",{style:{height:"100%",width:"100%"},id:"FeatureMatrixSVGChart",xmlns:"http://www.w3.org/2000/svg"},r.createElement(Ne,{id:3,feature_matrix_json:f,layout_config:_}),r.createElement(Ce,{id:1,feature_matrix_json:f,layout_config:v}),this.props.showSource?r.createElement(Pe,{id:4,feature_matrix_json:f,layout_config:m}):p.display?r.createElement(De,{id:5,feature_matrix_json:f,layout_config:x,changeNodeStartIndex:this.changeNodeStartIndex}):r.createElement("g",null))))))}return r.createElement("div",{style:{width:"100%",height:this.props.height-20+"px",overflowX:"scroll"}},r.createElement("div",{className:"ViewTitle"},"Feature Matrix View"))}}]),n}(r.Component),Ve=Object(K.b)((function(e){return{specificNodeIdList:e.specificNodeIdList,showSource:e.showSource,select_inspect_node:e.select_inspect_node,extendedMode:e.extendedMode,K_value:e.K_value}}),(function(e){return{}}))(Ae),Fe=(n(248),n(336)),He=n(340),Re=n(341),ze=n(332),We=n(121),Ue=n.n(We),Ke=window.location.origin,Be=Ue.a.create({baseURL:"".concat(Ke,"/api/"),headers:{"Access-Control-Allow-Origin":"*"}}),Je=window.location.origin,qe=(Ue.a.create({baseURL:"".concat(Je,"/data/"),headers:{"Access-Control-Allow-Origin":"*"}}),Be);function Xe(){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(v.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/datasets",e.next=4,qe.get(t);case 4:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.data);case 7:throw n;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e){return $e.apply(this,arguments)}function $e(){return($e=Object(v.a)(_.a.mark((function e(t){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/explainMethods",n={model_id:t},e.next=4,qe.get("/explainMethods",{params:n});case 4:if(200!==(r=e.sent).status){e.next=7;break}return e.abrupt("return",r.data);case 7:throw r;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(e){return et.apply(this,arguments)}function et(){return(et=Object(v.a)(_.a.mark((function e(t){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/models",n={dataset_id:t},e.next=4,qe.get("/models",{params:n});case 4:if(200!==(r=e.sent).status){e.next=7;break}return e.abrupt("return",r.data);case 7:throw r;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(e){return nt.apply(this,arguments)}function nt(){return(nt=Object(v.a)(_.a.mark((function e(t){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/graphs",n={dataset_id:t},e.next=4,qe.get("/graphs",{params:n});case 4:if(200!==(r=e.sent).status){e.next=7;break}return e.abrupt("return",r.data);case 7:throw r;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(e,t,n,r){return at.apply(this,arguments)}function at(){return(at=Object(v.a)(_.a.mark((function e(t,n,r,a){var i,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/graph_info",i={dataset_id:t,model_id:n,explain_id:r,graph_id:a},e.next=4,qe.get("/graph_info",{params:i});case 4:if(200!==(o=e.sent).status){e.next=7;break}return e.abrupt("return",o.data);case 7:throw o;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function it(e){return ot.apply(this,arguments)}function ot(){return(ot=Object(v.a)(_.a.mark((function e(t){var n,r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=10;break;case 4:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.data);case 7:throw n;case 10:return"/graph_bundle_info",r={dataset_id:t},e.next=14,qe.get("/graph_bundle_info",{params:r});case 14:if(200!==(a=e.sent).status){e.next=17;break}return e.abrupt("return",a.data);case 17:throw a;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var st=y.a.Option,ct=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onModelSelectorChange=r.onModelSelectorChange.bind(Object(l.a)(r)),r.onDatasetSelectorChange=r.onDatasetSelectorChange.bind(Object(l.a)(r)),r.onExplainMethodSelectorChange=r.onExplainMethodSelectorChange.bind(Object(l.a)(r)),r.onGraphSelectorChange=r.onGraphSelectorChange.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.initDatasetList()}},{key:"initDatasetList",value:function(){var e=Object(v.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe();case 2:!0===(t=e.sent).success&&this.props.initDatasetList(t.datasets);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initModelList",value:function(){var e=Object(v.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(t);case 2:!0===(n=e.sent).success&&this.props.initModelList(n.models);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initExplainList",value:function(){var e=Object(v.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze(t);case 2:!0===(n=e.sent).success&&this.props.initExplainList(n.explainMethods);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initGraphList",value:function(){var e=Object(v.a)(_.a.mark((function e(t){var n,r,a,i,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,tt(t);case 3:if(!0===(n=e.sent).success){for(r=[],a=n.graphs,i=0;i<a.length;i++)o={key:a[i][0],graphno:a[i][0],name:a[i][1]},r.push(o);this.props.initGraphList(r)}case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onModelSelectorChange",value:function(e){this.props.changeModel(e),this.props.changeExplainMethod(null),this.initExplainList(e)}},{key:"onDatasetSelectorChange",value:function(e){this.props.changeDataset(e),this.props.clearIdInfo()}},{key:"onExplainMethodSelectorChange",value:function(e){this.props.changeExplainMethod(e)}},{key:"onGraphSelectorChange",value:function(e){this.props.clearIdInfo(),this.props.changeGraph(e)}},{key:"render",value:function(){var e=this.props.datasetList.length<=0;return r.createElement(He.a,null,"Datasets:\xa0",r.createElement(y.a,{placeholder:"Select a dataset",value:this.props.dataset_id||void 0,style:{width:"200px"},onChange:this.onDatasetSelectorChange,disabled:e},this.props.datasetList.map((function(e){return r.createElement(st,{value:e.id,key:e.id},e.name)}))))}}]),n}(r.Component),lt=Object(K.b)((function(e){return{model_id:e.model,graph_id:e.graph,dataset_id:e.dataset_id,explain_id:e.explain_id,modelList:e.modelList,datasetList:e.datasetList,explainList:e.explainList,graphList:e.graphList}}),(function(e){return{changeModel:function(t){return e(function(e){return{type:"MODEL_CHANGE",model:e}}(t))},changeDataset:function(t){return e(function(e){return{type:"DATASET_ID_CHANGE",dataset_id:e}}(t))},changeExplainMethod:function(t){return e(function(e){return{type:"EXPLAIN_METHOD_ID_CHANGE",explain_id:e}}(t))},changeGraph:function(t){return e(function(e){return{type:"GRAPH_CHANGE",graph:e}}(t))},clearIdInfo:function(){return e({type:"CLEAR_ID_INFO"})},initModelList:function(t){return e(function(e){return{type:"INIT_MODEL_LIST",modelList:e}}(t))},initDatasetList:function(t){return e(function(e){return{type:"INIT_DATASET_LIST",datasetList:e}}(t))},initExplainList:function(t){return e(function(e){return{type:"INIT_EXPLAIN_LIST",explainList:e}}(t))},initGraphList:function(t){return e(function(e){return{type:"INIT_GRAPH_LIST",graphList:e}}(t))}}}))(ct),ut=Fe.a.Group,dt=["All","Training","Validation","Test"],ht=["Train","Valid","Test","Others"],ft=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).min_K_value=1,r.max_K_value=5,r.handleKvalueChange=function(e){e>=r.min_K_value&&e<=r.max_K_value?r.props.changeK_value(e):e<r.min_K_value?r.props.changeK_value(r.min_K_value):e>r.max_K_value&&r.props.changeK_value(r.max_K_value)},r.onChangeRadioCategory=r.onChangeRadioCategory.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"transformCategoryList",value:function(e){if(4===e.length)return dt[0];if(1===e.length){var t=e[0];if("Train"===t)return dt[1];if("Valid"===t)return dt[2];if("Test"===t)return dt[3]}return console.log("Some errors occur in categoryList"),"All"}},{key:"onChangeRadioCategory",value:function(e){var t=e.target.value,n=[];t===dt[0]?n=ht:t===dt[1]?n=[ht[0]]:t===dt[2]?n=[ht[1]]:t===dt[3]?n=[ht[2]]:(console.log("Some errors occur in onChangeRadioCategory selectedValue"),n=ht),this.props.onChangeInspectCategoryList(n)}},{key:"render",value:function(){var e=this.transformCategoryList(this.props.InspectCategoryList),t=this.min_K_value,n=this.max_K_value,a=this.props.K_value;return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Control Panel"),r.createElement("div",{className:"ViewBox"},r.createElement(He.a,null,r.createElement(lt,null)),this.props.dataset_id&&this.props.dataset_id>=0?r.createElement(He.a,null,"Inspect category:\xa0\xa0",r.createElement(ut,{value:e,onChange:this.onChangeRadioCategory},dt.map((function(e,t){return r.createElement(Fe.a,{key:e,value:e},e)})))):r.createElement("div",null),this.props.dataset_id&&this.props.dataset_id>=0?r.createElement(He.a,null,r.createElement(He.a,null,"K value:"),r.createElement(He.a,null,r.createElement(Re.a,{span:18},r.createElement(ze.a,{min:t,max:n,onChange:this.handleKvalueChange,value:"number"===typeof a?a:0})),r.createElement(Re.a,{span:4},r.createElement(b.a,{min:t,max:n,style:{margin:"0 16px"},value:a,onChange:this.handleKvalueChange})))):r.createElement("div",null)))}}]),n}(r.Component),gt=Object(K.b)((function(e){return{InspectCategoryList:e.InspectCategoryList,dataset_id:e.dataset_id,K_value:e.K_value}}),(function(e){return{onChangeInspectCategoryList:function(t){return e({type:"INSPECT_CATEGORY_LIST_CHANGE",inspectCategoryList:t})},changeK_value:function(t){return e(Q(t))}}}))(ft),pt=(n(284),n(27)),_t=(n(285),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onRibbonClick=r.onRibbonClick.bind(Object(l.a)(r)),r.clearFilter=r.clearFilter.bind(Object(l.a)(r)),r.onCategoryClick=r.onCategoryClick.bind(Object(l.a)(r)),r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.PSJson.name===this.props.PSJson.name&&this.comparePSDimensions(e.PSDimensions,this.props.PSDimensions)||(pt.selectAll("#ParallelSets_SVG").remove(),this.props.changeFilters({}),this.renderD3())}},{key:"comparePSDimensions",value:function(e,t){if(e.length!==t.length)return 0;for(var n=1,r=0;r<e.length;r++)if(e[r]!==t[r]){n=0;break}return n}},{key:"onRibbonClick",value:function(e){for(var t={},n=e.data;n&&n.hasOwnProperty("parent");)t[n.dimension]=[n.name],n=n.parent;this.props.changeFilters(t)}},{key:"onCategoryClick",value:function(e){console.log("onCategoryClick",e);var t={},n=e.data;t[n.dimension.name]=[n.name],this.props.changeFilters(t)}},{key:"clearFilter",value:function(){console.log("clearFilter"),this.props.changeFilters({})}},{key:"renderD3",value:function(){var e=this.props,t=e.width,n=e.height,r=e.PSJson,a=e.PSDimensions,i=r.PSData,o=a;if(o.length<=1)console.log("The number of dimensions must be larger or equal to 2.");else{var s=pt.parsets().dimensions(o).width(t).height(n).tension(1).on("ribbonClick",this.onRibbonClick).on("sortDimensions",this.clearFilter).on("sortCategories",this.clearFilter).on("categoryClick",this.onCategoryClick),c=i;pt.select("#parallelSets").append("svg").attr("id","ParallelSets_SVG").attr("width",s.width()).attr("height",s.height()).datum(c).call(s)}}},{key:"render",value:function(){return r.createElement("div",{id:"parallelSets"})}}]),n}(r.Component)),vt=Object(K.b)((function(e){return{PSDimensions:e.PSDimensions}}),(function(e){return{changeFilters:function(t){return e(function(e){return{type:"FILTERS_CHANGE",filters:e}}(t))}}}))(_t),mt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement(x.a,null," ",H(this.props.PSSelectedNodes,this.props.totalNodeNum))}}]),n}(r.Component),yt=Object(K.b)((function(e){return{PSSelectedNodes:e.PSSelectedNodes}}),(function(e){return{}}))(mt),xt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).min_K_value=1,r.max_K_value=5,r.handleOk=function(e){console.log(e),r.props.PSSettingModal_visible_setting(!1)},r.handleCancel=function(e){console.log(e),r.props.PSSettingModal_visible_setting(!1)},r.handleChange=function(e){e.length<2?console.log("Modal Warning: the number of dimensions cannot be less than 2."):r.props.changePSDimensions(e)},r.handleKvalueChange=function(e){e>=r.min_K_value&&e<=r.max_K_value?r.props.changeK_value(e):e<r.min_K_value?r.props.changeK_value(r.min_K_value):e>r.max_K_value&&r.props.changeK_value(r.max_K_value)},r.state={},r}return Object(c.a)(n,[{key:"render",value:function(){for(var e=y.a.Option,t=[],n=(this.min_K_value,this.max_K_value,this.props.K_value,this.props.CandidatePSDimensions),a=0;a<n.length;a++)t.push(r.createElement(e,{key:n[a]},n[a]));return this.props.PSDimensions.length<=0&&this.props.changePSDimensions(this.props.DefaultPSDimensions),console.log("Parallel Sets View Settings Modal, ",this.props.PSSettingModal_visible),r.createElement(J.a,{title:"Parallel Sets View Settings",visible:this.props.PSSettingModal_visible,onOk:this.handleOk,onCancel:this.handleCancel,footer:[r.createElement(w.a,{key:"OK",type:"primary",onClick:this.handleOk},"OK")]},"Dimensions Selection:",r.createElement(y.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select dimensions.",value:this.props.PSDimensions,onChange:this.handleChange},t))}}]),n}(r.Component),bt=Object(K.b)((function(e){return{PSSettingModal_visible:e.PSSettingsModal_visible,PSDimensions:e.PSDimensions,K_value:e.K_value}}),(function(e){return{PSSettingModal_visible_setting:function(t){return e(Z(t))},changePSDimensions:function(t){return e(ee(t))},changeK_value:function(t){return e(Q(t))}}}))(xt),wt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prev_bundle_id=-1,r.state={},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"getSimilarityFeatureSet",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;function o(e,t,n,r){for(var a=e.length,i=n.length,o=0,s=0,c=0,l=0;l<a;l++){var u=n.indexOf(e[l]);u>=0&&(o+=t[l]*r[u]),s+=t[l]*t[l]}for(var d=0;d<i;d++)c+=r[d]*r[d];(s=Math.sqrt(s))<1e-8&&(s=1e-8),(c=Math.sqrt(c))<1e-8&&(c=1e-8);var h=o/(s*c);return h>=1?h=1:h<0&&(h=0),h}for(var s={},c=0;c<e.length;c++){for(var l=0,u=[],d=[],h=0;h<t.length;h++){var f=e[c],g=t[h],p=o(n[f],r[f],n[g],r[g]);p>l?(l=p,u=[t[h]]):p===l&&u.push(t[h]),d.push({anchor_id:g,anchor_label:a[g],anchor_similarity:p})}var _=(d=d.sort((function(e,t){return e.anchor_similarity>t.anchor_similarity?-1:1}))).slice(0,i);s[""+e[c]]={feature_similarity:l,feature_sim_set:u,topk_anchor_similarity_list:_}}return s}},{key:"getShortestPathDistanceSet",value:function(e,t,n,r){console.log("getShortestPathDistanceSet begin anchor_list.length",r.length);for(var a={},i=new Set(r),o=0;o<e.length;o++){var s=[];s.push([e[o],0]);for(var c="inf",l=[],u=new Array(t).fill(0);s.length>0;){var d=s.shift();if(!u[d[0]])if(u[d[0]]=1,i.has(d[0]))if("inf"===c)c=d[1],l.push(d[0]);else{if(c!==d[1])break;l.push(d[0])}else for(var h=n[d[0]],f=0;f<h.length;f++)u[h[f]]||s.push([h[f],d[1]+1])}a[""+e[o]]={shortest_path_distance:c,shortest_path_set:l}}return console.log("getShortestPathDistanceSet end"),a}},{key:"constructPSJson",value:function(e,t,n,r,a,i,o,s){console.log("constructPSJson",e);var c,l,u=i.join("_"),d=e,h=e;d=e.common,h=e.individual,c=d.name+"_"+d.dataset_id+"_"+t+"_"+d.data_type_id+"_CheckedList_"+u+"_CheckedList_End_"+o+"_"+s+"_"+this.props.K_value,l=h.GCN.graph_out;var f=d.graph_in,g=d.graph_target,p=d.graph_explaination.type;if("MessagePassing"!==p)return console.log("Unsupported explaination type , ",p),{success:!1};var _=d.data_type_id;var v=A(f),y=d.mask;function x(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];if(0===t)return e;for(var r=0;r<e.length;r++)e[r]=e[r]/t;return e}var b=new Set(d.mask.train);function w(e){var t=g.node_features[e],n=h.GCN.graph_out.node_features[e],r=h.MLP.graph_out.node_features[e],a=h.GCN_Identity_features.graph_out.node_features[e];return[j(t,2),j(n,3),j(r,3),j(a,3),F(e,b)]}function C(e,t){return e.active?e.end<t.start?{active:!0,start:e.start,end:t.end,count:e.count+t.count}:(console.log("invalid added"),{active:!1}):t.active?t:(console.log("inactive added"),{active:!1})}function S(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=e.length,r={},a=0;a<n;a++)r[e[a]]?r[e[a]]=r[e[a]]+1:r[e[a]]=1;for(var i=Object.keys(r),o=[],s=0;s<i.length;s++)o.push(parseFloat(i[s]));var c=function(e,t){return e-t};o=o.sort(c);for(var l=[],u={active:!1},d={active:!1},h=n/t,f=0;f<o.length;f++){var g={active:!0,start:o[f],end:o[f],count:r[o[f]]};(d=C(u,g)).active&&(d.count<h?f===i.length-1&&(l.push(d),d={active:!1}):d.count>=2*h?(u.active&&l.push(u),l.push(g),d={active:!1}):(l.push(d),d={active:!1}),u=Object.assign({},d))}for(var p=0;p<l.length;p++){var _=l[p].start,v=l[p].end;l[p].name=_===v?""+v:"["+_.toFixed(2)+","+v.toFixed(2)+"]"}return l}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n].start,a=t[n].end;if(e>=r&&e<=a)return t[n].name}return""+e}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n].start,a=t[n].end;if(e>=r&&e<=a)return t[n].name}return""+e}function M(e){for(var t=[],n=0,r=0;r<e.length;r++)0==r?(n=e[r],t.push(r)):e[r]>n?(n=e[r],t=[r]):e[r]==n&&t.push(r);return t.length>=2?-1:t[0]}function L(e,t){for(var n=new Array(t).fill(0),r=0;r<e.length;r++){var a=e[r].anchor_label;n[a]=n[a]+1}return x(n)}if(2===_){var E,P,O=g.node_features.length,I=d.graph_additional_info.num_class,D=function(e,t,n){for(var r=n.train,a=n.test,i=n.valid,o=[].concat(Object(m.a)(r),Object(m.a)(a),Object(m.a)(i)),s=[],c=0;c<e;c++)o.indexOf(c)>=0||s.push(c);var l=[];return t.indexOf("Train")>=0&&(l=l.concat(r)),t.indexOf("Test")>=0&&(l=l.concat(a)),t.indexOf("Valid")>=0&&(l=l.concat(i)),t.indexOf("Others")>=0&&(l=l.concat(s)),l}(O,i,y),T=function(e,t,n,r){for(var a,i,o,s,c,l=[],u=[],d=[],h=0;h<e;h++){var f=0,g=0,p=n[h],_=r[h],v={cgt_npt:0,cgt_ngt:0,cpt_npt:0,cpt_ngt:0};if(h in t){f=t[h].length;for(var m=0,y=0;y<f;y++){var x=t[h][y];n[x]===r[x]&&(m+=1),a=v,i=p,o=_,s=n[x],c=r[x],i===s&&(a.cgt_ngt=a.cgt_ngt+1),i===c&&(a.cgt_npt=a.cgt_npt+1),o===s&&(a.cpt_ngt=a.cpt_ngt+1),o===c&&(a.cpt_npt=a.cpt_npt+1),v=a}0===f?(g=0,v.cgt_ngt=0,v.cgt_npt=0,v.cpt_ngt=0,v.cpt_npt=0):(g=m/f,v.cgt_ngt=v.cgt_ngt/f,v.cgt_npt=v.cgt_npt/f,v.cpt_ngt=v.cpt_ngt/f,v.cpt_npt=v.cpt_npt/f)}l.push(f),u.push(g),d.push(v)}return{degree_list:l,one_hop_accuracy_list:u,cn_consistency_list:d}}(O,v,g.node_features,l.node_features);E=d.graph_additional_info.SPD,P=d.graph_additional_info.KFS;for(var G=T.degree_list,V=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=e.length,r={},a=0;a<n;a++)r[e[a]]?r[e[a]]=r[e[a]]+1:r[e[a]]=1;for(var i=Object.keys(r),o=[],s=0;s<i.length;s++)o.push(parseInt(i[s]));var c=function(e,t){return e-t};o=o.sort(c);for(var l=[],u={active:!1},d={active:!1},h=n/t,f=0;f<o.length;f++){var g={active:!0,start:o[f],end:o[f],count:r[o[f]]};(d=C(u,g)).active&&(d.count<h?f===i.length-1&&(l.push(d),d={active:!1}):d.count>=2*h?(u.active&&l.push(u),l.push(g),d={active:!1}):(l.push(d),d={active:!1}),u=Object.assign({},d))}for(var p=0;p<l.length;p++){var _=l[p].start,v=l[p].end;l[p].name=_===v?""+v:"["+_+","+v+"]"}return l}(G.slice()),H=T.one_hop_accuracy_list,R=T.cn_consistency_list,z=[],U=h.GCN.real_model_name,K=h.MLP.real_model_name,B=h.GCN_Identity_features.real_model_name,J=[U,K,B],q=U+"_correctness",X=K+"_correctness",Y=B+"_correctness",Z=U+"_one_hop_accuracy",$="Nearest_training_nodes_dominant_label_consistency",Q="Top-k_most_similar_training_nodes_dominant_label_consistency",ee="Shortest_Path_Distance_to_Training_Nodes",te=[q,$,Q,"Label"],ne=["Label",q,Z,X,Y,"Degree",ee,"Label_consistency","Label-Prediction_consistency","Prediction-Label_consistency","Prediction_consistency",$,Q,"Confidence"],re=0;re<I;re++)ne.push("Nearest_training_nodes_label_distribution_"+re);for(var ae=0;ae<I;ae++)ne.push("Top-k_most_similar_training_nodes_label_distribution_"+ae);for(var ie=0,oe={},se=(function(){var e=d.graph_additional_info,t=e.num_class,n=[];if(Object.keys(e).indexOf("idx_to_class")>=0)for(var r=e.idx_to_class,a=0;a<t;a++)n.push(r[a]);else for(var i=0;i<t;i++)n.push(""+i)}(),0);se<D.length;se++){var ce=D[se],le={},ue=g.node_features[ce],de=l.node_features[ce],he=l.output_vector[ce][de],fe=h.MLP.graph_out.node_features[ce],ge=h.GCN_Identity_features.graph_out.node_features[ce];le.Data_id=ce,le.Color=w(ce),le.Shortest_Path_Distance_to_Train_Nodes=E[ce].dis,le.Spd_node_info=E[ce].train_nodes,"inf"===le.Shortest_Path_Distance_to_Train_Nodes||le.Shortest_Path_Distance_to_Train_Nodes>=5?le.Transformed_Distance=0:le.Transformed_Distance=1-.2*le.Shortest_Path_Distance_to_Train_Nodes,le[ee]=le.Shortest_Path_Distance_to_Train_Nodes,le.Spd_node_info[de],le.Spd_node_info[de]>=Math.max.apply(Math,Object(m.a)(le.Spd_node_info))&&1,le.Topkfs_node_info=P[ce].train_nodes,le.Topkfs_nodes=P[ce].details,le.Topkfs_nodes=W(le.Topkfs_nodes,this.props.K_value),le.Topkfs_node_info=L(le.Topkfs_nodes,I),le.Topkfs_nodes=le.Topkfs_nodes.sort((function(e,t){return e.anchor_label<t.anchor_label?-1:e.anchor_label>t.anchor_label?1:e.anchor_similarity>t.anchor_similarity?-1:1})),le.CN_consistency=R[ce],le.Degree=N(G[ce],V),le.Real_Degree=G[ce],le.Ground_Truth_Label=""+ue,ue in oe||(oe[ue]={correct_num:0,wrong_num:0}),le.Label=le.Ground_Truth_Label,le.GCN_Prediction_Label=""+de,le.GCN_Confidence=he,le["GCN(w/o_adj)_Prediction_Label"]=""+fe,le["GCN(w/o_features)_Prediction_Label"]=""+ge,le[X]=fe===ue?"Correct":"Wrong",le[Y]=ge===ue?"Correct":"Wrong",ue===de?(le[q]="Correct",ie+=1,oe[ue].correct_num=oe[ue].correct_num+1):(le[q]="Wrong",oe[ue].wrong_num=oe[ue].wrong_num+1),le[Z]=""+H[ce];var pe=H[ce];pe>0&&pe<1&&(le[Z]="(0,1)"),z.push(le)}for(var _e,ve=[[],[],[],[]],me=[],ye=[],xe=[],be=[[],[],[],[]],we=[],Ce=[],Se=0;Se<I;Se++)me.push([]),ye.push([]),we.push([]),Ce.push([]);for(var ke=0;ke<z.length;ke++){var Ne=z[ke],Me=Ne.CN_consistency;ve[0].push(Me.cgt_ngt),ve[1].push(Me.cgt_npt),ve[2].push(Me.cpt_ngt),ve[3].push(Me.cpt_npt);for(var Le=Ne.Spd_node_info,Ee=Ne.Topkfs_node_info,Pe=0;Pe<I;Pe++)me[Pe].push(Le[Pe]),ye[Pe].push(Ee[Pe]);xe.push(Ne.GCN_Confidence)}for(var Oe=0;Oe<ve.length;Oe++)be[Oe]=S(ve[Oe]);for(var Ie=0;Ie<me.length;Ie++)we[Ie]=S(me[Ie]);for(var je=0;je<ye.length;je++)Ce[je]=S(ye[je]);_e=S(xe);for(var De=0;De<z.length;De++){var Te=z[De],Ge=Te.CN_consistency;Te.Label_consistency=k(Ge.cgt_ngt,be[0]),Te["Label-Prediction_consistency"]=k(Ge.cgt_npt,be[1]),Te["Prediction-Label_consistency"]=k(Ge.cpt_ngt,be[2]),Te.Prediction_consistency=k(Ge.cpt_npt,be[3]);for(var Ae=Te.Spd_node_info,Ve=Te.Topkfs_node_info,Fe=0;Fe<I;Fe++)Te["Nearest_training_nodes_label_distribution_"+Fe]=k(Ae[Fe],we[Fe]),Te["Top-k_most_similar_training_nodes_label_distribution_"+Fe]=k(Ve[Fe],Ce[Fe]);var He=M(Ae),Re=M(Ve);-1===He?(Te.SPD_label="Not Sure",Te[$]="Not Sure"):(Te.SPD_label=""+He,Te.Ground_Truth_Label===Te.SPD_label?Te[$]="True":Te[$]="False"),-1===Re?(Te.KFS_label="Not Sure",Te[Q]="Not Sure"):(Te.KFS_label=""+Re,Te.Ground_Truth_Label===Te.KFS_label?Te[Q]="True":Te[Q]="False"),Te.Confidence=k(Te.GCN_Confidence,_e)}z.columns=ne,z.default_columns=te;for(var ze=Object.keys(oe),We=0,Ue=0;Ue<ze.length;Ue++){var Ke=oe[ze[Ue]],Be=Ke.correct_num+Ke.wrong_num;Ke.accuracy=Be>0?Ke.correct_num/Be:0,Ke.total=Be,Be>We&&(We=Be)}for(var Je=0;Je<ze.length;Je++){var qe=oe[ze[Je]];qe.max_percentage=We>0?qe.total/We:0}return D.length<=0?(console.log("No selected data."),{success:!1}):{success:!0,name:c,PSData:z,accuracy:ie/D.length,nodenum:D.length,pie_name:J}}return console.log("Unknown data type : ",_),{success:!1}}},{key:"showPSSettingModal",value:function(){this.props.changePSSettingsModal_visible(!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.show_mode,i=t.explained_node,o=t.onExplainNodeChange,s=t.onShowModeChange,c=this.props.width-10,l=this.props.height-60,u=this.constructPSJson(n,a,i,o,s,this.props.checkedList,c,l);this.props.changePSJson(u);var d=n.bundle_id;return d!==this.prev_bundle_id&&(this.props.changePSDimensions(u.PSData.default_columns),this.prev_bundle_id=d),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Parallel Sets View",r.createElement("div",{style:{float:"right"}},u.success?r.createElement("div",null,r.createElement("div",null,r.createElement(w.a,{type:"default",size:"small",onClick:function(){e.showPSSettingModal()}},r.createElement(U.a,null)),r.createElement(bt,{CandidatePSDimensions:u.PSData.columns,DefaultPSDimensions:u.PSData.default_columns}),"\xa0\xa0\xa0\xa0","#Nodes: ",r.createElement(yt,{totalNodeNum:u.nodenum}))):r.createElement("div",null))),r.createElement("div",{className:"ViewBox"},r.createElement(He.a,{gutter:4},r.createElement(He.a,null,u.success?r.createElement(vt,{width:c,height:l,PSJson:u}):r.createElement("div",null)))))}}]),n}(r.Component),Ct=Object(K.b)((function(e){return{checkedList:e.InspectCategoryList,K_value:e.K_value}}),(function(e){return{changePSJson:function(t){return e(function(e){return{type:"PSJSON_CHANGE",PSJson:e}}(t))},changePSSettingsModal_visible:function(t){return e(Z(t))},changePSDimensions:function(t){return e(ee(t))}}}))(wt),St=(n(286),n(329)),kt=(n(150),n(169)),Nt=n(27),Mt=n(289),Lt=n(295),Et=(y.a.Option,"#bbb"),Pt=2,Ot="2,3",It=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).point_array=[],r.additional_info={},r.model={},r.mappingGraph=r.mappingGraph.bind(Object(l.a)(r)),r.onSelectedNodeListChange=r.onSelectedNodeListChange.bind(Object(l.a)(r)),r.onShowModeChange=r.onShowModeChange.bind(Object(l.a)(r)),r.handleTitleMouseOut=r.handleTitleMouseOut.bind(Object(l.a)(r)),r.handleTitleMouseMove=r.handleTitleMouseMove.bind(Object(l.a)(r)),r.handleGlyphMouseMove=r.handleGlyphMouseMove.bind(Object(l.a)(r)),r.handleGlyphMouseOut=r.handleGlyphMouseOut.bind(Object(l.a)(r)),r.state={showMode:1},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentDidUpdate",value:function(e,t){z(e.selectedNodeIdList,this.props.selectedNodeIdList)&&e.dataPackage.mode===this.props.dataPackage.mode&&e.showMode===this.props.showMode&&e.layoutMode===this.props.layoutMode?e.enableLegends===this.props.enableLegends||this.renderInViewLegend():this.renderD3()}},{key:"onSelectedNodeListChange",value:function(e,t,n){this.props.onChangeHighLightNodeIdList(e,t,n)}},{key:"onHoveredNodeListChange",value:function(e,t,n){this.props.onChangeHoveredNodeIdList(e,t,n)}},{key:"hiddenTooltip",value:function(){Nt.select("#tooltip_proj").style("opacity",0)}},{key:"handleTitleMouseOut",value:function(e){this.hiddenTooltip()}},{key:"handleGlyphMouseOut",value:function(e){this.hiddenTooltip();var t=this.props.showMode;this.onHoveredNodeListChange([],[],t)}},{key:"constructPathOnNodeList",value:function(e){for(var t="",n=0;n<e.length;n++){var r="M";n>0&&(r="L"),t=t+r+e[n][0]+" "+e[n][1]+" "}return t}},{key:"getArc",value:function(e){return Nt.arc().innerRadius(e).outerRadius(2*e)}},{key:"getVariableArc",value:function(e,t){return Nt.arc().innerRadius(e).outerRadius(t)}},{key:"getArcConf",value:function(e,t){return Nt.arc().innerRadius(e).outerRadius(t+e)}},{key:"getSizeScale",value:function(e){return Math.sqrt(1+Math.log(e))}},{key:"renderGlyphGT3PT",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.getArc,s=this.getArcConf,c=this.getSizeScale,l=r-n,u=t.append("circle").attr("class","proj_outer_circle"),d=e.select("circle.proj_outer_circle"),h=u.merge(d);h.attr("r",(function(e){var t=i?c(e.data.size):1;return r*a*t*2})).attr("fill",(function(e){return e.data.Color[4]}));for(var f=[{index:0,value:1/3},{index:1,value:1/3},{index:2,value:1/3}],g=Nt.pie().startAngle(-60/180*Math.PI).endAngle((2-60/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),p=g(f),_=[],v=function(n){var s=t.append("path").attr("class","arc_"+n),l=e.select("path.arc_"+n),u=s.merge(l);u.style("fill",(function(e){return e.data.Color[n+1]})).style("stroke","#bbb").style("stroke-width",1).attr("d",(function(e){var t=1;return i&&(t=c(e.data.size)),o(r*a*t)(p[n])})),_.push(u)},m=0;m<3;m++)v(m);for(var y=Nt.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),x=[],b=2*r+2,w=1,C=function(n){var r=t.append("path").attr("class","arc_"+n),o=e.select("path.arc_"+n),l=r.merge(o);l.style("fill",(function(e){return 3===n?"#000":4===n?"#fff":void 0})).attr("d",(function(e){var t=[{index:0,value:e.data.GCN_Confidence},{index:1,value:1-e.data.GCN_Confidence}],r=y(t),o=1;return i&&(o=c(e.data.size)),s(b*a*o,w*a*o)(r[n-3])})),x.push(l)},S=3;S<5;S++)C(S);var k=t.append("circle").attr("class","inner_circle"),N=e.select("circle.inner_circle"),M=k.merge(N);M.attr("r",(function(e){var t=1;return i&&(t=c(e.data.size)),l*a*t})).attr("fill",(function(e){return e.data.Color[0]}))}},{key:"renderLegendGT3PT",value:function(e,t,n,r,a){var i=this.constructPathOnNodeList,o=a.legend_x,s=a.legend_y,c=a.legend_scale,l={data:{Color:a.legend_Color,Data_id:t,GCN_Confidence:a.legend_conf}},u=a.legend_text_setting,d=2*r+2,h=e.selectAll("g.legend_pie").data([l],(function(e){return e.data.Data_id}));h.exit().remove();var f=h.enter().append("g").attr("class","legend_pie").attr("transform","translate("+o+","+s+")");this.renderGlyphGT3PT(h,f,n,r,c);for(var g=0;g<3;g++){var p=[1.5*c*r*Math.sin(120*g/180*Math.PI),1.5*c*r*-Math.cos(120*g/180*Math.PI)],_=[1.5*c*r*Math.sin(120*g/180*Math.PI),4.5*c*r*-Math.cos(120*g/180*Math.PI)+u[g+1].y_offset];1===g&&(_=[4.5*c*r*Math.sin(120*g/180*Math.PI),4.5*c*r*-Math.cos(120*g/180*Math.PI)+u[g+1].y_offset]);var v=[4.5*c*r*Math.sin(60/180*Math.PI),4.5*c*r*-Math.cos(120*g/180*Math.PI)+u[g+1].y_offset];f.append("path").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("d",i([p,_,v])).attr("fill","none"),f.append("text").attr("x",v[0]).attr("y",v[1]).attr("text-anchor",u[g+1]["text-anchor"]).attr("dominant-baseline",u[g+1]["dominant-baseline"]).text(u[g+1].text)}var m=4.5*c*r*Math.sin(60/180*Math.PI),y=4.5*c*r*-Math.cos(60/180*Math.PI)+u[0].y_offset;f.append("line").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("x1",0).attr("y1",0).attr("x2",m).attr("y2",y),f.append("text").attr("x",m).attr("y",y).attr("text-anchor",u[0]["text-anchor"]).attr("dominant-baseline",u[0]["dominant-baseline"]).text(u[0].text),m=3.5*c*r*Math.sin(.5*Math.PI),y=3.5*c*r*-Math.cos(.5*Math.PI)+u[4].y_offset,f.append("line").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("x1",d*c+.5*c).attr("y1",0).attr("x2",m).attr("y2",y),f.append("text").attr("x",m).attr("y",y).attr("text-anchor",u[4]["text-anchor"]).attr("dominant-baseline",u[4]["dominant-baseline"]).text(u[4].text)}},{key:"renderGlyphDEGCN",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.getSizeScale,s=r.max_degree;function c(e,t,n,r){return[e*r*Math.sin(t/n*Math.PI*2),-e*r*Math.cos(t/n*Math.PI*2)]}function l(e,t){for(var n=[],r=e.length,a=0;a<r;a++)n.push(c(e[a],a,r,t));for(var i="",o=0;o<n.length;o++)i=i+n[o][0]+","+n[o][1]+" ";return i}function u(e){var t=[],r=e.data.Real_Degree;t.push(r/s),t.push(e.data.CN_consistency.cgt_ngt),t.push(e.data.CN_consistency.cgt_npt),t.push(e.data.CN_consistency.cpt_ngt),t.push(e.data.CN_consistency.cpt_npt);var c=i?o(e.data.size):1;return l(t,2*n*a*c)}var d=t.append("circle").attr("class","proj_outer_circle"),h=e.select("circle.proj_outer_circle"),f=d.merge(h);f.attr("r",(function(e){var t=i?o(e.data.size):1;return 2*n*a*t})).attr("fill",(function(e){return e.data.Color[4]}));for(var g=function(r){_=t.append("line").attr("class","background_line_"+r),v=e.select("line.background_line_"+r),_.merge(v).attr("x1",0).attr("y1",0).attr("x2",(function(e){var t=i?o(e.data.size):1;return c(1,r,5,2*n*a*t)[0]})).attr("y2",(function(e){var t=i?o(e.data.size):1;return c(1,r,5,2*n*a*t)[1]})).style("stroke","#bbb").style("stroke-width",2).style("stroke-dasharray","1,1")},p=0;p<5;p++){var _,v;g(p)}var m=t.append("polygon").attr("class","sp_polygon"),y=e.select("polygon.sp_polygon"),x=m.merge(y);x.attr("points",u).style("fill",(function(e){return e.data.Color[0]}))}},{key:"renderLegendDEGCN",value:function(e,t,n,r,a){var i=this.constructPathOnNodeList,o=a.legend_x,s=a.legend_y,c=a.legend_scale,l=a.legend_Color,u=a.legend_text_setting,d={data:{Color:l,Data_id:t,Real_Degree:a.legend_degree,CN_consistency:a.legend_CN_consistency}},h=e.selectAll("g.legend_pie").data([d],(function(e){return e.data.Data_id}));h.exit().remove();var f=h.enter().append("g").attr("class","legend_pie").attr("transform","translate("+o+","+s+")");this.renderGlyphDEGCN(h,f,n,r,c);for(var g=0;g<5;g++){var p=[2*c*n*Math.sin(72*g/180*Math.PI),2*c*n*-Math.cos(72*g/180*Math.PI)],_=[2*c*n*Math.sin(72*g/180*Math.PI),4.5*c*n*-Math.cos(72*g/180*Math.PI)+u[g].y_offset],v=[4.5*c*n*Math.sin(.4*Math.PI),4.5*c*n*-Math.cos(72*g/180*Math.PI)+u[g].y_offset];f.append("path").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("d",i([p,_,v])).attr("fill","none"),f.append("text").attr("x",v[0]).attr("y",v[1]).attr("text-anchor",u[g]["text-anchor"]).attr("dominant-baseline",u[g]["dominant-baseline"]).text(u[g].text)}}},{key:"renderGlyphP1SPD",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=n*r/2*i,c=n*r*i,l=this.getSizeScale,u=this.constructPathOnNodeList,d=t.append("rect").attr("class","gnn_outer_rects"),h=e.select("rect.gnn_outer_rects"),f=d.merge(h);f.attr("x",(function(e){var t=o?l(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return(o?l(e.data.size):1)*s*2})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return e.data.Color[4]}));var g=.25,p=t.append("rect").attr("class","gnnrect"),_=e.select("rect.gnnrect"),v=p.merge(_);v.attr("x",(function(e){var t=o?l(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return(o?l(e.data.size):1)*s-g})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return e.data.Color[1]}));for(var m=function(n){var r=t.append("rect").attr("class","rect_"+n),a=e.select("rect.rect_"+n);r.merge(a).attr("x",(function(e){return g})).attr("y",(function(e){for(var t=o?l(e.data.size):1,r=0,a=0;a<n;a++)r+=e.data.Spd_node_info[a];return t*(r*c-c/2)})).attr("width",(function(e){var t=o?l(e.data.size):1;return s*t-g})).attr("height",(function(e){return(o?l(e.data.size):1)*c*e.data.Spd_node_info[n]})).attr("fill",(function(e){return j(n,2)}))},y=0;y<a;y++)m(y);var x=t.append("path").attr("class","line_distance"),b=e.select("path.line_distance"),w=x.merge(b);w.attr("stroke","#000").attr("stroke-width","2").attr("d",(function(e){var t=e.data.Transformed_Distance,n=o?l(e.data.size):1,r=-s*n,a=-c/2*n-4;return t>1?t=1:t<0&&(t=0),u([[r,a],[r+2*s*n*t,a]])})).attr("fill","none");var C=t.append("rect").attr("class","gnngap"),S=e.select("rect.gnngap"),k=C.merge(S);k.attr("x",(function(e){return-g})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return 2*g})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return"#bbb"}))}},{key:"renderLegendP1SPD",value:function(e,t,n,r){var a=this.constructPathOnNodeList,i=r.legend_x,o=r.legend_y,s=r.legend_scale,c=r.legend_spd_info,l=r.legend_transformed_distance,u=c.length,d=r.legend_Color,h=r.legend_text_setting,f={data:{Color:d,Data_id:t,Spd_node_info:c,Transformed_Distance:l}},g=e.selectAll("g.legend_pie").data([f],(function(e){return e.data.Data_id}));g.exit().remove();var p=g.enter().append("g").attr("class","legend_pie").attr("transform","translate("+i+","+o+")");this.renderGlyphP1SPD(g,p,n,3,u,s);for(var _=3*n/2*s,v=3*n*s,m=0;m<3;m++){var y=[],x=[];if(0===m){x=[[-.5*_,0],[-1.3*_,0],[-1.3*_,-1.5*v],y=[1.5*_,-1.5*v]]}else 1===m?x=[[.5*_,0],[.5*_,.1*v],y=[1.5*_,.1*v]]:2===m&&(x=[[0,-.5*v-1],[0,-.5*v-4],y=[1.5*_,-.5*v-4]]);p.append("path").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("d",a(x)).attr("fill","none");var b=p.append("text").attr("x",y[0]).attr("y",y[1]).attr("text-anchor",h[m]["text-anchor"]).attr("dominant-baseline",h[m]["dominant-baseline"]).text(h[m].text);this.wrapLines(b)}}},{key:"renderGlyphP1KFS",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=n*r/2*i,c=n*r*i,l=this.getSizeScale,u=t.append("rect").attr("class","gnn_outer_rects"),d=e.select("rect.gnn_outer_rects"),h=u.merge(d);h.attr("x",(function(e){var t=o?l(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return(o?l(e.data.size):1)*s*2})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return e.data.Color[4]}));var f=t.append("rect").attr("class","gnnrect"),g=e.select("rect.gnnrect"),p=f.merge(g);p.attr("x",(function(e){var t=o?l(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return(o?l(e.data.size):1)*s})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return e.data.Color[1]}));for(var _=function(n){var r=t.append("rect").attr("class","rect_"+n),a=e.select("rect.rect_"+n);r.merge(a).attr("x",(function(e){return 0})).attr("y",(function(e){for(var t=o?l(e.data.size):1,r=0,a=0;a<n;a++)r+=e.data.Topkfs_node_info[a];return t*(r*c-c/2)})).attr("width",(function(e){var t=o?l(e.data.size):1;return s*t})).attr("height",(function(e){return(o?l(e.data.size):1)*c*e.data.Topkfs_node_info[n]})).attr("fill",(function(e){return j(n,2)}))},v=0;v<a;v++)_(v);var m=.25,y=t.append("rect").attr("class","gnngap"),x=e.select("rect.gnngap"),b=y.merge(x);b.attr("x",(function(e){return-m})).attr("y",(function(e){var t=o?l(e.data.size):1;return-c/2*t})).attr("width",(function(e){return 2*m})).attr("height",(function(e){var t=o?l(e.data.size):1;return c*t})).attr("fill",(function(e){return"#bbb"}))}},{key:"wrapLines",value:function(e){var t,n=e.text().split("\n").reverse(),r=0,a=e.node().getBoundingClientRect().height,i=+e.attr("x"),o=+e.attr("y");for(e.text(null);t=n.pop();)e.append("tspan").attr("x",i).attr("y",r*a+o).text(t),r+=1}},{key:"renderLegendP1KFS",value:function(e,t,n,r){var a=this.constructPathOnNodeList,i=r.legend_x,o=r.legend_y,s=r.legend_scale,c=r.legend_Color,l=r.legend_Topkfs_node_info,u=l.length,d={data:{Color:c,Data_id:t,Topkfs_nodes:r.legend_Topkfs_nodes,Topkfs_node_info:l}},h=r.legend_text_setting,f=e.selectAll("g.legend_pie").data([d],(function(e){return e.data.Data_id}));f.exit().remove();var g=f.enter().append("g").attr("class","legend_pie").attr("transform","translate("+i+","+o+")");this.renderGlyphP1KFS(f,g,n,3,u,s);var p=3*n/2*s,_=3*n*s;for(var v=0;v<2;v++){var m=[],y=[],x=[];0===v?(m=[-.5*p,0],y=[-.5*p,-_],x=[1.5*p,-_]):1===v&&(m=[.5*p,0],y=[.5*p,0],x=[1.5*p,0]),g.append("path").attr("stroke",Et).attr("stroke-width",Pt).style("stroke-dasharray",Ot).attr("d",a([m,y,x])).attr("fill","none");var b=g.append("text").attr("x",x[0]).attr("y",x[1]).attr("text-anchor",h[v]["text-anchor"]).attr("dominant-baseline",h[v]["dominant-baseline"]).text(h[v].text);this.wrapLines(b)}}},{key:"renderLegend",value:function(e){var t=e.configuration,n=e.tooltip_svg,r=e.additional_info,a=e.e,i=e.showMode,o=e.legendMode,s=t.radius,c=n.append("g").attr("width",100).attr("height",70).attr("transform","translate(0,0)");a.refresh_number=a.refresh_number+1;var l=r.pie_name,u=l[0],d=l[1],h=l[2];if(1===i){var f=30,g=50;2===o&&(f=30,g=50);var p={legend_x:f,legend_y:g,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_conf:.66,legend_text_setting:[{text:"Label","text-anchor":"begin","dominant-baseline":"central",y_offset:1},{text:u,"text-anchor":"begin","dominant-baseline":"central",y_offset:-7.5},{text:d,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:h,"text-anchor":"begin","dominant-baseline":"central",y_offset:19},{text:"Conf.","text-anchor":"begin","dominant-baseline":"central",y_offset:0}]};this.renderLegendGT3PT(c,a.refresh_number,.3,s,p)}else if(2===i){var _={legend_x:30,legend_y:45,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:"DEG","text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"L. - p. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"P. - l. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:18},{text:"Pred. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:-22}],legend_degree:8,legend_CN_consistency:{cgt_ngt:.8,cgt_npt:.8,cpt_ngt:.8,cpt_npt:.8}};this.renderLegendDEGCN(c,a.refresh_number,s,{max_degree:10},_)}else if(3===i){var v=20,m=40;2===o&&(v=30,m=50);var y={legend_x:v,legend_y:m,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:u,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Near. train. \n label dist.","text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Closeness","text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_spd_info:[0,.7,.2,.1],legend_transformed_distance:.5};this.renderLegendP1SPD(c,a.refresh_number,s,y)}else if(4===i){var x=20,b=30;2===o&&(x=30,b=50);var w={legend_x:x,legend_y:b,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:u,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Top-k. feat. \n train. l. dist.","text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_Topkfs_nodes:[{anchor_label:0,anchor_similarity:1},{anchor_label:1,anchor_similarity:.9},{anchor_label:2,anchor_similarity:.8},{anchor_label:3,anchor_similarity:.7},{anchor_label:4,anchor_similarity:.6}],legend_Topkfs_node_info:[.2,.2,.2,.2,.2]};this.renderLegendP1KFS(c,a.refresh_number,s,w)}}},{key:"handleTitleMouseMove",value:function(e,t,n){var r;r=[Nt.event.pageX,Nt.event.pageY];var a=100,i=100,o=this.props.showMode;1===o?(a=190,i=100):2===o?(a=300,i=100):3===o?(a=210,i=70):4===o&&(a=280,i=60);var s=Nt.select("#tooltip_proj").style("opacity",.95).style("top",r[1]-i+"px").style("left",r[0]+10+"px");s.selectAll("*").remove();var c={configuration:t,tooltip_svg:s.append("svg").attr("width",a).attr("height",i),additional_info:n,e:e,showMode:o,legendMode:1};this.renderLegend(c)}},{key:"handleGlyphMouseMove",value:function(e,t,n){var r,a=Nt.select(e).data()[0].data;r=[Nt.event.pageX,Nt.event.pageY];var i=100,o=100,s=this.props.showMode,c="",l="";if(1===s)i=215,o=100;else if(2===s)i=330,o=100;else if(3===s){i=215,o=70;for(var u=a.Spd_node_info,d=0;d<u.length;d++)0===u[d]||(c=c+"\nLabel "+d+":"+u[d].toFixed(2),o+=20)}else if(4===s){i=280,o=60;for(var h=a.Topkfs_node_info,f=0;f<h.length;f++)0===h[f]||(l=l+"\nLabel "+f+":"+h[f].toFixed(2),o+=20)}var g=r[1]-(o+=20),p=r[0]+10;4===s&&(p=r[0]-10-i);var _=Nt.select("#tooltip_proj").style("opacity",.95).style("top",g+"px").style("left",p+"px");_.selectAll("*").remove();var v=_.append("svg").attr("width",i).attr("height",o),m=t.radius,y=v,x="";x=1===a.size?"The id of this node:"+a.raw_id_list[0]:"The size of this cluster:"+a.size,y.append("text").attr("x",10).attr("y",5).attr("text-anchor","start").attr("dominant-baseline","hanging").text(x);var b=y.append("g").attr("width",100).attr("height",70).attr("transform","translate(0,20)");e.refresh_number=e.refresh_number+1;var w=n.pie_name,C=w[0],S=w[1],k=w[2];if(1===s){var N={legend_x:30,legend_y:50,legend_scale:2,legend_Color:a.Color,legend_conf:a.GCN_Confidence,legend_text_setting:[{text:"Label:"+a.Ground_Truth_Label,"text-anchor":"begin","dominant-baseline":"central",y_offset:1},{text:C+":"+a.GCN_Prediction_Label,"text-anchor":"begin","dominant-baseline":"central",y_offset:-7.5},{text:S+":"+a["GCN(w/o_adj)_Prediction_Label"],"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:k+":"+a["GCN(w/o_features)_Prediction_Label"],"text-anchor":"begin","dominant-baseline":"central",y_offset:19},{text:"Confidence:"+a.GCN_Confidence.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0}]};this.renderLegendGT3PT(b,e.refresh_number,.3,m,N)}else if(2===s){var M={legend_x:30,legend_y:45,legend_scale:2,legend_Color:a.Color,legend_degree:a.Real_Degree,legend_CN_consistency:a.CN_consistency,legend_text_setting:[{text:"DEG/MAX_DEG:"+a.Real_Degree.toFixed(2)+"/"+n.max_degree,"text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label consistency:"+a.CN_consistency.cgt_ngt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label - prediction consistency:"+a.CN_consistency.cgt_npt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Prediction - label consistency:"+a.CN_consistency.cpt_ngt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:18},{text:"Prediction consistency:"+a.CN_consistency.cpt_npt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:-22}]};this.renderLegendDEGCN(b,e.refresh_number,m,n,M)}else if(3===s){var L=a.Spd_node_info,E=a.Color,P=a.Transformed_Distance,O={legend_x:20,legend_y:40,legend_scale:2,legend_Color:E,legend_text_setting:[{text:C+":"+a.GCN_Prediction_Label,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Nearest training nodes \n label distribution"+c,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Closeness:"+P.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_spd_info:L,legend_transformed_distance:P};this.renderLegendP1SPD(b,e.refresh_number,m,O)}else if(4===s){var I=a.Color,j=a.Topkfs_nodes,D=a.Topkfs_node_info,T={legend_x:20,legend_y:30,legend_scale:2,legend_Color:I,legend_text_setting:[{text:C+":"+a.GCN_Prediction_Label,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Top-k similar features \n training nodes label distribution"+l,"text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_Topkfs_nodes:j,legend_Topkfs_node_info:D};this.renderLegendP1KFS(b,e.refresh_number,m,T)}var G=a.Data_id,A=a.raw_id_list,V=[G];this.onHoveredNodeListChange(A,V,s)}},{key:"renderInViewLegend",value:function(){var e=this.props.enableLegends,t=this.props.showMode,n={radius:3.5,showlabel:!1,width:this.props.width,height:this.props.height},r=this.additional_info,a=n.width,i=n.height;i<1&&(i=1);var o=150;o=Math.min(a,o),Nt.select("#ScatterPlot_sub_legend"+this.props.id).remove();var s=Nt.select("#TopSVGChart_ScatterPlot_Legend_"+this.props.id);if(e){console.log("Enable projection view legends rendering...");var c=s.append("g").attr("id","ScatterPlot_sub_legend"+this.props.id).attr("transform",(function(){return"translate(10,"+(i-110)+")"})).attr("width",o-10).attr("height",100);c.append("rect").attr("x",0).attr("y",0).attr("width",o-10).attr("height",100).attr("fill","white").attr("stroke","#bbb").attr("stroke-width",2).attr("fill-opacity",.9).attr("stroke-opacity",.5);var l={configuration:n,tooltip_svg:c,additional_info:r,e:this,showMode:t,legendMode:2};this.renderLegend(l)}else console.log("Not Enable projection view legends...")}},{key:"mappingGraph",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getSizeScale;null===e?e=this.point_array:this.point_array=e,null===t?t=this.additional_info:this.additional_info=t,null===n?n=this.model:this.model=n;var a=this.props.showMode,i=this.props.layoutMode;if(Nt.select("#ScatterPlot_sub_"+this.props.id).remove(),Nt.select("#ScatterPlot_Legend_sub_"+this.props.id).remove(),!(e.length<=0)){var o=e.length,s={radius:3.5,showlabel:!0,width:this.props.width,height:this.props.height};o>=100&&(s={radius:3.5,showlabel:!1,width:this.props.width,height:this.props.height});var c=Nt.select("#TopSVGChart_ScatterPlot_"+this.props.id),l=s.width,u=s.height;u<1&&(u=1);this.handleTitleMouseMove;var d=c.append("g").attr("id","ScatterPlot_sub_"+this.props.id);d.append("rect").attr("x",0).attr("y",0).attr("width",l).attr("height",u).attr("fill","white").attr("stroke","#bbb").attr("stroke-width",2).attr("fill-opacity",.1).attr("stroke-opacity",.5);var h=Nt.select("#TopSVGChart_ScatterPlot_Legend_"+this.props.id),f=h.append("g").attr("id","ScatterPlot_Legend_sub_"+this.props.id);f.append("text").attr("x",l/2).attr("y",-4).attr("text-anchor","middle").text(this.props.name),this.renderInViewLegend();var g=d.append("g").attr("class","main_drawings");g.attr("width",l).attr("height",u);var p="clip_"+this.props.id,_="url(#"+p+")";g.append("defs").append("clipPath").attr("id",p).append("rect").attr("x",0).attr("y",0).attr("width",l).attr("height",u),g.attr("clip-path",_);var v=g.selectAll("g.nodes").data(e,(function(e,t){return""+e.data.Data_id})),m=v.enter().append("g").attr("class","nodes"),y=v.merge(m).attr("opacity",.9);v.exit().remove();var x=this.handleGlyphMouseMove;y.on("mousemove",F).on("mouseout",this.handleGlyphMouseOut);var b=3,w=.3,C=4.5,S=!0;if(1===a)this.renderGlyphGT3PT(v,m,w,b,1,S);else if(2===a)this.renderGlyphDEGCN(v,m,b,t,1,S);else if(3===a){var k=e[0].data.Spd_node_info.length;this.renderGlyphP1SPD(v,m,b,C,k,1,S)}else if(4===a){k=e[0].data.Topkfs_node_info.length;this.renderGlyphP1KFS(v,m,b,C,k,1,S)}var N=40,M=Nt.scaleLinear().range([N,l-N]),L=Nt.scaleLinear().range([N,u-N]),E=2*b+2*w;2===a||(1===a?E+=3:3!==a&&4!==a||(E=b*C/3*2+w*C/3*2));var P=this.props.renderLines,O=!0;if(o>=2){var I=.1,j=.005;1===i?(I=.1,j=.005):2===i&&(I=.2,j=.005);Nt.forceSimulation(e).alphaDecay(j).alpha(I).force("tsne",(function(t){var r;n.step(),1===i?r=n.getSolution():2===i&&(r=n.getEmbedding()),M.domain(Nt.extent(r.map((function(e){return e[0]})))),L.domain(Nt.extent(r.map((function(e){return e[1]})))),e.forEach((function(e,n){e.x+=t*(M(r[n][0])-e.x),e.y+=t*(L(r[n][1])-e.y)}))})).force("collide",Nt.forceCollide().radius((function(e){var t=1;return S&&(t=r(e.data.size)),t*E}))).on("tick",H)}else H();if(O){var D=function(){V.items().classed("lasso_not_possible",!0).classed("lasso_unselected",!1).classed("lasso_selected",!1)},T=function(){V.possibleItems().classed("lasso_not_possible",!1).classed("lasso_unselected",!1).classed("lasso_possible",!0),V.notPossibleItems().classed("lasso_not_possible",!0).classed("lasso_unselected",!1).classed("lasso_possible",!1)},G=this.onSelectedNodeListChange,A=function(){V.items().classed("lasso_not_possible",!1).classed("lasso_possible",!1),V.selectedItems().classed("lasso_selected",!0);var e,t=V.selectedItems().data();V.notSelectedItems().data().forEach((function(e){e.selected=!1})),V.selectedItems().data().forEach((function(e){e.selected=!0})),0===t.length?(e=V.notSelectedItems().data(),V.notSelectedItems().classed("lasso_unselected",!1)):(e=t,V.notSelectedItems().classed("lasso_unselected",!0)),console.log(e);var n=[];e.forEach((function(e){n=n.concat(e.data.raw_id_list)}));var r=t.map((function(e){return e.data.Data_id}));G(n,r,a)},V=Mt.default().closePathSelect(!0).closePathDistance(100).items(y).targetArea(c).on("start",D).on("draw",T).on("end",A);c.call(V)}this.props.updateSingleHighlightNodeStatus(a)}function F(){x(this,s,t)}function H(){m.merge(v).attr("transform",(function(e){return"translate("+e.x+","+e.y+")"})),O&&P()}}},{key:"renderD3",value:function(){var e,t=this.props.dataPackage,n=t.matrix,r=t.selectedNodeList,a=this.props.dataPackage.additional_info,i=this.props.layoutMode;if(1===i)(e=new Lt.tSNE({dim:2,perplexity:30})).initDataDist(n);else if(2===i){e=new kt.UMAP({nComponents:2,distanceFn:function(e,t){var r=e[0],a=t[0];return n[r][a]},nNeighbors:Math.min(15,n.length-1)});for(var o=[],s=0;s<n.length;s++)o.push([s]);o.length>=2&&e.initializeFit(o)}var c=this.props.width/2,l=this.props.height/2,u=[];r.forEach((function(e,t){u.push({data:e,x:c,y:l})})),(0,this.mappingGraph)(u,a,e)}},{key:"onShowModeChange",value:function(e){this.setState({showMode:e})}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height;return r.createElement("g",null,r.createElement("g",{id:"TopSVGChart_ScatterPlot_"+this.props.id,transform:"translate("+t+","+n+")",width:a,height:i}),r.createElement("g",{id:"TopSVGChart_ScatterPlot_Legend_"+this.props.id,transform:"translate("+t+","+n+")",width:a,height:i}))}}]),n}(r.Component),jt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.createElement(x.a,null," ",H(this.props.ProjectionViewSelectedNodes,this.props.ProjectionViewTotalNodeNum))}}]),n}(r.Component),Dt=Object(K.b)((function(e){return{ProjectionViewSelectedNodes:e.ProjectionViewSelectedNodes,ProjectionViewTotalNodeNum:e.ProjectionViewTotalNodeNum}}),(function(e){return{}}))(jt),Tt=function(){function e(t){Object(s.a)(this,e),this.distance=function(e,t){return 0},this.linkage="single",this.distMatrix=null,this.showMode=1,this.vector_type=[],this.showMode=t}return Object(c.a)(e,[{key:"setlinkage",value:function(e){this.linkage=e}},{key:"setDistMatrix",value:function(e){this.distMatrix=e.map((function(e){return e.slice(0)}))}},{key:"setDistance",value:function(e){this.distance=e}},{key:"cluster",value:function(e){var t,n,r,a,i,o,s,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,l=e.length,u=[],d=[],h=[],f=0,g=[];if(null===this.distMatrix)for(this.distMatrix=[],o=-1;++o<l;)for(u[o]=0,this.distMatrix[o]=[],s=-1;++s<l;)this.distMatrix[o][s]=o===s?1/0:this.distance(e[o],e[s]),this.distMatrix[o][u[o]]>this.distMatrix[o][s]&&(u[o]=s);else{if(this.distMatrix.length<l||this.distMatrix[0].length<l)throw{error:"Provided distance matrix length "+this.distMatrix.length+" instead of "+l};for(o=-1;++o<l;)for(u[o]=0,s=-1;++s<l;)o===s&&(this.distMatrix[o][s]=1/0),this.distMatrix[o][u[o]]>this.distMatrix[o][s]&&(u[o]=s)}for(o=-1;++o<l;)o!=f&&console.log("i = %d, id = %d",o,f),h.push([]),g.push(!0),h[o].push({left:null,right:null,dist:0,centroid:e[o],id:f,size:1,depth:0,id_list:[f]}),f++,d[o]=1;for(i=0;i<l-1;i++){for(t=0,o=0;o<l;o++)this.distMatrix[o][u[o]]<this.distMatrix[t][u[t]]&&(t=o);if(n=u[t],r=h[t][0],a=h[n][0],this.distMatrix[t][n]>c)break;var p={left:r,right:a,dist:this.distMatrix[t][n],centroid:this.calculateCentroid(r.size,r.centroid,a.size,a.centroid),id:f++,size:r.size+a.size,depth:1+Math.max(r.depth,a.depth),id_list:r.id_list.concat(a.id_list)};for(h[t].splice(0,0,p),d[t]+=d[n],s=0;s<l;s++)switch(this.linkage){case"single":this.distMatrix[t][s]>this.distMatrix[n][s]&&(this.distMatrix[s][t]=this.distMatrix[t][s]=this.distMatrix[n][s]);break;case"complete":this.distMatrix[t][s]<this.distMatrix[n][s]&&(this.distMatrix[s][t]=this.distMatrix[t][s]=this.distMatrix[n][s]);break;case"average":this.distMatrix[s][t]=this.distMatrix[t][s]=(d[t]*this.distMatrix[t][s]+d[n]*this.distMatrix[n][s])/(d[t]+d[s])}for(this.distMatrix[t][t]=1/0,g[n]=!1,o=0;o<l;o++)this.distMatrix[o][n]=this.distMatrix[n][o]=1/0;for(s=0;s<l;s++)u[s]==n&&(u[s]=t),this.distMatrix[t][s]<this.distMatrix[t][u[t]]&&(u[t]=s);p}for(var _=[],v=0;v<g.length;v++)!0===g[v]&&_.push(h[v][0]);return _}},{key:"calculateCentroid",value:function(e,t,n,r){for(var a=[],i=e+n,o=t.length,s=-1;++s<o;)a[s]=(e*t[s]+n*r[s])/i;return a}}]),e}(),Gt=n(27),At=function(){function e(){Object(s.a)(this,e),this.CacheDataPackage={},this.filters={},this.PCPJson={},this.pie_name=[],this.selectedNodeList=[],this.initialize_flag=!1,this.cluster_selectedNodeIdIndex=[],this.cluster_highlightNodeIdDict={},this.detail_highlightNodeIdList=[],this.cluster_hoveredNodeIdDict={},this.detail_hoveredNodeIdList=[],this.cluster_rawHoveredNodeIdList=[],this.detail_rawHoveredNodeIdList=[],this.cluster_renderedLinesList=[],this.detail_renderedLinesList=[],this.cluster_hoveredLinesList=[],this.detail_hoveredLinesList=[],this.cluster_rawHighlightNodeIdList=[],this.detail_rawHighlightNodeIdList=[],this.aggregationMode=1,this.getDistance=this.getDistance.bind(this),this.initialize=this.initialize.bind(this),this.checkinitialize=this.checkinitialize.bind(this),this.reset=this.reset.bind(this),this.getDataPackage=this.getDataPackage.bind(this),this.computeDistance=this.computeDistance.bind(this),this.computeDistanceMatrix=this.computeDistanceMatrix.bind(this),this.updateHighlightNodeIdList=this.updateHighlightNodeIdList.bind(this)}return Object(c.a)(e,[{key:"updateAggregationMode",value:function(e){this.aggregationMode=e}},{key:"getAggregationMode",value:function(){return this.aggregationMode}},{key:"getRawHighlightNodeIdList",value:function(){return 1===this.aggregationMode?this.cluster_rawHighlightNodeIdList:2===this.aggregationMode?this.detail_rawHighlightNodeIdList:void 0}},{key:"updateNodeStatistic",value:function(e,t){if(1===this.aggregationMode){var n=this.cluster_rawHighlightNodeIdList.length,r=this.selectedNodeList.length;e(n),t(r)}else if(2===this.aggregationMode){var a=this.cluster_rawHighlightNodeIdList.length;0===a&&(a=this.selectedNodeList.length),e(this.detail_rawHighlightNodeIdList.length),t(a)}}},{key:"calculateHighlightNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1===this.aggregationMode){for(var n={},r={},a={},i=1;i<=4;i++)n[""+i]=this.getDataPackage(i,1),r[""+i]=n[""+i].invertedIndex,a[""+i]=[];for(var o=n[""+t].selectedNodeList,s=[],c=0;c<e.length;c++){var l=o[e[c]].id_list;s=s.concat(l)}for(var u={},d=0;d<s.length;d++){for(var h=s[d],f={size:1},g="LINE_",p=1;p<=4;p++){var _=r[""+p][h];f[""+p]=_,g=g+_+"_"}f.name=g,Object.keys(u).indexOf(g)>=0?u[g].size=u[g].size+1:u[g]=f}for(var v=Object.keys(u).map((function(e){return u[e]})),m=0;m<v.length;m++)for(var y=1;y<=4;y++){var x=v[m][""+y];a[""+y].indexOf(x)>=0||a[""+y].push(x)}this.cluster_selectedNodeIdIndex=s,this.cluster_highlightNodeIdDict=a,this.cluster_renderedLinesList=v,console.log("cluster_highlightNodeIdDict, renderedLinesList, showMode, selectedNodeIdList",this.cluster_highlightNodeIdDict,this.cluster_renderedLinesList,t,s)}else if(2===this.aggregationMode){this.detail_highlightNodeIdList=e;for(var b=[],w=0;w<e.length;w++){for(var C={size:1},S="LINE_",k=1;k<=4;k++)C[""+k]=e[w],S=S+e[w]+"_";C.name=S,b.push(C)}this.detail_renderedLinesList=b,console.log("detail_highlightNodeIdList, renderedLinesList",this.detail_highlightNodeIdList,this.detail_renderedLinesList)}}},{key:"updateFullHighlightStatus",value:function(){for(var e=1;e<=4;e++)this.updateSingleHighlightStatus(e)}},{key:"updateSingleHighlightStatus",value:function(e){1===this.aggregationMode?(this.cluster_highlightNodeIdDict[""+e]||(this.cluster_highlightNodeIdDict[""+e]=[]),this.updateHighlightStatus(this.cluster_highlightNodeIdDict[""+e],e)):2===this.aggregationMode&&this.updateHighlightStatus(this.detail_highlightNodeIdList,e)}},{key:"updateHighlightNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];1===this.aggregationMode?(this.cluster_rawHighlightNodeIdList=n,this.detail_rawHighlightNodeIdList=[],this.detail_highlightNodeIdList=[],this.detail_renderedLinesList=[]):2===this.aggregationMode&&(this.detail_rawHighlightNodeIdList=n),this.calculateHighlightNodeIdList(e,t),this.updateFullHighlightStatus()}},{key:"updateHoveredNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];1===this.aggregationMode?(this.cluster_rawHoveredNodeIdList=n,this.detail_rawHoveredNodeIdList=[],this.detail_hoveredNodeIdList=[]):2===this.aggregationMode&&(this.detail_rawHoveredNodeIdList=n),this.calculateHoveredNodeIdList(e,t),this.updateFullHoveredStatus()}},{key:"calculateHoveredNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1===this.aggregationMode){for(var n={},r={},a={},i=1;i<=4;i++)n[""+i]=this.getDataPackage(i,1),r[""+i]=n[""+i].invertedIndex,a[""+i]=[];for(var o=n[""+t].selectedNodeList,s=[],c=0;c<e.length;c++){var l=o[e[c]].id_list;s=s.concat(l)}for(var u={},d=0;d<s.length;d++){for(var h=s[d],f={size:1},g="LINE_",p=1;p<=4;p++){var _=r[""+p][h];f[""+p]=_,g=g+_+"_"}f.name=g,Object.keys(u).indexOf(g)>=0?u[g].size=u[g].size+1:u[g]=f}for(var v=Object.keys(u).map((function(e){return u[e]})),m=0;m<v.length;m++)for(var y=1;y<=4;y++){var x=v[m][""+y];a[""+y].indexOf(x)>=0||a[""+y].push(x)}this.cluster_hoveredNodeIdDict=a,this.cluster_hoveredLinesList=v}else if(2===this.aggregationMode){this.detail_hoveredNodeIdList=e;for(var b=[],w=0;w<e.length;w++){for(var C={size:1},S="LINE_",k=1;k<=4;k++)C[""+k]=e[w],S=S+e[w]+"_";C.name=S,b.push(C)}this.detail_hoveredLinesList=b}}},{key:"updateFullHoveredStatus",value:function(){for(var e=1;e<=4;e++)this.updateSingleHoveredStatus(e)}},{key:"updateSingleHoveredStatus",value:function(e){1===this.aggregationMode?(this.cluster_highlightNodeIdDict[""+e]||(this.cluster_highlightNodeIdDict[""+e]=[]),this.cluster_hoveredNodeIdDict[""+e]||(this.cluster_hoveredNodeIdDict[""+e]=[]),this.updateHoveredStatus(this.cluster_hoveredNodeIdDict[""+e],this.cluster_highlightNodeIdDict[""+e],e)):2===this.aggregationMode&&this.updateHoveredStatus(this.detail_hoveredNodeIdList,this.detail_highlightNodeIdList,e)}},{key:"updateHoveredStatus",value:function(e,t,n){console.log("updateHoveredStatus",e,n);var r=Gt.select("#ScatterPlot_sub_"+n).select("g.main_drawings").selectAll("g.nodes"),a=r.filter((function(t){return e.indexOf(t.data.Data_id)>=0?(t.hovered=!0,!0):(t.hovered=!1,!1)}));r.classed("hovered",!1),a.classed("hovered",!0)}},{key:"initialize",value:function(e,t){this.reset(),this.filters=e,this.PCPJson=t,this.selectedNodeList=this.constructSelectedNodeList(e,t),this.pie_name=t.pie_name;for(var n=1;n<=4;n++)this.CacheDataPackage[""+n]=this.computeDistance(n);this.initialize_flag=!0}},{key:"checkinitialize",value:function(){return this.initialize_flag}},{key:"reset",value:function(){this.CacheDataPackage={},this.filters={},this.PCPJson={},this.pie_name=[],this.selectedNodeList=[],this.initialize_flag=!1,this.cluster_selectedNodeIdIndex=[],this.cluster_highlightNodeIdDict={},this.detail_highlightNodeIdList=[],this.cluster_renderedLinesList=[],this.detail_renderedLinesList=[],this.cluster_rawHighlightNodeIdList=[],this.detail_rawHighlightNodeIdList=[],this.cluster_hoveredNodeIdDict={},this.detail_hoveredNodeIdList=[],this.cluster_rawHoveredNodeIdList=[],this.detail_rawHoveredNodeIdList=[],this.cluster_hoveredLinesList=[],this.detail_hoveredLinesList=[],this.aggregationMode=1}},{key:"reconstructDataPackage",value:function(e){var t=this.cluster_selectedNodeIdIndex,n=e.matrix,r=e.selectedNodeList,a=t.map((function(e){return r[e]})),i=t.map((function(e){return t.map((function(t){return n[e][t]}))}));return Object(B.a)(Object(B.a)({},e),{},{matrix:i,selectedNodeList:a})}},{key:"getDataPackage",value:function(e,t){if(!(Object.keys(this.CacheDataPackage).indexOf(""+e)>=0))return{};var n="cluster";return 1===t?(n="cluster",this.CacheDataPackage[""+e][n]):2===t?(n="detail",this.cluster_selectedNodeIdIndex.length<=0?this.CacheDataPackage[""+e][n]:this.reconstructDataPackage(this.CacheDataPackage[""+e][n])):void 0}},{key:"getSquareDistance",value:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(Math.abs(e[r]-t[r]),2);return n}},{key:"transformCNtoList",value:function(e){return[e.cgt_ngt,e.cgt_npt,e.cpt_ngt,e.cpt_npt]}},{key:"getDistance",value:function(e,t,n,r){var a=this.getSquareDistance,i=this.transformCNtoList,o=0;if(1===r){for(var s=["Ground_Truth_Label","GCN_Prediction_Label","GCN(w/o_adj)_Prediction_Label","GCN(w/o_features)_Prediction_Label"],c=0;c<s.length;c++)e[s[c]]===t[s[c]]||(o+=1);var l=e.GCN_Confidence,u=t.GCN_Confidence;o+=Math.pow(Math.abs(l-u),2)}else if(2===r){for(var d=["Ground_Truth_Label"],h=0;h<d.length;h++)e[d[h]]===t[d[h]]||(o+=1);var f=e.Real_Degree,g=t.Real_Degree,p=n.max_degree;f/=p,g/=p,o+=Math.pow(Math.abs(f-g),2),o+=a(i(e.CN_consistency),i(t.CN_consistency))}else if(3===r){for(var _=["GCN_Prediction_Label"],v=0;v<_.length;v++)e[_[v]]===t[_[v]]||(o+=1);o+=a(e.Spd_node_info,t.Spd_node_info);var m=e.Transformed_Distance,y=t.Transformed_Distance;o+=(m-y)*(m-y)}else if(4===r){for(var x=["GCN_Prediction_Label"],b=0;b<x.length;b++)e[x[b]]===t[x[b]]||(o+=1);o+=a(e.Topkfs_node_info,t.Topkfs_node_info)}return Math.sqrt(o)}},{key:"constructSelectedNodeList",value:function(e,t){var n=t.PSData.slice(),r=[],a=Object.keys(e);return n.forEach((function(t,n){if(function(t){if(a.length>0){for(var n=0;n<a.length;n++)if(e[a[n]].indexOf(t[a[n]])<0)return!1;return!0}return!0}(t)){var i=t;r.push(i)}})),r}},{key:"aggregateSelectedNodeList",value:function(e,t,n){var r={};if(e.length>=1){for(var a=0;a<t.length;a++){var i=n[a],o=t[a];if("categorical"===i){for(var s={},c=0;c<e.length;c++){var l=e[c][o];Object.keys(s).indexOf(l)>=0?s[l]=s[l]+1:s[l]=1}for(var u=Object.keys(s),d=u[0],h=s[d],f=1;f<u.length;f++)h<s[u[f]]&&(h=s[u[f]],d=u[f]);r[o]=d}else if("continuous"===i){for(var g=0,p=0;p<e.length;p++){g+=e[p][o]}var _=g/e.length;r[o]=_}else if("dict_continuous"===i){for(var v=Object.keys(e[0][o]),m=[],y=0;y<v.length;y++)m.push("continuous");for(var x=[],b=0;b<e.length;b++)x.push(e[b][o]);var w=this.aggregateSelectedNodeList(x,v,m);r[o]=w}else if("vector_continuous"===i){for(var C=[],S=e[0][o].length,k=0;k<S;k++)C[k]=0;for(var N=0;N<e.length;N++)for(var M=0;M<S;M++)C[M]=C[M]+e[N][o][M];for(var L=0;L<S;L++)C[L]=C[L]/e.length;r[o]=C}}return r}return r}},{key:"transformClusterRoot",value:function(e,t,n){for(var r=[],a=e.id_list,i=[],o=0;o<a.length;o++)r.push(t[a[o]]);for(var s=0;s<a.length;s++)i.push(r[s].Data_id);if(1===n){var c={};c=this.aggregateSelectedNodeList(r,["Ground_Truth_Label","GCN_Prediction_Label","GCN(w/o_adj)_Prediction_Label","GCN(w/o_features)_Prediction_Label","GCN_Confidence"],["categorical","categorical","categorical","categorical","continuous"]);var l=[j(c.Ground_Truth_Label,2),j(c.GCN_Prediction_Label,3),j(c["GCN(w/o_adj)_Prediction_Label"],3),j(c["GCN(w/o_features)_Prediction_Label"],3),"#fff"];return c.Color=l,c.id_list=a,c.raw_id_list=i,c.size=a.length,c}if(2===n){var u={};u=this.aggregateSelectedNodeList(r,["Ground_Truth_Label","Real_Degree","CN_consistency"],["categorical","continuous","dict_continuous"]);var d=[j(u.Ground_Truth_Label,2),"#fff","#fff","#fff","#fff"];return u.Color=d,u.id_list=a,u.raw_id_list=i,u.size=a.length,u}if(3===n){var h={};h=this.aggregateSelectedNodeList(r,["GCN_Prediction_Label","Spd_node_info","Transformed_Distance"],["categorical","vector_continuous","continuous"]);var f=["#fff",j(h.GCN_Prediction_Label,3),"#fff","#fff","#fff"];return h.Color=f,h.id_list=a,h.raw_id_list=i,h.size=a.length,h}if(4===n){var g={};if(g=this.aggregateSelectedNodeList(r,["GCN_Prediction_Label","Topkfs_node_info"],["categorical","vector_continuous"]),r.length>=1){for(var p=[],_=0;_<r.length;_++)p=p.concat(r[_].Topkfs_nodes);p.sort((function(e,t){return e.anchor_similarity>t.anchor_similarity?-1:1}));var v=p.slice(0,5);v.sort((function(e,t){return e.anchor_label<t.anchor_label?-1:1})),g.Topkfs_nodes=v}var m=["#fff",j(g.GCN_Prediction_Label,3),"#fff","#fff","#fff"];return g.Color=m,g.id_list=a,g.raw_id_list=i,g.size=a.length,g}return{}}},{key:"computeDistanceMatrix",value:function(e,t,n){for(var r=[],a=this.getDistance,i=0;i<e.length;i++){for(var o=[],s=0;s<e.length;s++)o.push(a(e[i],e[s],t,n));r.push(o)}return r}},{key:"renderLines",value:function(e,t,n){var r=this;if(e){for(var a=[],i=[],o=function(e){var t=void 0;1===r.aggregationMode?(r.cluster_highlightNodeIdDict[""+e]||(r.cluster_highlightNodeIdDict[""+e]=[]),t=r.cluster_highlightNodeIdDict[""+e]):t=r.detail_highlightNodeIdList,c=Gt.select("#ScatterPlot_sub_"+e),l=c.select("g.main_drawings"),u=l.selectAll("g.nodes"),d={},u.data().forEach((function(e){t.indexOf(e.data.Data_id)>=0&&(d[e.data.Data_id]={x:e.x,y:e.y})})),i.push({id:e,point_array:d})},s=1;s<=4;s++){var c,l,u,d;o(s)}var h=(t-20-20)/4-10,f=!0,g=[],p=[];1===this.aggregationMode?(g=this.cluster_renderedLinesList,p=this.cluster_hoveredLinesList):2===this.aggregationMode&&(g=this.detail_renderedLinesList,p=this.detail_hoveredLinesList),p=p.map((function(e){return e.name}));for(var _=0;_<g.length;_++){var v=g[_],m=v.name,y=!1;p.indexOf(m)>=0&&(y=!0),v.hovered=y;for(var x=[],b=0;b<i.length;b++){var w=v[""+(b+1)];if(!i[b].point_array[w]){f=!1;break}var C=20+b*(h+10),S=[i[b].point_array[w].x+C,i[b].point_array[w].y+20];x.push(S)}if(!f)break;a.push({line_package:v,coords:x})}f||(a=[]);var k=Gt.select("#connectionPath");if(k){var N=k.selectAll("path").data(a,(function(e){return e.line_package.name})),M=Gt.line().curve(Gt.curveNatural),L=N.enter().append("path").merge(N);N.exit().remove(),L.attr("d",(function(e){return M(e.coords.slice())})).style("fill","none").style("stroke",(function(e){return!0===e.line_package.hovered?"#000":"#999"})).style("stroke-width",(function(e){return 1.5*Math.sqrt(e.line_package.size)})).style("opacity",.5)}}}},{key:"updateHighlightStatus",value:function(e,t){var n=Gt.select("#ScatterPlot_sub_"+t).select("g.main_drawings").selectAll("g.nodes"),r=n.filter((function(t){return e.indexOf(t.data.Data_id)>=0?(t.selected=!0,!0):(t.selected=!1,!1)}));n.classed("lasso_not_possible",!1).classed("lasso_possible",!1).classed("lasso_selected",!1),e.length>0?n.classed("lasso_unselected",!0):n.classed("lasso_unselected",!1),r.classed("lasso_unselected",!1).classed("lasso_selected",!0)}},{key:"constructInvertedIndex",value:function(e){for(var t={},n=0;n<e.length;n++)for(var r=e[n].Data_id,a=e[n].id_list,i=0;i<a.length;i++)t[a[i]]=r;return t}},{key:"computeDistance",value:function(e){this.getDistance;for(var t,n,r=this.transformCNtoList,a=this.pie_name,i=this.selectedNodeList,o=[],s=0,c=1,l={},u=0;u<i.length;u++){var d=i[u].Shortest_Path_Distance_to_Train_Nodes;"inf"!==d&&d>s&&(s=d);var h=i[u].Real_Degree;h>c&&(c=h),i[u].size=1,i[u].id_list=[i[u].Data_id],i[u].raw_id_list=[i[u].Data_id]}if(l.max_shortest_path_distance=s,l.max_degree=c,l.pie_name=a,t=this.computeDistanceMatrix(i,l,e),1===e)for(var f=["Ground_Truth_Label","GCN_Prediction_Label","GCN(w/o_adj)_Prediction_Label","GCN(w/o_features)_Prediction_Label","GCN_Confidence"],g=0;g<i.length;g++){for(var p=[],_=i[g],v=0;v<f.length;v++)p.push(_[f[v]]);o.push(p)}else if(2===e)for(var m=["Ground_Truth_Label"],y=0;y<i.length;y++){var x=[],b=i[y];x.push(b[m[0]]),x.push(b.Real_Degree),x=x.concat(r(b.CN_consistency)),o.push(x)}else if(3===e)for(var w=["GCN_Prediction_Label"],C=0;C<i.length;C++){var S=[],k=i[C];S.push(k[w[0]]),S=S.concat(k.Spd_node_info),o.push(S)}else if(4===e)for(var N=["GCN_Prediction_Label"],M=0;M<i.length;M++){var L=[],E=i[M];L.push(E[N[0]]),L=L.concat(E.Topkfs_node_info),o.push(L)}var P=new Tt(e);P.setlinkage("complete"),P.setDistMatrix(t);for(var O=P.cluster(o,.5),I=[],j=0;j<O.length;j++){var D=this.transformClusterRoot(O[j],i,e);D.Data_id=j,I.push(D)}return n=I,{cluster:{mode:"cluster",additional_info:l,matrix:this.computeDistanceMatrix(n,l,e),selectedNodeList:n,highlightNodeIdList:[],invertedIndex:this.constructInvertedIndex(n)},detail:{mode:"detail",additional_info:l,matrix:t,selectedNodeList:i,highlightNodeIdList:[]}}}}]),e}(),Vt=y.a.Option,Ft=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prevSelectedNodeIdList=[],r.thisSelectedNodeIdList=[],r.InsProjectionViewComputing=new At,r.onChangeHighLightNodeIdList=r.onChangeHighLightNodeIdList.bind(Object(l.a)(r)),r.onChangeHoveredNodeIdList=r.onChangeHoveredNodeIdList.bind(Object(l.a)(r)),r.renderLines=r.renderLines.bind(Object(l.a)(r)),r.onChangeLines=r.onChangeLines.bind(Object(l.a)(r)),r.onChangeLegends=r.onChangeLegends.bind(Object(l.a)(r)),r.updateSingleHighlightNodeStatus=r.updateSingleHighlightNodeStatus.bind(Object(l.a)(r)),r.onLayoutModeChange=r.onLayoutModeChange.bind(Object(l.a)(r)),r.state={currentPage:1,enableLegends:!0,enableLines:!0,aggregationMode:1,layoutMode:1},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){z(this.prevSelectedNodeIdList,this.thisSelectedNodeIdList)||(this.props.changeSelectedNodeIdList(this.thisSelectedNodeIdList),this.prevSelectedNodeIdList=this.thisSelectedNodeIdList.slice(),this.InsProjectionViewComputing.updateHighlightNodeIdList([]),this.InsProjectionViewComputing.updateHoveredNodeIdList([])),this.state.enableLines&&this.renderLines()}},{key:"constructSelectedNodeList",value:function(e,t){var n=t.PSData.slice(),r=[],a=Object.keys(e);return n.forEach((function(t,n){if(function(t){if(a.length>0){for(var n=0;n<a.length;n++)if(e[a[n]].indexOf(t[a[n]])<0)return!1;return!0}return!0}(t)){var i=t;r.push(i)}})),r}},{key:"renderLines",value:function(){this.InsProjectionViewComputing.renderLines(this.state.enableLines,this.props.width,this.props.height)}},{key:"onChangeHighLightNodeIdList",value:function(e,t,n){this.props.changeSelectedNodeIdList(e.slice()),0===t.length?this.InsProjectionViewComputing.updateHighlightNodeIdList(t.slice(),n,[]):this.InsProjectionViewComputing.updateHighlightNodeIdList(t.slice(),n,e.slice()),this.InsProjectionViewComputing.updateNodeStatistic(this.props.changeProjectionViewSelectedNodes,this.props.changeProjectionViewTotalNodeNum),this.renderLines()}},{key:"onChangeHoveredNodeIdList",value:function(e,t,n){0===t.length?this.InsProjectionViewComputing.updateHoveredNodeIdList(t.slice(),n,[]):this.InsProjectionViewComputing.updateHoveredNodeIdList(t.slice(),n,e.slice()),this.renderLines()}},{key:"updateSingleHighlightNodeStatus",value:function(e){this.InsProjectionViewComputing.updateFullHighlightStatus(e)}},{key:"onChangeLines",value:function(e){this.setState({enableLines:e})}},{key:"onChangeLegends",value:function(e){this.setState({enableLegends:e})}},{key:"onChangeAggregationMode",value:function(e){this.setState({aggregationMode:e})}},{key:"onLayoutModeChange",value:function(e){this.setState({layoutMode:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,a=t.PCPJson;console.log("Selected Node List",n,a);var i,o,s=this.state.layoutMode;a.success?(o=this.constructSelectedNodeList(n,a),i=o.map((function(e){return e.Data_id}))):(o=[],i=[]),this.thisSelectedNodeIdList=i;var c=this.props.height-62-20,l=(this.props.width-20-20)/4-10;this.props.changePSSelectedNodes(o.length);var u=this.onChangeLegends,d=this.onChangeLines;if(i.length>0&&i.length<300){z(this.prevSelectedNodeIdList,this.thisSelectedNodeIdList)||this.InsProjectionViewComputing.initialize(n,a),this.InsProjectionViewComputing.updateAggregationMode(this.state.aggregationMode),this.InsProjectionViewComputing.updateNodeStatistic(this.props.changeProjectionViewSelectedNodes,this.props.changeProjectionViewTotalNodeNum);var h=this.InsProjectionViewComputing.getRawHighlightNodeIdList();return h.length>0&&this.props.changeSelectedNodeIdList(h.slice()),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px"}},r.createElement("div",{className:"ViewTitle"},"Projection View",r.createElement("div",{style:{float:"right"}},1===e.state.aggregationMode?r.createElement(w.a,{type:"default",size:"small",onClick:function(){e.onChangeAggregationMode(2)}},"Detail"):2===e.state.aggregationMode?r.createElement(w.a,{type:"primary",size:"small",onClick:function(){e.onChangeAggregationMode(1)}},"Cluster"):void 0,"\xa0\xa0\xa0\xa0 Layout:\xa0",r.createElement(y.a,{placeholder:"Select a layout",value:s,style:{width:"90px"},onChange:this.onLayoutModeChange,size:"small"},[[1,"t-SNE"],[2,"UMAP"]].map((function(e){return r.createElement(Vt,{value:e[0],key:e[0]},e[1])}))),"\xa0\xa0\xa0\xa0 Legend: ",r.createElement(St.a,{checked:this.state.enableLegends,onChange:u}),"\xa0\xa0\xa0\xa0 Links: ",r.createElement(St.a,{checked:this.state.enableLines,onChange:d}),"\xa0\xa0\xa0\xa0 #Nodes: ",r.createElement(Dt,null))),r.createElement("div",{className:"ViewBox"},r.createElement("svg",{style:{height:this.props.height-62+10+"px",width:this.props.width+"px"},id:"TopSVGChart_ScatterPlot",xmlns:"http://www.w3.org/2000/svg"},this.state.enableLines?r.createElement("g",{key:"c1",id:"connectionPath"}):r.createElement("g",{key:"c2",id:"connectionPath-Null"}),[[1,"Prediction results comparison"],[2,"Surrounding nodes label consistency"],[3,"Training nodes structure influence"],[4,"Training nodes feature influence"]].map((function(t){return r.createElement(It,Object.assign({key:t[0],id:t[0],showMode:t[0]},e.props,{x:20+(t[0]-1)*(l+10),y:20,height:c,width:l,name:t[1],selectedNodeIdList:i,onChangeHighLightNodeIdList:e.onChangeHighLightNodeIdList,onChangeHoveredNodeIdList:e.onChangeHoveredNodeIdList,renderLines:e.renderLines,dataPackage:e.InsProjectionViewComputing.getDataPackage(t[0],e.state.aggregationMode),updateSingleHighlightNodeStatus:e.updateSingleHighlightNodeStatus,enableLegends:e.state.enableLegends,layoutMode:e.state.layoutMode}))})))))}return this.InsProjectionViewComputing.reset(),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Projection View "))}}]),n}(r.Component),Ht=Object(K.b)((function(e){return{filters:e.filters,refreshnumber:e.refreshnumber,showSource:e.showSource,select_inspect_node:e.select_inspect_node,PCPJson:e.PSJson}}),(function(e){return{changeSelectedNodeIdList:function(t){return e(function(e){return{type:"SELECTED_NODE_ID_LIST_CHANGE",selectedNodeIdList:e}}(t))},changeShowSource:function(t){return e(ne(t))},changePSSelectedNodes:function(t){return e(function(e){return{type:"PSSELECTEDNODES_CHANGE",PSSelectedNodes:e}}(t))},changeProjectionViewSelectedNodes:function(t){return e(function(e){return{type:"PROJECTIONVIEWSELECTEDNODES_CHANGE",ProjectionViewSelectedNodes:e}}(t))},changeProjectionViewTotalNodeNum:function(t){return e(function(e){return{type:"PROJECTIONVIEWTOTALNODENUM_CHANGE",ProjectionViewTotalNodeNum:e}}(t))}}}))(Ft),Rt=n(333),zt=n(172),Wt=n.n(zt),Ut=(Rt.a.TabPane,n(27),y.a.Option,function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).PCPViewRef=void 0,a.GraphViewRef=void 0,a.FeatureMatrixViewRef=void 0,a.ControlPanelRef=void 0,a.ProjectionViewRef=void 0,a.onShowModeChange=a.onShowModeChange.bind(Object(l.a)(a)),a.onExplainNodeChange=a.onExplainNodeChange.bind(Object(l.a)(a)),a.onResizeStop=a.onResizeStop.bind(Object(l.a)(a)),a.getLayoutConfigWithName=a.getLayoutConfigWithName.bind(Object(l.a)(a)),a.getCurrentLayoutConfig=a.getCurrentLayoutConfig.bind(Object(l.a)(a)),a.onResize=a.onResize.bind(Object(l.a)(a)),a.PCPViewRef=r.createRef(),a.GraphViewRef=r.createRef(),a.FeatureMatrixViewRef=r.createRef(),a.ControlPanelRef=r.createRef(),a.ProjectionViewRef=r.createRef(),a.state={graph_object:{model:-1,graph:-1},show_mode:1,explained_node:0,layout_config:null,screenWidth:0,screenHeight:0},a}return Object(c.a)(n,[{key:"componentWillMount",value:function(){}},{key:"onResize",value:function(){this.setState({screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"componentDidMount",value:function(){this.setState({layout_config:this.getWholeLayoutConfig(),screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"getgraphdata",value:function(){var e=Object(v.a)(_.a.mark((function e(t,n,r,a){var i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt(t,n,r,a);case 2:!0===(i=e.sent).success&&this.setState({graph_object:i.graph_obj});case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"getGraphBundledData",value:function(){var e=Object(v.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,it(t);case 2:!0===(n=e.sent).success&&(n.graph_obj.bundle_id=t,this.setState({graph_object:n.graph_obj}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLayoutConfigWithName",value:function(e){var t=0,n=0;return"PCPView"===e?this.PCPViewRef&&(t=this.PCPViewRef.current.offsetWidth,n=this.PCPViewRef.current.offsetHeight):"GraphView"===e?this.GraphViewRef&&(t=this.GraphViewRef.current.offsetWidth,n=this.GraphViewRef.current.offsetHeight):"FeatureMatrixView"===e?this.FeatureMatrixViewRef&&(t=this.FeatureMatrixViewRef.current.offsetWidth,n=this.FeatureMatrixViewRef.current.offsetHeight):"ProjectionView"===e?this.ProjectionViewRef&&(t=this.ProjectionViewRef.current.offsetWidth,n=this.ProjectionViewRef.current.offsetHeight):"ControlPanel"===e&&this.ControlPanelRef&&(t=this.ControlPanelRef.current.offsetWidth,n=this.ControlPanelRef.current.offsetHeight),{width:t,height:n}}},{key:"getWholeLayoutConfig",value:function(){var e=this,t={};return["PCPView","GraphView","FeatureMatrixView","ControlPanel","ProjectionView"].forEach((function(n){t[n]=e.getLayoutConfigWithName(n)})),t}},{key:"getCurrentLayoutConfig",value:function(e){var t=this.state.layout_config;return t&&t[e]?t[e]:null}},{key:"componentDidUpdate",value:function(e,t){e.dataset_id!==this.props.dataset_id&&(this.props.dataset_id&&this.props.dataset_id>=0?this.getGraphBundledData(this.props.dataset_id):this.setState({graph_object:{model:-1,graph:-1}})),e.contentHeight===this.props.contentHeight&&e.contentWidth===this.props.contentWidth||this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"onShowModeChange",value:function(e){this.setState({show_mode:e})}},{key:"onExplainNodeChange",value:function(e){this.setState({explained_node:e})}},{key:"onLayoutChange",value:function(e){console.log("Layout",e)}},{key:"onResizeStop",value:function(e){console.log("onResizeStop",e),console.log("Layout",this.getWholeLayoutConfig()),this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"render",value:function(){var e=this,t=this.state,n=t.graph_object,a=t.show_mode,i=t.explained_node,o=this.props.modelList,s=-1,c=-1;s=-1;var l=n.common;l&&(c=l.dataset_id);console.log("Dataruns graph_object",n);var u=function(e,t,n,a,i,o,s,c,l){return r.createElement(he,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:c,height:l})},d=function(e,t,n,a,i,o,s,c,l){return r.createElement(Ve,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:c,height:l})},h=function(e,t,n,a,i,o,s){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return r.createElement(Ct,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:c,height:l})},f=(window.innerHeight,Math.floor(this.props.contentHeight/40)),g=f-4,p=Math.floor(f/2),_=f-p,v=[{i:"a",x:0,y:4,w:6,h:g,static:!0},{i:"b",x:6,y:p,w:11,h:_,static:!0},{i:"c",x:17,y:p,w:7,h:_,static:!0},{i:"d",x:0,y:0,w:6,h:4,static:!0},{i:"e",x:6,y:0,w:18,h:p,static:!0}],m=function(){var t=window.innerWidth;window.innerHeight;return r.createElement(Wt.a,{className:"layout",layout:v,cols:24,rowHeight:30,width:t,onLayoutChange:e.onLayoutChange,onResizeStop:e.onResizeStop},r.createElement("div",{className:"PanelBox",key:"a",ref:e.PCPViewRef},c>=0&&e.getCurrentLayoutConfig("PCPView")?h(n,a,i,e.onExplainNodeChange,e.onShowModeChange,s,o,e.getCurrentLayoutConfig("PCPView").width,e.getCurrentLayoutConfig("PCPView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"b",ref:e.GraphViewRef},c>=0&&e.getCurrentLayoutConfig("GraphView")?u(n,a,i,e.onExplainNodeChange,e.onShowModeChange,s,o,e.getCurrentLayoutConfig("GraphView").width,e.getCurrentLayoutConfig("GraphView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"c",ref:e.FeatureMatrixViewRef},c>=0&&e.getCurrentLayoutConfig("FeatureMatrixView")?d(n,a,i,e.onExplainNodeChange,e.onShowModeChange,s,o,e.getCurrentLayoutConfig("FeatureMatrixView").width,e.getCurrentLayoutConfig("FeatureMatrixView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"d",ref:e.ControlPanelRef},r.createElement(gt,null)),r.createElement("div",{className:"PanelBox",key:"e",ref:e.ProjectionViewRef},c>=0&&e.getCurrentLayoutConfig("ProjectionView")?r.createElement(Ht,{height:e.getCurrentLayoutConfig("ProjectionView").height,width:e.getCurrentLayoutConfig("ProjectionView").width}):r.createElement("div",null)))};return m()}}]),n}(r.Component)),Kt=Object(K.b)((function(e){return{model:e.model,graph:e.graph,dataset_id:e.dataset_id,explain_id:e.explain_id,modelList:e.modelList}}),(function(e){return{}}))(Ut),Bt=h.a.Content,Jt=h.a.Header,qt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).ContentRef=void 0,r.ContentRef=a.a.createRef(),r.onResize=r.onResize.bind(Object(l.a)(r)),r.state={contentWidth:0,contentHeight:0,screenHeight:0,screenWidth:0},r}return Object(c.a)(n,[{key:"getLayoutConfig",value:function(){var e=0,t=0;return this.ContentRef&&(e=this.ContentRef.current.offsetWidth,t=this.ContentRef.current.offsetHeight),{contentWidth:e,contentHeight:t}}},{key:"onResize",value:function(){this.updateLayoutState()}},{key:"updateLayoutState",value:function(){var e=this.getLayoutConfig(),t=e.contentWidth,n=e.contentHeight;this.setState({contentWidth:t,contentHeight:n,screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),this.updateLayoutState()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e=this.state,t=(e.screenWidth,e.screenHeight,e.contentWidth),n=e.contentHeight;return a.a.createElement(h.a,{className:"app"},a.a.createElement(Jt,{className:"appHeader"},"GNNVis",a.a.createElement("img",{src:g.a,className:"appLogo","alt-text":"logo"})),a.a.createElement(Bt,{className:"appContent"},a.a.createElement("div",{style:{height:"100%",width:"100%"},ref:this.ContentRef},t>0&&n>0?a.a.createElement(Kt,{contentWidth:t,contentHeight:n}):a.a.createElement("div",null)),a.a.createElement("div",{id:"tooltip_proj"}),a.a.createElement("div",{id:"tooltip_matrix"})))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Xt=n(174),Yt={model:null,graph:null,dataset_id:null,explain_id:null,refreshnumber:0,showSource:!1,modelList:[],datasetList:[],explainList:[],graphList:[],filters:{},selectedNodeIdList:[],selectedMessagePassingNodeIdList:[],specificNodeIdList:[],select_inspect_node:0,prevGraphJson:null,matrixFilters:{refreshnumber:0},matrixRowFilters:{refreshnumber:0},InspectCategoryList:R,PSJson:{},PSSelectedNodes:0,extendedMode:1,ProjectionViewSelectedNodes:0,ProjectionViewTotalNodeNum:0,PSSettingsModal_visible:!1,PSDimensions:[],ProjectionViewSettingsModal_visible:!1,GraphViewSettingsModal_visible:!1,FeatureMatrixViewSettingsModal_visible:!1,GraphViewState:{DisplayUnfocusedNodes:!1,DisplayOverview:!0},K_value:5},Zt=(n(317),n(318),Object(Xt.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MODEL_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{model:t.model});case"GRAPH_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{graph:t.graph});case"INIT_MODEL_LIST":return Object(B.a)(Object(B.a)({},e),{},{modelList:t.modelList});case"DATASET_ID_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{dataset_id:t.dataset_id});case"EXPLAIN_METHOD_ID_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{explain_id:t.explain_id});case"INIT_DATASET_LIST":return Object(B.a)(Object(B.a)({},e),{},{datasetList:t.datasetList});case"INIT_EXPLAIN_LIST":return Object(B.a)(Object(B.a)({},e),{},{explainList:t.explainList});case"INIT_GRAPH_LIST":return Object(B.a)(Object(B.a)({},e),{},{graphList:t.graphList});case"FILTERS_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{refreshnumber:e.refreshnumber+1,filters:t.filters});case"SELECTED_NODE_ID_LIST_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{selectedNodeIdList:t.selectedNodeIdList});case"SELECTED_MESSAGE_PASSING_NODE_ID_LIST_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{selectedMessagePassingNodeIdList:t.selectedMessagePassingNodeIdList});case"SHOW_SOURCE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{showSource:t.showSource});case"SPECIFIC_NODE_ID_LIST_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{specificNodeIdList:t.specificNodeIdList});case"SELECT_INSPECT_NODE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{select_inspect_node:t.select_inspect_node});case"CLEAR_ID_INFO":return Object(B.a)(Object(B.a)({},e),{},{filters:{},selectedNodeIdList:[],selectedMessagePassingNodeIdList:[],specificNodeIdList:[],select_inspect_node:0});case"PREV_GRAPH_JSON_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{prevGraphJson:t.prevGraphJson});case"MATRIX_FILTERS_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{matrixFilters:t.matrixFilters});case"MATRIX_ROW_FILTERS_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{matrixRowFilters:t.matrixRowFilters});case"INSPECT_CATEGORY_LIST_CHANGE":return console.log("CategoryList",t.inspectCategoryList),Object(B.a)(Object(B.a)({},e),{},{InspectCategoryList:t.inspectCategoryList});case"PSJSON_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{PSJson:t.PSJson});case"PSSELECTEDNODES_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{PSSelectedNodes:t.PSSelectedNodes});case"EXTENDED_MODE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{extendedMode:t.extendedMode});case"PROJECTIONVIEWSELECTEDNODES_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{ProjectionViewSelectedNodes:t.ProjectionViewSelectedNodes});case"PROJECTIONVIEWTOTALNODENUM_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{ProjectionViewTotalNodeNum:t.ProjectionViewTotalNodeNum});case"PSSETTINGMODAL_VISIBLE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{PSSettingsModal_visible:t.PSSettingsModal_visible});case"PSDIMENSIONS_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{PSDimensions:t.PSDimensions});case"PROJECTIONVIEWSELECTEDNODES_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{ProjectionViewSettingsModal_visible:t.ProjectionViewSettingsModal_visible});case"GRAPHVIEWSETTINGMODAL_VISIBLE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{GraphViewSettingsModal_visible:t.GraphViewSettingsModal_visible});case"FEATUREMATRIXVIEWSETTINGMODAL_VISIBLE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{FeatureMatrixViewSettingsModal_visible:t.FeatureMatrixViewSettingsModal_visible});case"GRAPHVIEWSTATE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{GraphViewState:t.GraphViewState});case"KVALUE_CHANGE":return Object(B.a)(Object(B.a)({},e),{},{K_value:t.K_value});default:return e}})));o.a.render(a.a.createElement(K.a,{store:Zt},a.a.createElement(qt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[179,1,2]]]);
//# sourceMappingURL=main.6dd0a110.chunk.js.map