(this.webpackJsonpgnnlens=this.webpackJsonpgnnlens||[]).push([[0],{137:function(e,t,n){},148:function(e,t,n){},164:function(e,t,n){e.exports=n.p+"static/media/logo2.4b8ec5cf.png"},177:function(e,t,n){e.exports=n(318)},182:function(e,t,n){},183:function(e,t,n){},185:function(e,t,n){},232:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},242:function(e,t,n){"use strict";n.r(t);var r=n(243),a=n(245),i={version:"1.0.2"};function o(e,t){return!(isNaN(e)||isNaN(t)||e==1/0||t==1/0)}function s(e,t){for(var n=t?Array(e.length):{},r=0;r<e.length;r++)n[e[r]]=r;return n}function l(e){var t,n=Array(e);for(t=0;t<e;t++)n[t]={id:t};return n}i.debug=!1,i.cmp_number_asc=function(e,t){return e-t},i.cmp_number=i.cmp_number_asc,i.cmp_number_desc=function(e,t){return t-e},i.flatten=function(e,t){return e.concat(t)},i.infinities=function(e){var t=-1,n=[];if(1===arguments.length)for(;++t<e;)n[t]=1/0;else for(;++t<e;)n[t]=i.infinities.apply(this,Array.prototype.slice.call(arguments,1));return n},i.array1d=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t;return r},i.dot=r.lin.dot,i.length=r.lin.length,i.normalize=r.lin.normalize,i.zeroes=r.zeroes,i.displaymat=function(e,t,n){var r,a,i,o;for(console.log("Matrix:"),r=0;r<e.length;r++){for(i=t?e[t[r]]:e[r],o="",a=0;a<i.length;a++)o+=(n?i[n[a]]:i[a])?"*":" ";console.log(o)}},i.printvec=function(e,t,n,r){var a;for(r||(r=""),a=0;a<e.length;a++)0!==r.length&&(r+=", "),r+=n?e[n[a]].toFixed(t):e[a].toFixed(t);console.log(r)},i.printmat=function(e,t,n,r){var a,o;for(t||(t=4),a=0;a<e.length;a++)o=n?e[n[a]]:e[a],i.printvec(o,t,r,a+": ")},i.assert=function(e,t){if(!e)throw console.log(t),t||"Assertion failed"},i.printhcluster=function(e,t){return null===e.left?Array(t+1).join(" ")+"id: "+e.id:Array(t+1).join(" ")+"id: "+e.id+", dist: "+e.dist+"\n"+i.printhcluster(e.left,t+1)+"\n"+i.printhcluster(e.right,t+1)},i.mean=r.stats.mean,i.meantranspose=function(e,t){var n=e.length;if(0===n)return NaN;e[0].length;for(var r=0,a=-1;++a<n;)r+=(e[a][t]-r)/(a+1);return r},i.meancolumns=function(e){var t=e.length;if(0===t)return NaN;for(var n,r,a=e[0].length,i=e[0].slice(0),o=0;++o<t;)for(r=e[o],n=0;n<a;n++)i[n]+=(r[n]-i[n])/(o+1);return i},i.sum=function(e){for(var t=e.length,n=0;t-- >0;)isNaN(e[t])||(n+=e[t]);return n},i.distance={euclidean:function(e,t){for(var n,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(a+=(n=e[r]-t[r])*n);return Math.sqrt(a)},manhattan:function(e,t){for(var n=e.length,r=0;n-- >0;)o(e[n],t[n])&&(r+=Math.abs(e[n]-t[n]));return r},minkowski:function(e){return function(t,n){for(var r=t.length,a=0;r-- >0;)o(t[r],n[r])&&(a+=Math.pow(Math.abs(t[r]-n[r]),e));return Math.pow(a,1/e)}},chebyshev:function(e,t){for(var n,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(n=Math.abs(e[r]-t[r]))>a&&(a=n);return a},hamming:function(e,t){for(var n=e.length,r=0;n-- >0;)o(e[n],t[n])&&e[n]!==t[n]&&r++;return r},jaccard:function(e,t){for(var n=0,r=e.length,a=0;r-- >0;)o(e[r],t[r])&&(e[r]===t[r]&&a++,n++);return 0===n?0:a/n},braycurtis:function(e,t){for(var n,r,a=e.length,i=0,s=0;a-- >0;)o(n=e[a],r=t[a])&&(i+=Math.abs(n-r),s+=Math.abs(n+r));return 0===s?0:i/s}},i.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));var r=[],a=e;if(n<0)for(;a>t;a+=n)r.push(a);else for(;a<t;a+=n)r.push(a);return r},i.transpose=r.lin.transpose,i.transposeSlice=function(e,t,n){arguments.length<3&&(n=e[0].length,arguments.length<2&&(t=0));for(var r,a=e.length,i=n,o=t-1,s=new Array(n-t);++o<i;)for(s[o]=new Array(a),r=-1;++r<a;)s[o-t][r]=e[r][o];return s},i.correlation={pearson:function(e,t){var n,a,i,o=r.stats.mean(e),s=r.stats.mean(t),l=0,c=0,d=0,u=Math.min(e.length,t.length);if(0===u)return NaN;for(n=0;n<u;n++)l+=(a=e[n]-o)*(i=t[n]-s),c+=a*a,d+=i*i;return l/Math.sqrt(c*d)},pearsonMatrix:function(e){var t,n,r,a=i.correlation.pearson,o=e.length;if(0===o)return NaN;for(r=i.zeroes(o,o),t=0;t<o-1;t++)for(n=t+1;n<o;n++){var s=a(e[t],e[n]);r[t][n]=r[n][t]=s}return r}},i.bandwidth=function(e,t){t||(t=i.range(e.nodes().length));var n,r,a,o=s(t),l=e.links(),c=0;for(n=0;n<l.length;n++)r=l[n],a=Math.abs(o[r.source.index]-o[r.target.index]),c=Math.max(c,a);return c},i.edgesum=function(e,t){t||(t=i.range(e.nodes().length));var n,r,a=s(t),o=e.links(),l=0;for(n=0;n<o.length;n++)r=o[n],l+=Math.abs(a[r.source.index]-a[r.target.index]);return l},i.permutation=i.range,i.inverse_permutation=s,i.graph=function(e,t,n){var r,a,o,s,l={},c=1;return l.nodes=function(t){return arguments.length?(e=t,l):e},l.nodes_indices=function(){return e.map((function(e){return e.index}))},l.generate_nodes=function(t){e=[];for(var n=0;n<t;n++)e.push({id:n});return l},l.links=function(e){return arguments.length?(t=e,l):t},l.links_indices=function(){return t.map((function(e){return{source:e.source.index,target:e.target.index}}))},l.linkDistance=function(e){return arguments.length?(c="function"===typeof e?e:+e,l):c},l.directed=function(e){return arguments.length?(n=e,l):n},l.init=function(){var i,d,u=e.length,h=t.length;for(s=void 0,i=0;i<u;++i)(d=e[i]).index=i,d.weight=0;for(i=0;i<h;++i)(d=t[i]).index=i,"number"==typeof d.source&&(d.source=e[d.source]),"number"==typeof d.target&&(d.target=e[d.target]),"value"in d||(d.value=1),++d.source.weight,++d.target.weight;if("function"===typeof c)for(i=0;i<h;++i)t[i].distance=+c.call(this,t[i],i);else for(i=0;i<h;++i)t[i].distance=c;for(r=Array(e.length),i=0;i<e.length;++i)r[i]=[];if(n)for(a=Array(e.length),o=Array(e.length),i=0;i<e.length;++i)a[i]=[],o[i]=[];else a=o=r;for(i=0;i<t.length;++i)d=t[i],r[d.source.index].push(d),d.source.index!=d.target.index&&r[d.target.index].push(d),n&&a[d.source.index].push(d),n&&o[d.target.index].push(d);return l},l.edges=function(e){return"number"!=typeof e&&(e=e.index,i.debug&&console.log("received node %d",e)),r[e]},l.degree=function(e){return"number"!=typeof e&&(e=e.index),r[e].length},l.inEdges=function(e){return"number"!=typeof e&&(e=e.index),a[e]},l.inDegree=function(e){return"number"!=typeof e&&(e=e.index),a[e].length},l.outEdges=function(e){return"number"!=typeof e&&(e=e.index),o[e]},l.outDegree=function(e){return"number"!=typeof e&&(e=e.index),o[e].length},l.sinks=function(){var t,n=[];for(t=0;t<e.length;t++)0===l.outEdges(t).length&&n.push(t);return n},l.sources=function(){var t,n=[];for(t=0;t<e.length;t++)0===l.inEdges(t).length&&n.push(t);return n},l.distance=function(e){return t[e].distance},l.neighbors=function(e){for(var t=r[e],n=[],a=0;a<t.length;++a){var i=t[a];i.source.index==e?n.push(i.target):n.push(i.source)}return n},l.other=function(e,n){return"number"==typeof e&&(e=t[e]),e.source.index==n?e.target:e.source},l.components=function(){return s||(s=function(){var t,n,a,o,s,l,c,d=[],u=0,h=[],f=e.length;for(n=0;n<f;n++)e[n].comp=0;for(a=0;a<f;a++)if(0===e[a].comp){for(u+=1,e[a].comp=u,d.push(a),t=[a];d.length;)for(o=d.shift(),s=r[o],n=0;n<s.length;n++)(l=(c=s[n]).source).index==o&&(l=c.target),l.index!=o&&0===l.comp&&(l.comp=u,t.push(l.index),d.push(l.index));t.length&&(t.sort(i.cmp_number),h.push(t))}return h.sort((function(e,t){return t.length-e.length})),h}()),s},l},i.graph_random_erdos_renyi=function(e,t,n){if(t<=0)return i.graph_empty(e,n);if(t>=1)return i.graph_complete(e,n);var r,a,o,s,c=l(e),d=[];if(a=-1,s=Math.log(1-t),n)for(r=0;r<e;){for(o=Math.log(1-Math.random()),r==(a=a+1+Math.floor(o/s))&&(a+=1);a>=e&&r<e;)(r+=1)==(a-=e)&&(a+=1);r<e&&d.push({source:r,target:a})}else for(r=1;r<e;){for(o=Math.log(1-Math.random()),a=a+1+Math.floor(o/s);a>=r&&r<e;)a-=r,r+=1;r<e&&d.push({source:r,target:a})}return i.graph(c,d,n).init()},i.graph_random=i.graph_random_erdos_renyi,i.graph_empty_nodes=l,i.graph_empty=function(e,t){return i.graph(l(e),[],t)},i.complete_graph=function(e,t){var n,r,a=l(e),o=[];if(t)for(n=0;n<e;n++)for(r=0;r<e;r++)n!=r&&o.push({source:n,target:r});else for(n=0;n<e-1;n++)for(r=n+1;r<e;r++)o.push({source:n,target:r});return i.graph(a,o,t).init()},i.graph_connect=function(e,t){var n,r,a=e.links();for(t||(t=e.components()),n=0;n<t.length-1;n++)for(r=n+1;r<t.length;r++)a.push({source:t[n][0],target:t[r][0]});return e.links(a),e.init()},i.bfs=function(e,t,n){var r,i,o,s,l=new a,c={};for(l.push(t),c[t]=!0,n(t,void 0);l.length;){for(n(t=l.shift(),t),s=e.edges(t),r=0;r<s.length;r++)i=s[r],c[o=e.other(i,t).index]||(l.push(o),c[o]=!0,n(t,o));n(t,-1)}},i.bfs_distances=function(e,t){var n={};return n[t]=0,i.bfs(e,t,(function(e,t){t>=0&&e!=t&&(n[t]=n[e]+1)})),n},i.all_pairs_distance_bfs=function(e,t){t||(t=[e.nodes_indices()]);var n,r,a,o=t.reduce(i.flatten).sort(i.cmp_number),s=Array(o.length);for(n=0;n<o.length;n++)s[n]=Array(o.length);for(n=0;n<o.length;n++)for(r in a=i.bfs_distances(e,n))s[n][r]=a[r],s[r][n]=a[r];return s};function c(e,t,n){var r,a,o,l,c,d,u,h=!1,f=i.permutation(e.nodes().length);if(void 0===t&&(t=f.filter((function(t){return 0!==e.outDegree(t)})),n=f.filter((function(t){return 0!==e.inDegree(t)}))),t.length<n.length){var g=t;t=n,n=g,h=!0}var p=s(n),_=[];for(r=0;r<t.length;r++)(a=h?e.inEdges(t[r]).map((function(e){return p[e.target.index]})):e.outEdges(t[r]).map((function(e){return p[e.source.index]}))).sort(i.cmp_number),_=_.concat(a);for(o=1;o<n.length;)o<<=1;for(l=2*o-1,o-=1,c=i.zeroes(l),u=0,r=0;r<_.length;r++)for(c[d=_[r]+o]++;d>0;)d%2&&(u+=c[d+1]),c[d=d-1>>1]++;return u}function d(e,t,n,r){var a,i,o,s=e.inEdges(t),l=e.inEdges(n),c=0;for(i=0;i<l.length;i++)for(o=r[l[i].target.index],a=0;a<s.length;a++)r[s[a].target.index]>o&&c++;return c}function u(e,t,n,r){var a,i,o,s=e.outEdges(t),l=e.outEdges(n),c=0;for(i=0;i<l.length;i++)for(o=r[l[i].source.index],a=0;a<s.length;a++)r[s[a].source.index]>o&&c++;return c}function h(e){if(0===e.length)return-1;if(1===e.length)return e[0];if(2===e.length)return(e[0]+e[1])/2;if(e.sort(i.cmp_number),e.length%2)return e[(e.length-1)/2];var t=e.length/2,n=t-1,r=e[e.length-1]-e[t],a=e[n]-e[0];return a==r?(e[n]+e[t])/2:(e[n]*r+e[t]*a)/(a+r)}function f(e,t){var n,r,a,o,l=i.infinities(t.length,t.length);for(o=s(t),n=0;n<t.length;n++)l[n][n]=0;var c=function(t){if(t.source!=t.target&&t.source.index in o&&t.target.index in o){var n=o[t.source.index],r=o[t.target.index];l[r][n]=l[n][r]=e.distance(t.index)}};for(n=0;n<t.length;n++)e.edges(t[n]).forEach(c);for(a=0;a<t.length;a++)for(n=0;n<t.length;n++)if(l[n][a]!=1/0)for(r=0;r<t.length;r++)l[a][r]!=1/0&&l[n][r]>l[n][a]+l[a][r]&&(l[n][r]=l[n][a]+l[a][r],l[r][n]=l[n][r]);return l}function g(e){var t,n,r=e.length,a=i.zeroes(r,r),o=i.distmax(e);for(t=0;t<r;t++)for(n=t;n<r;n++)a[n][t]=a[t][n]=1+o-e[t][n];return a}function p(e,t,n,r){for(var a=[],i=e+n,o=t.length,s=-1;++s<o;)a[s]=(e*t[s]+n*r[s])/i;return a}function _(e){var t=i.length(e),n=e.length;if(0===t||Math.abs(t-1)<1e-9)return 1;for(;n-- >0;)e[n]/=t;return t}function v(e){var t,n,r,a,o=e.length,s=e[0].length;if(r=function(e){var t,n,r,a=e.length,o=e[0].length,s=i.zeroes(o);for(t=0;t<a;t++)for(r=e[t],n=0;n<o;n++)s[n]+=r[n];return s}(e),n=function(e){var t,n,r,a,i=e.length,o=e[0].length,s=Array(i);for(t=0;t<i;t++){for(r=e[t],a=0,n=0;n<o;n++)a+=r[n];s[t]=a}return s}(e),(a=function(e,t,n,r,a,o,s){var l,c,d,u,h,f,g,p,_,v,y,S,C,k,L,M,N,E,O,P,I,j,D,T,A=i.zeroes(r),G=i.zeroes(r),V=i.zeroes(r),H=i.zeroes(r);for(d=0,c=0;c<r;c++)d+=s[c],t[c]=c+1;t[0]=1.1,T=5e-6,m(t,t,e,o,n,r,a),u=0;for(;;){for(h=0,c=0;c<r;c++)h+=t[c]*s[c];for(h/=d,g=0,c=0;c<r;c++)f=t[c]-h,g+=f*f*s[c],t[c]=f;for(g=Math.sqrt(g),c=0;c<r;c++)t[c]/=g;for(m(t,A,e,o,n,r,a),h=0,p=0,_=0,v=0,y=0,S=0,C=0,k=0,c=0;c<r;c++)f=A[c],A[c]=f/s[c],h+=f,p+=f*t[c];for(h/=d,c=0;c<r;c++)f=A[c]-(h+p*t[c]),_+=f*f*s[c],A[c]=f;for(_=Math.sqrt(_),c=0;c<r;c++)A[c]/=_;if(_<T||u>999)break;for(u++,m(A,G,e,o,n,r,a),h=0,P=0,c=0;c<r;c++)f=G[c],G[c]=f/s[c],h+=f,v+=f*A[c],P+=f*t[c];for(h/=d,c=0;c<r;c++)f=G[c]-(h+v*A[c]+P*t[c]),y+=f*f*s[c],G[c]=f;if((y=Math.sqrt(y))>T){for(c=0;c<r;c++)G[c]/=y;for(m(G,V,e,o,n,r,a),h=0,I=0,j=0,c=0;c<r;c++)f=V[c],V[c]/=s[c],h+=f,S+=f*G[c],I+=f*t[c],j+=f*A[c];for(h/=d,c=0;c<r;c++)f=V[c]-(h+S*G[c]+I*t[c]+j*A[c]),C+=f*f*s[c],V[c]=f;if((C=Math.sqrt(C))>T){for(c=0;c<r;c++)V[c]/=C;for(m(V,H,e,o,n,r,a),c=0;c<r;c++)k+=V[c]*H[c]}else C=0}else y=0;if(L=w(T,p,_,v,y,S,C,k),M=L[0],N=L[1],E=L[2],O=L[3],_<T)break;for(c=0;c<r;c++)t[c]=M*t[c]+N*A[c]+E*G[c]+O*V[c]}_>T&&i.debug>0&&console.log("residual bigger than tolerance on axis 1");var F=t[0],R=t[0];for(c=1;c<r;c++)(h=t[c])<R?R=h:h>F&&(F=h);if(-R>F)for(c=0;c<r;c++)t[c]=-t[c];for(x(t,e,n,r,a),l=0;l<n;l++)e[l]/=o[l];var z=0;for(l=0;l<n;l++)z+=o[l]*b(e[l]);for(z=Math.sqrt(z),l=0;l<n;l++)e[l]/=z;for(c=0;c<r;c++)t[c]/=z;var W,K=0;for(l=0;l<n;l++)for(W=e[l],D=a[l],c=0;c<r;c++)K+=D[c]*b(W-t[c]);var U=Math.sqrt(K/d);if(p>=.999){var J=-R/z;J>(U=F/z)&&(U=J)}for(c=0;c<r;c++)t[c]/=U;return{rows:e,cols:t,eig:p}}(i.array1d(o,1),i.array1d(s,1),o,s,e,n,r)).eig<1e-7)a.rows=a.cols=[],a.eig=0;else{t=a.rows,x(a.cols,t,o,s,e);for(var l=0;l<o;l++)t[l]/=n[l]}return a}function m(e,t,n,r,a,i,o,s){var l;for(s&&console.log("TRANS "+s),x(e,n,a,i,o,s),l=0;l<a;l++)n[l]=n[l]/r[l];!function(e,t,n,r,a,i){var o,s,l,c;i&&(console.log("xymult"),y(t));for(s=0;s<r;s++)t[s]=0;for(o=0;o<n;o++)for(l=e[o],c=a[o],s=0;s<r;s++)t[s]+=l*c[s];i&&y(t)}(n,t,a,i,o,s)}function y(e){console.log("");for(var t=0;t<e.length;t++)console.log("i:"+(t+1)+" v:  "+e[t].toFixed(5))}function x(e,t,n,r,a,i){var o,s,l,c;for(i&&(console.log("yxmult"),y(t)),o=0;o<n;o++){for(l=0,c=a[o],s=0;s<r;s++)l+=e[s]*c[s];t[o]=l}i&&y(t)}function b(e){return e*e}function w(e,t,n,r,a,i,o,s){var l,c,d,u,h,f,g,p,_=1,v=.1,m=.01,y=.001;for(l=0;l<100&&(_=t*(c=t*_+n*v)+n*(d=n*_+r*v+a*m),v=n*c+r*d+a*(u=a*v+i*m+o*y),m=a*d+i*u+o*(h=o*m+s*y),y=o*u+s*h,_/=f=Math.sqrt(b(_)+b(v)+b(m)+b(y)),v/=f,m/=f,y/=f,(l+1)%5===0&&(g=Math.sqrt(f),p=Math.sqrt(b(_-c/g)+b(v-d/g)+b(m-u/g)+b(y-h/g))),!(p<.05*e));l++);return[_,v,m,y]}function S(e){return e.map((function(e){return e.map(Math.abs)}))}function C(e,t,n){var r,a=1,o=[1],s=0;for(r=1;r<e.length;r++)n[e[r-1]][e[r]]<0&&(a=-a),a<0?(o.push(-1),s++):o.push(1);if(i.debug&&console.log(o),-1==(a=s>e.length-s?-1:1))for(r=0;r<e.length-1;r++)o[r]=o[r]*a;return o}i.mat2graph=function(e,t){var n,r,a,o=e.length,s=[],l=[],c=Number.NEGATIVE_INFINITY;for(n=0;n<o;n++)s.push({id:n});for(n=0;n<o;n++)for(a=e[n],r=t?0:n;r<a.length;r++)r==s.length&&s.push({id:r}),0!==a[r]&&(a[r]>c&&(c=a[r]),l.push({source:n,target:r,value:a[r]}));return i.graph(s,l,t).linkDistance((function(e,t){return 1+c-e.value})).init()},i.graph2mat=function(e,t){var n,r,a,o=e.nodes(),s=e.links(),l=o.length;if(t||(t=e.directed()),t){var c=l,d=l;for(n=l-1;n>=0&&0===e.inEdges(n).length;n--)c--;for(n=l-1;n>=0&&0===e.outEdges(n).length;n--)d--;for(a=i.zeroes(c,d),n=0;n<s.length;n++)a[(r=s[n]).source.index][r.target.index]=r.value?r.value:1}else for(a=i.zeroes(l,l),n=0;n<s.length;n++)a[(r=s[n]).source.index][r.target.index]=r.value?r.value:1,a[r.target.index][r.source.index]=r.value?r.value:1;return a},i.count_crossings=c,i.adjacent_exchange=function(e,t,n){t=t.slice(),n=n.slice();for(var r,a,i,o,l,c=s(t),h=s(n),f=!0,g=0;f;){for(f=!1,r=0;r<t.length-1;r++)(o=u(e,a=t[r],i=t[r+1],h))>(l=u(e,i,a,h))&&(t[r]=i,t[r+1]=a,c[i]=r,c[a]=r+1,f=!0,g+=o-l);for(r=0;r<n.length-1;r++)(o=d(e,a=n[r],i=n[r+1],c))>(l=d(e,i,a,c))&&(n[r]=i,n[r+1]=a,h[i]=r,h[a]=r+1,f=!0,g+=o-l)}return[t,n,g]},i.barycenter_order=function(e,t,n){var r=[[],[],0];t||(t=e.components());for(var a=0;a<t.length;a++){var o=i.barycenter(e,t[a],n);r=[r[0].concat(o[0]),r[1].concat(o[1]),r[2]+o[2]]}return r},i.barycenter=function(e,t,n){var r,a,o,l,d,u,f,g,p,_,v,m,y,x=e.nodes(),b={};if(r=t.filter((function(t){return 0!==e.outDegree(t)})),a=t.filter((function(t){return 0!==e.inDegree(t)})),t.length<3)return[r,a,c(e,r,a)];n?n%2==1&&n++:n=24,b=s(a),f=c(e,r,a),d=r.slice(),u=a.slice(),g=0;var w=function(e){var t=e.source==v?e.target:e.source;return b[t.index]},S=function(t,n){var r=y[t]-y[n];return 0===r&&(r=e.edges(n).length%2-e.edges(t).length%2),r<0?-1:r>0?1:0};for(p=r,l=0;l<n;l++,p=p==r?a:r){for(y={},_=0;_<p.length;_++)v=x[p[_]],m=(m=p==r?e.outEdges(v.index):e.inEdges(v.index)).map(w),y[v.index]=+h(m);for(p.sort(S),_=0;_<p.length;_++)b=s(p);(o=c(e,r,a))<f&&(f=o,d=r.slice(),u=a.slice(),g=l,n=Math.max(n,l+2))}return i.debug&&console.log("Best iter: "+g),[d,u,f]},i.all_pairs_distance=function(e,t){var n=[];t||(t=e.components());for(var r=0;r<t.length;r++)n.push(f(e,t[r]));return n},i.all_pairs_distance_floyd_warshall=f,i.floyd_warshall_with_path=function(e,t){t||(t=e.components()[0]);var n,r,a,o,l=i.infinities(t.length,t.length),c=Array(t.length),d=e.directed();for(o=s(t),n=0;n<t.length;n++)l[n][n]=0,c[n]=Array(t.length);var u=function(t){if(t.source!=t.target){var n=o[t.source.index],r=o[t.target.index];l[n][r]=e.distance(t),c[n][r]=r,d||(l[r][n]=e.distance(t),c[r][n]=n)}};for(n=0;n<t.length;n++)e.edges(t[n]).forEach(u);for(a=0;a<t.length;a++)for(n=0;n<t.length;n++)for(r=0;r<t.length;r++)l[n][r]>l[n][a]+l[a][r]&&(l[n][r]=l[n][a]+l[a][r],c[n][r]=c[n][a],d||(l[r][n]=l[n][r],c[r][n]=c[a][r]));return[l,c]},i.floyd_warshall_path=function(e,t,n){if(void 0===e[t][n])return[];for(var r=[t];t!=n;)t=e[t][n],r.push(t);return r},i.distmat2valuemat=g,i.graph2valuemats=function(e,t){return t||(t=e.components()),i.all_pairs_distance(e,t).map(g)},i.valuemats_reorder=function(e,t,n){var r=e.map(t);return n&&(r=r.map((function(e,t){return i.permute(n[t],e)}))),r.reduce(i.flatten)},i.dist=function(){var e=i.distance.euclidean;function t(t){for(var n=t.length,r=[],a=0;a<n;a++){var i=[];r[a]=i;for(var o=0;o<n;o++)o<a?i.push(r[o][a]):a===o?i.push(0):i.push(e(t[a],t[o]))}return r}return t.distance=function(n){return arguments.length?(e=n,t):e},t},i.distmax=function(e){var t,n,r,a=0,i=e.length;for(t=0;t<i;t++)for(r=e[t],n=t+1;n<i;n++)r[n]>a&&(a=r[n]);return a},i.distmin=function(e){var t,n,r,a=1/0,i=e.length;for(t=0;t<i;t++)for(r=e[t],n=t+1;n<i;n++)r[n]<a&&(a=r[n]);return a},i.dist_remove=function(e,t,n){var r;for(arguments.length<3&&(n=t+1),e.splice(t,n-t),r=e.length;r-- >0;)e[r].splice(t,n-t);return e},i.randomPermute=function(e,t,n){arguments.length<3&&(n=e.length,arguments.length<2&&(t=0));for(var r,a,i=n-t;i>0;)a=t+Math.floor(Math.random()*i--),r=e[t+i],e[t+i]=e[a],e[a]=r;return e},i.randomPermutation=function(e){return i.randomPermute(i.permutation(e))},i.random_array=function(e,t,n){var r=Array(e);if(1==arguments.length)for(;e;)r[--e]=Math.random();else if(2==arguments.length)for(;e;)r[--e]=Math.random()*t;else for(;e;)r[--e]=t+Math.random()*(n-t);return r},i.random_matrix=function(e,t,n,r){n||(n=t),t!=n?r=!1:r||(r=!0);var a,o,s,l=i.zeroes(t,n);if(r)for(a=0;a<t;a++){for(s=0,o=0;o<a+1;o++)Math.random()<e&&(l[a][o]=l[o][a]=1,s++);0===s&&(o=Math.floor(Math.random()*t/2),l[a][o]=l[o][a]=1)}else for(a=0;a<t;a++){for(s=0,o=0;o<n;o++)Math.random()<e&&(l[a][o]=1,s++);0===s&&(l[a][Math.floor(Math.random()*n)]=1)}return l},i.permute=function(e,t){for(var n=t.length,r=e.slice();n--;)r[n]=e[t[n]];return r},i.permute_inplace=function(e,t){var n,r,a,i;for(n=0;n<e.length;n++)if((r=t[n])<0)t[n]=-1-r;else for(a=n;r!=n;)i=e[r],e[r]=e[a],e[a]=i,a=r,i=t[r],t[r]=-1-i,r=i;return e},i.permutetranspose=function(e,t){for(var n=e.length;n-- >0;)e[n]=i.permute(e[n],t);return e},i.stablepermute=function(e,t){var n=i.permute(e,t);return n[0]>n[n.length-1]&&n.reverse(),n},i.sort_order=function(e){return i.permutation(0,e.length).sort((function(t,n){return e[t]-e[n]}))},i.sort_order_ascending=i.sort_order,i.sort_order_descending=function(e){return i.permutation(0,e.length).sort((function(t,n){return e[n]-e[t]}))},"undefined"==typeof r&&((r={version:"1.9.1"}).stats={}),r.stats.hcluster=function(){var e=i.distance.euclidean,t="single",n=null;function r(r){var a,i,o,s,l,c,d,u,h=r.length,f=[],g=[],_=[],v=0;if(null===n)for(n=[],d=-1;++d<h;)for(f[d]=0,n[d]=[],u=-1;++u<h;)n[d][u]=d===u?1/0:e(r[d],r[u]),n[d][f[d]]>n[d][u]&&(f[d]=u);else{if(n.length<h||n[0].length<h)throw{error:"Provided distance matrix length "+n.length+" instead of "+h};for(d=-1;++d<h;)for(f[d]=0,u=-1;++u<h;)d===u&&(n[d][u]=1/0),n[d][f[d]]>n[d][u]&&(f[d]=u)}for(d=-1;++d<h;)d!=v&&console.log("i = %d, id = %d",d,v),_[d]=[],_[d][0]={left:null,right:null,dist:0,centroid:r[d],id:v++,size:1,depth:0},g[d]=1;for(l=0;l<h-1;l++){for(a=0,d=0;d<h;d++)n[d][f[d]]<n[a][f[a]]&&(a=d);i=f[a];var m={left:o=_[a][0],right:s=_[i][0],dist:n[a][i],centroid:p(o.size,o.centroid,s.size,s.centroid),id:v++,size:o.size+s.size,depth:1+Math.max(o.depth,s.depth)};for(_[a].splice(0,0,m),g[a]+=g[i],u=0;u<h;u++)switch(t){case"single":n[a][u]>n[i][u]&&(n[u][a]=n[a][u]=n[i][u]);break;case"complete":n[a][u]<n[i][u]&&(n[u][a]=n[a][u]=n[i][u]);break;case"average":n[u][a]=n[a][u]=(g[a]*n[a][u]+g[i]*n[i][u])/(g[a]+g[u])}for(n[a][a]=1/0,d=0;d<h;d++)n[d][i]=n[i][d]=1/0;for(u=0;u<h;u++)f[u]==i&&(f[u]=a),n[a][u]<n[a][f[a]]&&(f[a]=u);c=m}return c}return r.linkage=function(e){return arguments.length?(t=e,r):t},r.distance=function(t){return arguments.length?(e=t,r):e},r.distanceMatrix=function(e){return arguments.length?(n=e.map((function(e){return e.slice(0)})),r):n},r},i.optimal_leaf_order=function(){var e=null,t=i.distance.euclidean,n="complete",a={},o={};function s(e){return null===e?[]:e.id in a?a[e.id]:a[e.id]=function(e){return null===e?[]:0===e.depth?[e.id]:s(e.left).concat(s(e.right))}(e)}function l(t,n,r){var a="k"+t.id+"-"+n+"-"+r;return a in o?o[a]:o[a]=function(t,n,r){if(0===t.depth)return[0,[t.id]];var a,i,o=t.left,c=t.right,d=s(o),u=s(c);if(-1!==d.indexOf(n)&&-1!==u.indexOf(r))a=o,i=c;else{if(-1===u.indexOf(n)||-1===d.indexOf(r))throw{error:"Node is not common ancestor of "+n+", "+r};a=c,i=o}var h=s(a.left),f=s(a.right),g=-1!=f.indexOf(n)?h:f;0===g.length&&(g=[n]);var p=s(i.left),_=s(i.right),v=-1!=_.indexOf(r)?p:_;0===v.length&&(v=[r]);for(var m=1/0,y=[],x=0;x<g.length;x++)for(var b=l(a,n,g[x]),w=0;w<v.length;w++){var S=l(i,v[w],r),C=b[0]+e[g[x]][v[w]]+S[0];C<m&&(m=C,y=b[1].concat(S[1]))}return[m,y]}(t,n,r)}function c(t){a={},o={};var n=1/0,r=[],c=s(t.left),d=s(t.right);i.debug&&console.log(i.printhcluster(t,0));for(var u=0;u<c.length;u++)for(var h=0;h<d.length;h++){var f=l(t,c[u],d[h]);f[0]<n&&(n=f[0],r=f[1])}return e=null,r}function d(a){null===e&&(e=i.dist().distance(t)(a));var o=r.stats.hcluster().linkage(n).distanceMatrix(e)(a);return console.log("hcluster",r.stats.hcluster()),console.log("distancematrix, hcluster_result",e,o),c(o)}return d.order=c,d.reorder=d,d.distance=function(n){return arguments.length?(t=n,e=null,d):t},d.linkage=function(e){return arguments.length?(n=e,d):n},d.distance_matrix=function(t){return arguments.length?(e=t.map((function(e){return e.slice(0)})),d):e},d.distanceMatrix=d.distance_matrix,d},i.order=function(){var e,t=i.distance.euclidean,n=i.optimal_leaf_order,r="complete",a=null,o=[],s=0,l=1/0;function c(c){e=c,l=Math.min(l,c.length);var u,h,f,g=s>0?s-1:0,_=l<e.length?l+1:l;for(u=o.length-1;u>0;u-=2)h=o[u-1],(f=o[u])>=_?_>l?(_=Math.min(_,h+1),o.splice(u-1,2)):f=_:h<=g?g<s?(g=Math.max(g,f-1),o.splice(u-1,2)):h=g:f-h<3&&o.splice(u-1,2);try{return function(t,n){var r,c,u,h,f=e;if(e=e.slice(t,n),0===s&&l==e.length)return d();i.debug&&console.log("i0="+t+" j0="+n);null!==a?(n!==e.length&&i.dist_remove(a,n,e.length),t>0&&i.dist_remove(a,0,t)):p();var g=i.distmax(a);if(t<s){for(c=a[0],u=c.length;u-- >1;)c[u]+=g;for(u=a.length;u-- >1;)a[u][0]+=g;if(g+=g,0!==t)for(u=0;u<o.length;u++)o[u]-=t}if(n>l)for(h=a.length-1,c=a[h],u=h;u-- >0;)c[u]+=g,a[u][h]+=g;r=d(),t<s?(0!==r[0]&&r.reverse(),n>l?i.assert(0===r[0]&&r[r.length-1]==r.length-1,"Invalid constrained permutation endpoints"):i.assert(0===r[0],"Invalid constrained permutation start")):n>l&&(r[r.length-1]!==r.length-1&&(r=r.reverse()),i.assert(r[r.length-1]==r.length-1,"Invalid constrained permutation end"));0!==t&&(r=i.permutation(t).concat(r.map((function(e){return e+t}))));f.length>n&&(r=r.concat(i.range(n,f.length)));return r}(g,_)}finally{t=i.distance.euclidean,n=i.optimal_leaf_order,r="complete",a=null,e=null,o=[],s=0,l=1/0}}function d(){var t,n,r,s,l,c;if(0===o.length)return u();for(p(),n=o.length-1;n>0;n-=2)s=o[n-1],l=o[n],a=i.dist_remove(a,s+1,l-1),e.splice(s+1,l-s-2),i.debug&&console.log("Except["+s+", "+l+"]"),0!==a[s][s+1]&&(a[s][s+1]=a[s+1][s]=-1);for(t=u(),n=0;n<o.length;n+=2){for(s=o[n],l=o[n+1],r=0;r<t.length;r++)t[r]>s?t[r]+=l-s-2:t[r]==s&&(c=r);if(c>0&&t[c-1]==l-1)Array.prototype.splice.apply(t,[c,0].concat(i.range(l-2,s,-1)));else{if(t[c+1]!=l-1)throw"Range not respected";Array.prototype.splice.apply(t,[c+1,0].concat(i.range(s+1,l-1)))}}return t}function u(){var t,o,s,l,c,d,u,f,_=!1,v=[],m={};for(p(),c=0;c<a.length-1;c++){for(s=[],-1!==(l=(o=a[c]).indexOf(-1))&&(m[c]=[c,l],_=!0),d=o.length;--d>c;)0===o[d]?(-1!==(l=a[d].indexOf(-1))&&(m[c]=[d,l],a[l][c]=o[l]=-1,_=!0),s.unshift(d),a=i.dist_remove(a,d),e.splice(d,1)):o[d]<0&&(_=!0);0!==s.length&&(s.unshift(c),v.push(s))}if(_)for(c=0;c<a.length-1;c++)for(o=a[c],d=c+1;d<o.length-1;d++)-1==a[d][d+1]&&(a[d+1][d]=a[d][d+1]=0);for(t=function(){i.debug>1&&i.printmat(a);i.debug>2&&i.printmat(e);var t=n().linkage(r).distanceMatrix(a)(e);i.debug&&console.log("Permutation: "+t);return t}(),c=v.length;c-- >0;)for(s=v[c],d=t.indexOf(s[0]),(u=m[s[0]])&&u[0]==s[0]&&(d=h(t,d,u[0],u[1],0),u=void 0),f=1;f<s.length;f++)t=g(t,d,s[f]),u&&u[0]==s[f]&&(d=h(t,d,u[0],u[1],f),u=void 0);return t}function h(e,t,n,r,a){if(t>0&&e[t-1]==r)return f(e,t,e.indexOf(n)),t+1;if(e[t+a+1]==r)return f(e,t+a,e.indexOf(n)),t;throw"Index not found"}function f(e,t,n){if(t!=n){var r=e[t];e[t]=e[n],e[n]=r}}function g(e,t,n){return(e=e.map((function(e){return e<n?e:e+1}))).splice(t,0,n),e}function p(){return null===a&&(a=i.dist().distance(t)(e)),a}return c.distance=function(e){return arguments.length?(t=e,c):t},c.linkage=function(e){return arguments.length?(r=e,c):r},c.limits=function(e,t){return arguments.length?(s=e,l=t,c):[s,l]},c.except=function(e){return arguments.length?(o=e.sort((function(e,t){if(e>=t)throw"Invalid list, indices not sorted";return e-t})),c):o.slice(0)},c.orderrowsexcept=c.orderexcept,c},i.covariance=i.dot,i.covariancetranspose=function(e,t,n){var r,a=e.length,i=0;for(r=0;r<a;r++)i+=e[r][t]*e[r][n];return i},i.variancecovariance=function(e){var t,n,r=e[0].length,a=Array(r);for(t=0;t<r;t++)a[t]=Array(r);for(t=0;t<r;t++)for(n=t;n<r;n++)a[t][n]=a[n][t]=i.covariancetranspose(e,t,n);return a},i.laplacian=function(e,t){var n,r,a,o,l,c,d,u,h=t.length,f=i.zeroes(h,h),g=s(t);for(i.assert(!e.directed(),"Laplacian only for undirected graphs"),n=0;n<h;n++){for(c=t[n],a=f[n],o=0,l=e.edges(c),r=0;r<l.length;r++)d=l[r],(u=g[e.other(d,c).index])!=n&&(o+=d.value,a[u]=-d.value);a[n]=o}return f},i.poweriteration=function(e,t,n){t||(t=1e-9);var r,a,o,s=e.length,l=Array(s),c=100;for(i.assert(s==e[0].length,"poweriteration needs a square matrix"),_(r=n?n.slice():i.random_array(s));c-- >0;){for(a=0;a<s;a++)for(l[a]=0,o=0;o<s;o++)l[a]+=e[a][o]*r[o];if(_(l),i.dot(l,r)>1-t)break;var d=l;l=r,r=d}return l},i.poweriteration_n=function(e,t,n,r,a){r||(r=1e-9);var o,s,l,c,d,u,h,f=e.length,g=Array(t),p=Array(f),v=100,m=Array(t);if(i.assert(f==e[0].length,"poweriteration needs a square matrix"),n)for(o=0;o<t;o++)g[o]=n[o].slice(),m[o]=_(g[o]);else for(o=0;o<t;o++)h=g[o]=i.random_array(f),m[o]=_(h);for(a||(a=0),l=a;l<t;l++){for(d=g[l];v-- >0;){for(c=0;c<l;c++)for(h=g[c],u=i.dot(d,h),o=0;o<f;o++)d[o]-=u*h[o];for(o=0;o<f;o++)for(p[o]=0,s=0;s<f;s++)p[o]+=e[o][s]*d[s];if(m[l]=_(p),i.dot(p,d)>1-r)break;d=p,p=g[l],g[l]=d}i.debug&&console.log("eig[%d]=%j",l,d)}return[g,m]},i.fiedler_vector=function(e,t){var n,r,a,o=function(e){var t,n,r,a,o=0,s=e.length;for(t=0;t<s;t++){for(r=(a=e[t])[t],n=0;n<s;n++)n!=t&&(r+=Math.abs(a[n]));r>o&&(o=r)}return i.debug&&console.log("gershgorin_bound=%d",o),o}(e),s=e.length,l=e.map((function(e){return e.slice()}));for(n=0;n<s;n++)for(a=l[n],r=0;r<s;r++)a[r]=n==r?o-a[r]:-a[r];var c=[i.array1d(s,1),i.random_array(s)];return i.poweriteration_n(l,2,c,t,1)[0][1]},i.spectral_order=function(e,t){var n,r,a,o,s=[];for(t||(t=e.components()),n=0;n<t.length;n++)a=t[n],r=i.fiedler_vector(i.laplacian(e,a)),o=i.sort_order(r),s=s.concat(i.permute(a,o));return s},i.pca1d=function(e,t){e.length;if(0===e.length)return null;e=function(e){var t=e.length;if(0===t)return null;var n,r,a,o=i.meancolumns(e),s=o.length,l=Array(t);for(n=0;n<t;n++){for(a=e[n].slice(0),r=0;r<s;r++)a[r]-=o[r];l[n]=a}return l}(e);var n=i.variancecovariance(e);return i.poweriteration(n,t)},i.pca_order=function(e,t){return i.sort_order(i.pca1d(e,t))},i.ca_decorana=v,i.ca=v,i.ca_order=function(e){var t=i.ca(e);return{rows:i.sort_order(t.rows),cols:i.sort_order(t.cols),details:t}},i.cuthill_mckee=function(e,t){if(t.length<3)return t;e.nodes();var n,r,i=t[0],o=e.degree(i),l={},c=new a,d=s(t),u=[];for(n=0;n<t.length&&(r=t[n],!(e.degree(r)<o&&(o=e.degree(r),i=r,1==o)));n++);for(c.push(i);0!==c.length;)r=c.shift(),l[r]||(l[r]=!0,u.push(r),e.edges(r).map((function(t){return e.other(t,r).index})).filter((function(e){return!l[e]&&e in d})).sort((function(t,n){return e.degree(t)-e.degree(n)})).forEach(c.push,c));return u},i.reverse_cuthill_mckee=function(e,t){return i.cuthill_mckee(e,t).reverse()},i.cuthill_mckee_order=function(e,t){var n,r,a=[];for(t||(t=e.components()),n=0;n<t.length;n++)r=t[n],a=a.concat(i.cuthill_mckee(e,r));return a},i.reverse_cuthill_mckee_order=function(e,t){var n,r,a=[];for(t||(t=e.components()),n=0;n<t.length;n++)r=t[n],a=a.concat(i.reverse_cuthill_mckee(e,r));return a},i.condition=function(e){var t,n,r,a,i,o,s,l=[];for(t=0;0<e.length;t++){for((s=e[t].slice()).push(l),n=0;n<l.length;n++)if(null!==(i=s[n])){r=a=s[n];break}for(;n<l.length;n++)(i=s[n])<r?r=i:i>a&&(a=i);for(o=a!=r?1/(a-r):0,n=1;n<l.length;n++)null!==(i=s[n])&&i>=i?s[n]=s[n]*o-r:i=NaN}return l},i.array_to_dicts=function(e,t){arguments.length<2&&(t=i.range(e[0].length));var n,r,a,o,s=[];for(a=0;a<e.length;a++){for(n=e[a],r={},o=0;o<n.length;o++)r[t[o]]=n[o];s.push(r)}return s},i.dicts_to_array=function(e,t){arguments.length<2&&(t=Object.keys(e[0]));var n,r,a,i=t.length,o=e.length,s=Array(o);for(n=0;n<o;n++)for(a=Array(i),s[n]=a,r=0;r<i;r++)a[r]=e[n][t[r]];return s},i.pcp=function(e,t){t||(t=i.range(e[0].length));var n=i.transpose(e),a=i.correlation.pearsonMatrix(n),o=S(a),s=(r.stats.hcluster().linkage("complete").distanceMatrix(o)(n),i.optimal_leaf_order().distanceMatrix(o)(n)),l=i.permute(t,s);n=i.permute(n,s);var c=C(s,0,a);return[i.transpose(n),s,l,c,a]},i.parcoords=function(e){e.detectDimensions().autoscale();var t,n,a,o,s=e.data(),l=e.types(),c=e.dimensions(),d=[],u=[];for(n=0;n<c.length;n++)if("number"==l[o=c[n]]){for(t=[],a=0;a<s.length;a++)t.push(s[a][o]);d.push(t)}else if("date"==l[o]){for(t=[],a=0;a<s.length;a++)t.push(.001*s[a][o].getTime());d.push(t)}else c.splice(n,1),u.push(o),n--;var h=i.correlation.pearsonMatrix(d),f=S(h),g=(r.stats.hcluster().linkage("complete").distanceMatrix(f)(d),i.optimal_leaf_order().distanceMatrix(f)(d));i.permute(c,g),d=i.permute(d,g);var p=C(g,0,h);for(n=0;n<p.length;n++)p[n]<0&&e.flip(c[n]);return c=u.reverse().concat(c),e.dimensions(c)},t.default=i},246:function(e,t,n){},282:function(e,t,n){},283:function(e,t,n){var r=n(29);!function(){function e(e){return e.length?r.keys(e[0]).sort():[]}function t(){r.event.stopPropagation(),r.event.preventDefault()}function n(e){return e.name}function a(e){return e[0].categories.reduce((function(e,t){return e+t.count}),0)}r.parsets=function(){var i,o,f,g,p=r.dispatch("sortDimensions","sortCategories","ribbonClick","categoryClick"),_=e,v=String,m=u,y=h,x=20,b=1,w=500;function S(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function C(e){return"function"===typeof e?e:function(){return e}}function k(e){e.each((function(e,s){var u,h,v,S,C=r.select(this),k=r.scaleOrdinal(),L=!1,D=_.call(this,e,s),A=[],G={children:{},count:0};if(r.select(window).on("mousemove.parsets."+ ++l,q),null==g&&(g=b),C.selectAll(".ribbon, .ribbon-mouse").data(["ribbon","ribbon-mouse"],String).enter().append("g").attr("class",String),function(){var s=C.selectAll("g.dimension"),l={};s.each((function(e){l[e.name]=e})),D.forEach((function(e){l.hasOwnProperty(e)||(l[e]={name:e,categories:[]}),A.push(l[e])})),A.sort(T),C.select(".ribbon").selectAll("path").each((function(e){for(var t=e.path.split("\0"),n=G,r=t.length-1,a=0;a<r;a++){var i=t[a];n=n.children.hasOwnProperty(i)?n.children[i]:n.children[i]={children:{},count:0}}n.children[e.name]=e})),G=c(G,e,A.map(n),i),l=A.map((function(e){var t={};return e.categories.forEach((function(e){t[e.name]=e})),t})),function e(t,n){if(t.children){var r=A[n],a=l[n];for(var i in t.children)a.hasOwnProperty(i)||r.categories.push(a[i]={name:i}),e(t.children[i],n+1)}}(G,0),A.forEach((function(e,t){A[t].categories=e.categories.sort((function(e,t){return e.name<t.name?-1:1}))})),k.domain([]).range(r.range(A[0].categories.length)),u=P(G,A,k),h=a(A),A.forEach((function(e){e.count=h}));var g=(s=s.data(A,n)).enter().append("g").attr("class","dimension").attr("transform",(function(e){return"translate(0,"+e.y+")"})).on("mousedown.parsets",t);s.merge(g).each((function(e){e.y0=e.y,e.categories.forEach((function(e){e.x0=e.x}))})),g.append("rect").attr("width",o).attr("y",-45).attr("height",45);var _=g.append("text").attr("class","dimension").attr("transform","translate(0,-25)");_.append("tspan").attr("class","name").text(N),_.append("tspan").attr("class","sort alpha").attr("dx","2em").text("alpha \xbb").on("mousedown.parsets",t),_.append("tspan").attr("class","sort size").attr("dx","2em").text("size \xbb").on("mousedown.parsets",t),s.merge(g).call(r.drag().on("start",(function(e){L=!0,e.y0=e.y})).on("drag",(function(t){t.y0=t.y=r.event.y;for(var o=1;o<A.length;o++)if(f*A[o].y<f*A[o-1].y){A.sort(T),D=A.map(n),k.domain([]).range(r.range(A[0].categories.length)),u=P(G=c({children:{},count:0},e,D,i),A,k),h=a(A),C.selectAll(".ribbon, .ribbon-mouse").selectAll("path").remove(),B(s.merge(g)),R(),s.merge(g).transition().duration(w).attr("transform",d).tween("ribbon",W),p.call("sortDimensions");break}r.select(this).attr("transform","translate(0,"+t.y+")").transition(),v.merge(S).filter((function(e){return e.source.dimension===t||e.target.dimension===t})).attr("d",I)})).on("end",(function(e){L=!1,q();var t=(f-45-2)/(A.length-1);A.forEach((function(e,n){e.y=45+n*t})),O(r.select(this)).attr("transform","translate(0,"+e.y+")").tween("ribbon",W)}))),s.merge(g).select("text").select("tspan.sort.alpha").on("click.parsets",F("alpha",(function(e,t){return e.name<t.name?1:-1}),s)),s.merge(g).select("text").select("tspan.sort.size").on("click.parsets",F("size",(function(e,t){return e.count-t.count}),s)),s.merge(g).transition().duration(w).attr("transform",(function(e){return"translate(0,"+e.y+")"})).tween("ribbon",W),s.exit().remove(),B(s.merge(g)),R()}(),b!=g){var V=r.transition(C);V.tween?V.tween("ribbon",H):H()(1)}function H(){var e=r.interpolateNumber(g,b);return function(t){g=e(t),v.merge(S).attr("d",I)}}function F(e,t,n){return function(a){var i=this.__direction=-(this.__direction||1);r.select(this).text(i>0?e+" \xbb":"\xab "+e),a.categories.sort((function(){return i*t.apply(this,arguments)})),u=P(G,A,k),R(),B(n.merge(n.enter())),p.call("sortCategories")}}function R(){v=C.select(".ribbon").selectAll("path").data(u,(function(e){return e.path})),(S=v.enter().append("path").each((function(e){e.source.x0=e.source.x,e.target.x0=e.target.x}))).merge(v).attr("class",(function(e){return"category-"+e.major})).attr("d",I),S.merge(v).sort((function(e,t){return t.count-e.count})),v.exit().remove();var e=C.select(".ribbon-mouse").selectAll("path").data(u,(function(e){return e.path})),t=e.enter().append("path");t.merge(e).on("mousemove.parsets",(function(e){J(v.merge(S)).classed("active",!1),L||(K(e=e.node,!0),E(m.call(this,e)),r.event.stopPropagation())})).on("click.parsets",(function(e){v.merge(S).classed("active",!1),v.merge(S).classed("selected",!1),L||(U(e=e.node,!0),p.call("ribbonClick",this,{data:e,selected:!0}),r.event.stopPropagation())})),e.merge(t).sort((function(e,t){return t.count-e.count})).attr("d",j),e.exit().remove()}function z(e){var t=[e],n=v.merge(S).filter((function(n){var r,a;return n.source.node===e&&t.push(r=n.source),n.target.node===e&&t.push(a=n.target),r||a})),a=t.map((function(e){return r.interpolateNumber(e.x0,e.x)})),i=t.length;return function(e){for(var r=0;r<i;r++)t[r].x0=a[r](e);n.attr("d",I)}}function W(e){var t=v.merge(S).filter((function(t){return t.source.dimension.name==e.name||t.target.dimension.name==e.name})),n=r.interpolateNumber(e.y0,e.y);return function(r){e.y0=n(r),t.attr("d",I)}}function K(e,t){if(!L){var n=[];if(function e(t){for(var r in n.push(t),t.children)e(t.children[r])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(S).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("active",!0)}}function U(e,t){if(!L){var n=[];if(function e(t){for(var r in n.push(t),t.children)e(t.children[r])}(e),n.shift(),t)for(;e;)n.push(e),e=e.parent;v.merge(S).filter((function(e){var t=n.indexOf(e.node)>=0;return t&&this.parentNode.appendChild(this),t})).classed("selected",!0).classed("active",!0)}}function J(e){return e.filter((function(e){return!r.select(this).classed("selected")}))}function q(){L||(J(v.merge(S)).classed("active",!1),M.style("display","none"))}function B(e){var n=e.selectAll("g.category").data((function(e){return e.categories}),(function(e){return e.dimension.name+"_"+e.name})),a=n.enter().append("g").attr("class","category");a.merge(n).attr("transform",(function(e){return"translate("+e.x+")"})),n.merge(a).on("mousemove.parsets",(function(e){J(v.merge(S)).classed("active",!1),L||(e.nodes.forEach((function(e){K(e)})),E(y.call(this,e)),r.event.stopPropagation())})).on("mouseout.parsets",q).on("mousedown.parsets",t).call(r.drag().on("start",(function(e){L=!0,e.x0=e.x})).on("drag",(function(t){t.x=r.event.x;for(var n=t.dimension.categories,a=0,i=n[0];++a<n.length;)if(i.x+i.dx/2>(i=n[a]).x+i.dx/2){n.sort((function(e,t){return e.x+e.dx/2-t.x-t.dx/2})),u=P(G,A,k),R(),B(e),K(t.node),p.call("sortCategories");break}var s=0,l=x/(n.length-1);n.forEach((function(e){t===e&&(e.x0=r.event.x),e.x=s,s+=e.count/h*(o-x)+l})),r.select(this).attr("transform",(function(e){return"translate("+e.x0+")"})).transition(),v.merge(S).filter((function(e){return e.source.node===t||e.target.node===t})).attr("d",I)})).on("end",(function(e){L=!1,q(),R(),O(r.select(this)).attr("transform","translate("+e.x+")").tween("ribbon",z)}))).on("click.parsets",(function(e){L||(v.merge(S).classed("active",!1),v.merge(S).classed("selected",!1),e.nodes.forEach((function(e){U(e)})),p.call("categoryClick",this,{data:e,selected:!0}),r.event.stopPropagation())})),n.merge(a).transition().duration(w).attr("transform",(function(e){return"translate("+e.x+")"})).tween("ribbon",z),a.append("rect").attr("width",(function(e){return e.dx})).attr("y",-20).attr("height",20),a.append("line").style("stroke-width",2),a.append("text").attr("dy","-.3em"),n.merge(a).select("rect").attr("width",(function(e){return e.dx})).attr("class",(function(e){return"category-"+(e.dimension===A[0]?k(e.name):"background")})),n.merge(a).select("line").attr("x2",(function(e){return e.dx})),n.merge(a).select("text").text(function(e,t){return function(n,r){var a=this.textContent=e(n,r),i=t(n,r);if(this.getComputedTextLength()<i)return a;this.textContent="\u2026"+a;for(var o=0,s=a.length+1;o<s;){var l=o+s>>1;this.getSubStringLength(0,l)<i?o=l+1:s=l}return o>1?a.substr(0,o-2)+"\u2026":""}}((function(e){return e.name}),(function(e){return e.dx})))}}))}r.rebind=function(e,t){for(var n,r=1,a=arguments.length;++r<a;)e[n=arguments[r]]=S(e,t,t[n]);return e},k.dimensionFormat=function(e){return arguments.length?(v=e,k):v},k.dimensions=function(e){return arguments.length?(_=C(e),k):_},k.value=function(e){return arguments.length?(i=C(e),k):i},k.width=function(e){return arguments.length?(o=+e,k):o},k.height=function(e){return arguments.length?(f=+e,k):f},k.spacing=function(e){return arguments.length?(x=+e,k):x},k.tension=function(e){return arguments.length?(b=+e,k):b},k.duration=function(e){return arguments.length?(w=+e,k):w},k.tooltip=function(e){return arguments.length?(m=null==e?u:e,k):M},k.categoryTooltip=function(e){return arguments.length?(y=null==e?h:e,k):y};var L=r.select("body"),M=L.append("div").style("display","none").attr("class","parsets tooltip");return r.rebind(k,p,"on").value(1).width(960).height(600);function N(e,t){return v.call(this,e.name,t)}function E(e){var t=r.mouse(L.node());M.style("display",null).style("left",t[0]+30+"px").style("top",t[1]-20+"px").html(e)}function O(e){return w?e.transition().duration(w).ease(s):e}function P(e,t,n){var r=[],a=t.length,i=(f-45-2)/(a-1);t.forEach((function(e,t){e.categories.forEach((function(t){t.dimension=e,t.count=0,t.nodes=[]})),e.y=45+t*i}));var s=function e(n,r){if(!n.children)return n.count;var a=t[r],i=0;return a.categories.forEach((function(t){var a=n.children[t.name];if(a){t.nodes.push(a);var o=e(a,r+1);t.count+=o,i+=o}})),i}(e,0);return t.forEach((function(e){e.categories=e.categories.filter((function(e){return e.count}));var t=0,n=x/(e.categories.length-1);e.categories.forEach((function(e){e.x=t,e.dx=e.count/s*(o-x),e.in={dx:0},e.out={dx:0},t+=e.dx+n}))})),t[0].categories.forEach((function(a){var i=a.name;e.children.hasOwnProperty(i)&&function e(n,a,i,l){var c=a.node,d=t[i];d.categories.forEach((function(u){var h=u.name;if(c.children.hasOwnProperty(h)){var f=c.children[h];f.path=a.path+"\0"+h;var g=f.target||{node:u,dimension:d};g.x=u.in.dx,g.dx=f.count/s*(o-x),u.in.dx+=g.dx;var p=f.source||{node:n,dimension:t[i-1]};p.x=n.out.dx,p.dx=g.dx,n.out.dx+=p.dx,f.node=f,f.source=p,f.target=g,f.major=l,r.push(f),i+1<t.length&&e(u,f,i+1,l)}}))}(a,{node:e.children[i],path:i},1,n(i))})),r}function I(e){var t=e.source,n=e.target;return D(t.node.x0+t.x0,t.dimension.y0,t.dx,n.node.x0+n.x0,n.dimension.y0,n.dx,g)}function j(e){var t=e.source,n=e.target;return D(t.node.x+t.x,t.dimension.y,t.dx,n.node.x+n.x,n.dimension.y,n.dx,b)}function D(e,t,n,r,a,i,o){var s,l;return(1===o?["M",[e,t],"L",[r,a],"h",i,"L",[e+n,t],"Z"]:["M",[e,t],"C",[e,s=o*t+(1-o)*a]," ",[r,l=o*a+(1-o)*t]," ",[r,a],"h",i,"C",[r+i,l]," ",[e+n,s]," ",[e+n,t],"Z"]).join("")}function T(e,t){return(e=f*e.y)<(t=f*t.y)?-1:e>t?1:e>=t?0:e<=e?-1:t<=t?1:NaN}},r.parsets.tree=c;var i=r.format(".2%"),o=r.format("d"),s=r.easeElastic,l=0;function c(e,t,n,r){!function e(t){if(t.count=0,t.children)for(var n in t.children)e(t.children[n])}(e);for(var a=t.length,i=n.length,o=0;o<a;o++){for(var s=t[o],l=+r(s,o),c=e,d=0;d<i;d++){var u=n[d],h=s[u],f=c.children;c.count+=l,c=f.hasOwnProperty(h)?f[h]:f[h]={children:d===i-1?null:{},count:0,parent:c,dimension:u,name:h}}c.count+=l}return e}function d(e){return"translate(0,"+e.y+")"}function u(e){for(var t=e.count,n=[];e.parent;)e.name&&n.unshift(e.name),e=e.parent;return n.join(" \u2192 ")+"<br>"+o(t)+" ("+i(t/e.count)+")"}function h(e){return e.name+"<br>"+o(e.count)+" ("+i(e.count/e.dimension.count)+")"}}()},284:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var r=n(29),a=n(168),i=n.n(a);t.default=function(){var e,t=[],n=75,a=!0,o=!1,s=!0,l={start:function(){},draw:function(){},end:function(){}};function c(c){var d,u,h,f,g=c.append("g").attr("class","lasso"),p=g.append("path").attr("class","drawn"),_=g.append("path").attr("class","loop_close"),v=g.append("circle").attr("class","origin"),m=r.drag().on("start",(function(){f=[],d="",p.attr("d",null),_.attr("d",null),t.nodes().forEach((function(e){e.__lasso.possible=!1,e.__lasso.selected=!1,e.__lasso.hoverSelect=!1,e.__lasso.loopSelect=!1;var t=e.getBoundingClientRect();e.__lasso.lassoPoint=[Math.round(t.left+t.width/2),Math.round(t.top+t.height/2)]})),s&&t.on("mouseover.lasso",(function(){this.__lasso.hoverSelect=!0}));l.start()})).on("drag",(function(){var e,s;"touchmove"===r.event.sourceEvent.type?(e=r.event.sourceEvent.touches[0].clientX,s=r.event.sourceEvent.touches[0].clientY):(e=r.event.sourceEvent.clientX,s=r.event.sourceEvent.clientY);var c=r.mouse(this)[0],g=r.mouse(this)[1];""===d?(d=d+"M "+c+" "+g,u=[e,s],h=[c,g],v.attr("cx",c).attr("cy",g).attr("r",7).attr("display",null)):d=d+" L "+c+" "+g;f.push([e,s]);var m=Math.sqrt(Math.pow(e-u[0],2)+Math.pow(s-u[1],2)),y="M "+c+" "+g+" L "+h[0]+" "+h[1];p.attr("d",d),_.attr("d",y),(o=m<=n)&&a?_.attr("display",null):_.attr("display","none");t.nodes().forEach((function(e){e.__lasso.loopSelect=!(!o||!a)&&i()(f,e.__lasso.lassoPoint)<1,e.__lasso.possible=e.__lasso.hoverSelect||e.__lasso.loopSelect})),l.draw()})).on("end",(function(){t.on("mouseover.lasso",null),t.nodes().forEach((function(e){e.__lasso.selected=e.__lasso.possible,e.__lasso.possible=!1})),p.attr("d",null),_.attr("d",null),v.attr("display","none"),l.end()}));e.call(m)}return c.items=function(e){if(!arguments.length)return t;var n=(t=e).nodes();return n.forEach((function(e){e.__lasso={possible:!1,selected:!1}})),c},c.possibleItems=function(){return t.filter((function(){return this.__lasso.possible}))},c.selectedItems=function(){return t.filter((function(){return this.__lasso.selected}))},c.notPossibleItems=function(){return t.filter((function(){return!this.__lasso.possible}))},c.notSelectedItems=function(){return t.filter((function(){return!this.__lasso.selected}))},c.closePathDistance=function(e){return arguments.length?(n=e,c):n},c.closePathSelect=function(e){return arguments.length?(a=!0===e,c):a},c.isPathClosed=function(e){return arguments.length?(o=!0===e,c):o},c.hoverSelect=function(e){return arguments.length?(s=!0===e,c):s},c.on=function(e,t){if(!arguments.length)return l;if(1===arguments.length)return l[e];var n=["start","draw","end"];return n.indexOf(e)>-1&&(l[e]=t),c},c.targetArea=function(t){return arguments.length?(e=t,c):e},c}},293:function(e,t,n){var r=r||{REVISION:"ALPHA"};!function(e){"use strict";var t=function(e,t){if(!e)throw t||"Assertion failed"},n=function(e,t,n){return e.hasOwnProperty(t)?e[t]:n},r=!1,a=0,i=function(e,t){return e+function e(){if(r)return r=!1,a;var t=2*Math.random()-1,n=2*Math.random()-1,i=t*t+n*n;if(0==i||i>1)return e();var o=Math.sqrt(-2*Math.log(i)/i);return a=n*o,r=!0,t*o}()*t},o=function(e){if("undefined"===typeof e||isNaN(e))return[];if("undefined"===typeof ArrayBuffer){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t}return new Float64Array(e)},s=function(e,t,n){for(var r="undefined"!==typeof n,a=[],o=0;o<e;o++){for(var s=[],l=0;l<t;l++)r?s.push(n):s.push(i(0,1e-4));a.push(s)}return a},l=function(e,t){for(var n=e.length,r=0,a=0;a<n;a++){var i=e[a],o=t[a];r+=(i-o)*(i-o)}return r},c=function(e,n,r){var a=Math.sqrt(e.length),i=Math.floor(a);t(i===a,"D should have square number of elements.");for(var s=Math.log(n),l=o(i*i),c=o(i),d=0;d<i;d++){for(var u=-1/0,h=1/0,f=1,g=!1,p=0;!g;){for(var _=0,v=0;v<i;v++){var m=Math.exp(-e[d*i+v]*f);d===v&&(m=0),c[v]=m,_+=m}var y=0;for(v=0;v<i;v++){if(0==_)m=0;else m=c[v]/_;c[v]=m,m>1e-7&&(y-=m*Math.log(m))}y>s?(u=f,h===1/0?f*=2:f=(f+h)/2):(h=f,u===-1/0?f/=2:f=(f+u)/2),p++,Math.abs(y-s)<r&&(g=!0),p>=50&&(g=!0)}for(v=0;v<i;v++)l[d*i+v]=c[v]}var x=o(i*i),b=2*i;for(d=0;d<i;d++)for(v=0;v<i;v++)x[d*i+v]=Math.max((l[d*i+v]+l[v*i+d])/b,1e-100);return x};function d(e){return e>0?1:e<0?-1:0}var u=function(e){e=e||{};this.perplexity=n(e,"perplexity",30),this.dim=n(e,"dim",2),this.epsilon=n(e,"epsilon",10),this.iter=0};u.prototype={initDataRaw:function(e){var n=e.length,r=e[0].length;t(n>0," X is empty? You must have some data!"),t(r>0," X[0] is empty? Where is the data?");var a=function(e){for(var t=e.length,n=o(t*t),r=0;r<t;r++)for(var a=r+1;a<t;a++){var i=l(e[r],e[a]);n[r*t+a]=i,n[a*t+r]=i}return n}(e);this.P=c(a,this.perplexity,1e-4),this.N=n,this.initSolution()},initDataDist:function(e){var n=e.length;t(n>0," X is empty? You must have some data!");for(var r=o(n*n),a=0;a<n;a++)for(var i=a+1;i<n;i++){var s=e[a][i];r[a*n+i]=s,r[i*n+a]=s}this.P=c(r,this.perplexity,1e-4),this.N=n,this.initSolution()},initSolution:function(){this.Y=s(this.N,this.dim),this.gains=s(this.N,this.dim,1),this.ystep=s(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var e=this.N,t=this.costGrad(this.Y),n=t.cost,r=t.grad,a=o(this.dim),i=0;i<e;i++)for(var s=0;s<this.dim;s++){var l=r[i][s],c=this.ystep[i][s],u=this.gains[i][s],h=d(l)===d(c)?.8*u:u+.2;h<.01&&(h=.01),this.gains[i][s]=h;var f=(this.iter<250?.5:.8)*c-this.epsilon*h*r[i][s];this.ystep[i][s]=f,this.Y[i][s]+=f,a[s]+=this.Y[i][s]}for(i=0;i<e;i++)for(s=0;s<this.dim;s++)this.Y[i][s]-=a[s]/e;return n},debugGrad:function(){for(var e=this.N,t=this.costGrad(this.Y),n=(t.cost,t.grad),r=1e-5,a=0;a<e;a++)for(var i=0;i<this.dim;i++){var o=this.Y[a][i];this.Y[a][i]=o+r;var s=this.costGrad(this.Y);this.Y[a][i]=o-r;var l=this.costGrad(this.Y),c=n[a][i],d=(s.cost-l.cost)/(2*r);console.log(a+","+i+": gradcheck analytic: "+c+" vs. numerical: "+d),this.Y[a][i]=o}},costGrad:function(e){for(var t=this.N,n=this.dim,r=this.P,a=this.iter<100?4:1,i=o(t*t),s=0,l=0;l<t;l++)for(var c=l+1;c<t;c++){for(var d=0,u=0;u<n;u++){var h=e[l][u]-e[c][u];d+=h*h}var f=1/(1+d);i[l*t+c]=f,i[c*t+l]=f,s+=2*f}for(var g=t*t,p=o(g),_=0;_<g;_++)p[_]=Math.max(i[_]/s,1e-100);var v=0,m=[];for(l=0;l<t;l++){var y=new Array(n);for(u=0;u<n;u++)y[u]=0;for(c=0;c<t;c++){v+=-r[l*t+c]*Math.log(p[l*t+c]);var x=4*(a*r[l*t+c]-p[l*t+c])*i[l*t+c];for(u=0;u<n;u++)y[u]+=x*(e[l][u]-e[c][u])}m.push(y)}return{cost:v,grad:m}}},e.tSNE=u}(r),function(t){"use strict";"undefined"===typeof e.exports?window.tsnejs=t:e.exports=t}(r)},315:function(e,t,n){},316:function(e,t,n){},318:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(5),o=n.n(i),s=(n(182),n(10)),l=n(11),c=n(12),d=n(17),u=n(18),h=n(335),f=n(164),g=n.n(f),p=(n(183),n(25)),_=n.n(p),v=n(40),m=(n(185),n(332)),y=n(333),x=n(85),b=n(337),w=n(73),S=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],C=["#498B77","#89C2AE","#C1D6D3"],k=["#DC143C"],L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return 1===t||2===t||3===t?S[e]:5===t?e?C[0]:k[0]:void 0};function M(e){for(var t=e.senders,n=e.receivers,r=e.feature.length,a={},i=0;i<r;i++)a[i]=[];for(var o=0;o<n.length;o++){var s=n[o];s in a||(a[s]=[]),a[s].push(t[o])}return a}function N(e,t){return t.has(e),"#fff"}function E(e,t){var n=e+"/"+t;return 0===t||(n=n+" ("+(e/t*100).toFixed(2)+"%)"),n}var O=["Train","Valid","Test","Others"];function P(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}function I(e,t){return e.sort((function(e,t){return e.anchor_similarity>t.anchor_similarity?-1:1})),t<1&&(t=1),t>e.length&&(t=e.length),e=e.slice(0,t)}function j(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];if(0===t)return e;for(var r=0;r<e.length;r++)e[r]=e[r]/t;return e}function D(e,t){for(var n=new Array(t).fill(0),r=0;r<e.length;r++){var a=e[r].anchor_label;n[a]=n[a]+1}return j(n)}function T(e,t,n,r,a){var i=t.node_features[e],o=[];o.push(L(i,2));for(var s=0;s<r.length;s++)o.push(L(n[r[s]].graph_out.node_features[e]));return o.push(N(e,a)),o}function A(e,t){return e.active?e.end<t.start?{active:!0,start:e.start,end:t.end,count:e.count+t.count}:(console.log("invalid added"),{active:!1}):t.active?t:(console.log("inactive added"),{active:!1})}function G(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=e.length,r={},a=0;a<n;a++)r[e[a]]?r[e[a]]=r[e[a]]+1:r[e[a]]=1;for(var i=Object.keys(r),o=[],s=0;s<i.length;s++)o.push(parseFloat(i[s]));var l=function(e,t){return e-t};o=o.sort(l);for(var c=[],d={active:!1},u={active:!1},h=n/t,f=0;f<o.length;f++){var g={active:!0,start:o[f],end:o[f],count:r[o[f]]};(u=A(d,g)).active&&(u.count<h?f===i.length-1&&(c.push(u),u={active:!1}):u.count>=2*h?(d.active&&c.push(d),c.push(g),u={active:!1}):(c.push(u),u={active:!1}),d=Object.assign({},u))}for(var p=0;p<c.length;p++){var _=c[p].start,v=c[p].end;c[p].name=_===v?""+v:"["+_.toFixed(2)+","+v.toFixed(2)+"]"}return c}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n].start,a=t[n].end;if(e>=r&&e<=a)return t[n].name}return""+e}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n].start,a=t[n].end;if(e>=r&&e<=a)return t[n].name}return""+e}function F(e){for(var t=[],n=0,r=0;r<e.length;r++)0==r?(n=e[r],t.push(r)):e[r]>n?(n=e[r],t=[r]):e[r]==n&&t.push(r);return t.length>=2?-1:t[0]}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(e-0)*(n-t)+t}var z=n(328),W=n(21),K=n(6),U=n(329),J=n(336),q=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).handleOk=function(e){console.log(e),r.props.changeGraphViewSettingsModal_visible(!1)},r.handleCancel=function(e){console.log(e),r.props.changeGraphViewSettingsModal_visible(!1)},r.handleUnfocusedNodesChange=function(e){var t=e.target.checked,n=r.props.GraphViewState;r.props.changeGraphViewState(Object(K.a)(Object(K.a)({},n),{},{DisplayUnfocusedNodes:t}))},r.handleOverviewChange=function(e){var t=e.target.checked,n=r.props.GraphViewState;r.props.changeGraphViewState(Object(K.a)(Object(K.a)({},n),{},{DisplayOverview:t}))},r.state={},r}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.GraphViewState;return r.createElement(U.a,{title:"Graph View Settings",visible:this.props.GraphViewSettingsModal_visible,onOk:this.handleOk,onCancel:this.handleCancel,footer:[r.createElement(x.a,{key:"OK",type:"primary",onClick:this.handleOk},"OK")]},"Rendering Options:",r.createElement("div",null,r.createElement(J.a,{checked:e.DisplayUnfocusedNodes,onChange:this.handleUnfocusedNodesChange},"Display unfocused nodes."),r.createElement("br",null),r.createElement(J.a,{checked:e.DisplayOverview,onChange:this.handleOverviewChange},"Display overview.")))}}]),n}(r.Component),B=function(e){return{type:"MATRIX_FILTERS_CHANGE",matrixFilters:e}},X=function(e){return{type:"PSSETTINGMODAL_VISIBLE_CHANGE",PSSettingsModal_visible:e}},Y=function(e){return{type:"GRAPHVIEWSETTINGMODAL_VISIBLE_CHANGE",GraphViewSettingsModal_visible:e}},Z=function(e){return{type:"KVALUE_CHANGE",K_value:e}},$=function(e){return{type:"SELECTEDMODELS_CHANGE",selected_models_list:e}},Q=function(e){return{type:"PSDIMENSIONS_CHANGE",PSDimensions:e}},ee=function(e){return{type:"SHOW_SOURCE_CHANGE",showSource:e}},te=Object(W.b)((function(e){return{GraphViewSettingsModal_visible:e.GraphViewSettingsModal_visible,GraphViewState:e.GraphViewState}}),(function(e){return{changeGraphViewSettingsModal_visible:function(t){return e(Y(t))},changeGraphViewState:function(t){return e(function(e){return{type:"GRAPHVIEWSTATE_CHANGE",GraphViewState:e}}(t))}}}))(q);n(232);function ne(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#bbb";e.beginPath(),e.strokeStyle=i,e.rect(t,n,r,a),e.stroke()}function re(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.8;e.fillStyle=i,e.globalAlpha=o,e.fillRect(t,n,r,a),e.globalAlpha=1}function ae(e,t,n,r,a,i){e.lineWidth=i,e.strokeStyle=t,e.beginPath(),e.arc(r,a,n,0,2*Math.PI,!0),e.stroke()}function ie(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=e.globalAlpha;e.globalAlpha=i,e.beginPath(),e.arc(r,a,n,0,2*Math.PI,!0),e.fillStyle=t,e.fill(),e.globalAlpha=o}function oe(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=e.globalAlpha;e.globalAlpha=s,e.beginPath(),e.moveTo(r,a),e.arc(r,a,n,i,o),e.fillStyle=t,e.closePath(),e.fill(),e.globalAlpha=l}function se(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=e.globalAlpha,c=s;c<0?c=0:c>1&&(c=1),e.globalAlpha=c,e.strokeStyle=t,o&&(e.lineWidth=o),e.beginPath(),e.moveTo(n,r),e.lineTo(a,i),e.stroke(),e.globalAlpha=l}function le(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],d=l;d<0?d=0:d>1&&(d=1);var u=1;c&&(u=d);var h=t.length-2,f=t.length-1;if(h>0){ie(e,t[f],a,i,o,u),s&&ae(e,"#000",a,i,o,2);for(var g=360/h,p=-90-g/2,_=1;_<t.length-1;_++){var v=p,m=v+g;oe(e,t[_],a,i,o,v/180*Math.PI,m/180*Math.PI,u),p=m}if(h>1){p=-90-g/2;for(var y=1;y<t.length-1;y++){var x=p/180*Math.PI,b=i+r*Math.cos(x),w=o+r*Math.sin(x),S=i+a*Math.cos(x),C=o+a*Math.sin(x);se(e,t[f],b,w,S,C,r-n,u),p+=g}}ie(e,t[f],r,i,o,u),ie(e,t[0],n,i,o,u)}else ie(e,t[0],a,i,o,u),s&&ae(e,"#000",a,i,o,2)}var ce=n(29),de="#bbb",ue=2,he="2,3",fe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).global_simulation=null,r.saved_transform=null,r.refresh_number=0,r.updateTransform=r.updateTransform.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderCanvas()}},{key:"componentDidUpdate",value:function(e,t){e.graph_json.name===this.props.graph_json.name&&e.width===this.props.width&&e.GraphViewState===this.props.GraphViewState||this.renderCanvas()}},{key:"updateTransform",value:function(e){this.saved_transform=e}},{key:"renderColorLegend",value:function(e,t){var n=e.selectAll("g.legend_row_color").data(t,(function(e,t){return e.text+"_"+t+"_"+e.color})),r=n.enter().append("g").attr("class","legend_row_color").attr("transform",(function(e,t){return"translate(10,"+(10+20*t)+")"}));r.append("circle").attr("r",5).attr("fill",(function(e){return e.color})),r.append("text").attr("x",10).attr("y",5).text((function(e){return e.text})),n.exit().remove()}},{key:"renderLegend",value:function(e){for(var t=e.width,n=e.height,r=e.radius,a=e.radius_gap,i=e.colorLegend,o=e.pieLegend.pie_name,s=o.length,l=r-a,c=n-10-100,d=ce.select("#force_directed_graph").select("#svgChart").attr("width",t).attr("height",n),u=d.select("#ForceDirectedLegend").attr("width",100).attr("height",100).attr("transform","translate(10,"+c+")"),h=[],f=0;f<s;f++)h.push({index:f,value:1/s});var g=-180/s,p=ce.pie().startAngle(g/180*Math.PI).endAngle((2+g/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index}))(h);for(var _=[{text:"Label","text-anchor":"begin","dominant-baseline":"central",y_offset:1}],v=[-7.5,0,19],m=0;m<s;m++)_.push({text:o[m],"text-anchor":"begin","dominant-baseline":"central",y_offset:v[m]});var y=0;_.forEach((function(e){var t=""+e.text;t.length>y&&(y=t.length)}));var x=8*y+80;this.refresh_number=this.refresh_number+1;var b=u.selectAll("g.legend_pie").data([this.refresh_number],(function(e){return e}));b.exit().remove();var w=b.enter().append("g").attr("class","legend_pie").attr("transform","translate(30,50)");w.append("rect").attr("x",-30).attr("y",-50).attr("width",x).attr("height",100).attr("fill","#fff").attr("opacity",.8).attr("stroke","#bbb").attr("stroke-width",1).attr("rx",3).attr("ry",3);var S=["#1f77b4","#ff7f0e","#2ca02c","#d62728"];w.append("circle").attr("class","inner_circle").attr("r",3*l).attr("fill",(function(e){return S[0]})).attr("stroke","white");for(var C=function(e){var t=w.append("path").attr("class","arc_"+e),n=w.select("path.arc_"+e);t.merge(n).style("fill",(function(t){return S[e+1]})).attr("d",function(e){return ce.arc().innerRadius(e).outerRadius(2*e)}(3*r)(p[e])).style("stroke","#ddd").style("stroke-width",1);var a=[4.5*r*Math.sin(120*e/180*Math.PI),4.5*r*-Math.cos(120*e/180*Math.PI)],i=[4.5*r*Math.sin(120*e/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+_[e+1].y_offset];1===e&&(i=[7.5*r*Math.sin(120*e/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+_[e+1].y_offset]);var o=[7.5*r*Math.sin(60/180*Math.PI),7.5*r*-Math.cos(120*e/180*Math.PI)+_[e+1].y_offset];w.append("path").attr("stroke",de).attr("stroke-width",ue).style("stroke-dasharray",he).attr("d",function(e){for(var t="",n=0;n<e.length;n++){var r="M";n>0&&(r="L"),t=t+r+e[n][0]+" "+e[n][1]+" "}return t}([a,i,o])).attr("fill","none"),w.append("text").attr("x",o[0]).attr("y",o[1]).attr("text-anchor",_[e+1]["text-anchor"]).attr("dominant-baseline",_[e+1]["dominant-baseline"]).text(_[e+1].text)},k=0;k<s;k++)C(k);var L=7.5*r*Math.sin(60/180*Math.PI),M=7.5*r*-Math.cos(60/180*Math.PI)+_[0].y_offset;w.append("line").attr("stroke",de).attr("stroke-width",ue).style("stroke-dasharray",he).attr("x1",0).attr("y1",0).attr("x2",L).attr("y2",M),w.append("text").attr("x",L).attr("y",M).attr("text-anchor",_[0]["text-anchor"]).attr("dominant-baseline",_[0]["dominant-baseline"]).text(_[0].text);var N=0;i.forEach((function(e){var t=""+e.text;t.length>N&&(N=t.length)}));var E=8*N+24,O=20*i.length,P=c-O-10,I=d.select("#ForceDirectedColorLegend").attr("width",E).attr("height",O).attr("transform","translate(10,"+P+")"),j=I.selectAll("rect").data([0]);j.enter().append("rect").merge(j).attr("x",0).attr("y",0).attr("width",E).attr("height",O).attr("fill","#fff").attr("opacity",.8).attr("stroke","#bbb").attr("stroke-width",1).attr("rx",3).attr("ry",3),this.renderColorLegend(I,i)}},{key:"renderCanvas",value:function(){var e=this.props.onNodeClick,t=this.props.graph_json.nodenum,n=this.props.graph_json.enable_forceDirected,r=this.props.graph_json.NeighborSet,a=this.props.graph_json.colorLegend,i=this.props.graph_json.pieLegend,o=(i.pie_name,{strength:.01,radius:15,showlabel:!0,showarrow:!0,width:this.props.width,height:this.props.height}),s=this.props.GraphViewState,l=s.DisplayUnfocusedNodes,c=s.DisplayOverview;t>=100&&(o={strength:.4,radius:3,showlabel:!1,showarrow:!1,width:this.props.width,height:this.props.height});var d=o.width,u=o.height,h=o.radius,f=this.props.width,g=ce.select("#force_directed_graph").select("#bottom").attr("width",f+"px").attr("height",u+"px").node().getContext("2d"),p=ce.select("#force_directed_graph").select("#middle").attr("width",f+"px").attr("height",u+"px").node(),_=p.getContext("2d"),v=ce.select("#force_directed_graph").select("#overview").attr("width",f+"px").attr("height",u+"px").node().getContext("2d"),m=ce.select("#force_directed_graph").select("#event").attr("width",f+"px").attr("height",u+"px").node(),y=f-100-10,x=u-100-10,b=y+100,w=x+100,S=3*h+.3*3;this.global_simulation&&(this.global_simulation.stop(),delete this.global_simulation);var C=ce.forceSimulation().force("center",ce.forceCenter(f/2,u/2)).force("x",ce.forceX(f/2).strength(.1)).force("y",ce.forceY(u/2).strength(.1)).force("charge",ce.forceManyBody().strength(-50)).force("link",ce.forceLink().strength(1).id((function(e){return e.id}))).force("collide",ce.forceCollide().radius((function(e){return S}))).alphaTarget(0).alphaDecay(.05);this.global_simulation=C;var k={width:d,height:u,radius:h,radius_gap:.3,colorLegend:a,pieLegend:i};this.renderLegend(k);var L,M=this.updateTransform,N={x:0,y:0,k:1};function E(e,t){var n=e.hasOwnProperty("hover_cons")?e.hover_cons:1,r=t.hasOwnProperty("hover_cons")?t.hover_cons:1;return e.radius*n*2<e.radius*r*2?-1:1}function O(e,t){return e.hasOwnProperty("hovered")&&!1!==e.hovered?!0!==t:!1!==t}function P(){ce.select("#force_directed_graph").select("#tooltip").style("opacity",0)}L=this.saved_transform?this.saved_transform:ce.zoomIdentity;var I=this.props.graph_json,j=m,D=null;function T(e,t){var n,r,a,i=L.invertX(e),o=L.invertY(t),s=I.nodes.slice().sort(E);for(n=s.length-1;n>=0;--n){var c=s[n];if(l||c.highlight){r=i-c.x,a=o-c.y;var d=c.hasOwnProperty("hover_cons")?c.hover_cons:1,u=2*c.radius*d;if(r*r+a*a<u*u)return c}}return null}function A(e,t){return e>=y&&e<=b&&t>=x&&t<=w&&c?"OverviewCanvas":"GraphCanvas"}function G(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?e=D:(e=ce.mouse(this),D=e);var a=n;if(e){var i=A(e[0],e[1]),o=T(e[0],e[1]);if("GraphCanvas"===i&&o){a=!0;var s=o.id,l=o.title;ce.select("#force_directed_graph").select("#tooltip").style("opacity",.8).style("top",e[1]+5+"px").style("left",e[0]+5+"px").html(l);var c=r[o.id];I.nodes.forEach((function(e){s===e.id?(e.hovered=!0,e.hover_cons=3):c.indexOf(e.id)>=0?(e.hovered=!0,e.hover_cons=2):(e.hovered=!1,e.hover_cons=1)}))}else I.nodes.forEach((function(e){a=a||O(e,!1),e.hovered=!1,e.hover_cons=1})),P()}else I.nodes.forEach((function(e){a=a||O(e,!1),e.hovered=!1,e.hover_cons=1})),P();a&&W()}function V(e,t){var n=e.x,r=e.y,a=e.width,i=e.height,o=-t.x,s=-t.y,l=1/t.k;return{x:(n+o)*l,y:(r+s)*l,width:a*l,height:i*l}}function H(e,t){var n=e.x,r=e.y,a=-t.x,i=-t.y,o=1/t.k;return{x:(n+a)*o,y:(r+i)*o}}function F(e,t){var n={x:f/2,y:u/2},r=H(n,L),a={x:e,y:t},i=H(a,N),o=-(i.x-r.x)*L.k+L.x,s=-(i.y-r.y)*L.k+L.y;console.log({ori_point:n,ori_inverse_point:r,overview_point:a,overview_inverse_point:i,new_x:o,new_y:s}),L.x=o,L.y=s,M(L),z()}function R(e){l&&(I.links.filter((function(e){return!e.source.highlight||!e.target.highlight})).forEach((function(t){se(e,t.color,t.source.x,t.source.y,t.target.x,t.target.y,null,t.weight)})),I.nodes.filter((function(e){return!e.highlight})).forEach((function(t,n){var r=t.radius-.3,a=t.radius,i=2*t.radius,o=t.node_weight;le(e,t.color,r,a,i,t.x,t.y,!1,o,!0)}))),I.links.filter((function(e){return!(!e.source.highlight||!e.target.highlight)})).forEach((function(t){se(e,t.color,t.source.x,t.source.y,t.target.x,t.target.y,5*t.weight,t.weight)})),I.nodes.filter((function(e){return e.highlight})).forEach((function(t,n){var r=t.radius-.3,a=t.radius,i=2*t.radius,o=t.node_weight;le(e,t.color,r,a,i,t.x,t.y,!1,o,!0)}))}function z(){if(g.save(),g.clearRect(0,0,f,u),g.translate(L.x,L.y),g.scale(L.k,L.k),console.log("simulationUpdate",L),R(g),g.restore(),c){var e=function(){var e=0,t=0,n=0,r=0,a=!1;return I.nodes.forEach((function(i){if(l||!l&&i.highlight){var o=i.x,s=i.y;a?(e>o&&(e=o),n<o&&(n=o),t>s&&(t=s),r<s&&(r=s)):(e=o,t=s,n=o,r=s,a=!0)}})),{leftbound:e-6-14,upperbound:t-6-14,occupyWidth:n-e+12+28,occupyHeight:r-t+12+28}}();N=function(e,t,n,r,a){var i=a.leftbound,o=a.upperbound,s=a.occupyHeight,l=a.occupyWidth,c=n/l,d=r/s,u=Math.min(c,d);return{k:u,x:(n-l*u)/2-i*u+e,y:(r-s*u)/2-o*u+t}}(y,x,100,100,e),console.log("calTransform",N);var t={x:0,y:0,width:f,height:u},n=V({x:y,y:x,width:100,height:100},N),r={leftbound:n.x,upperbound:n.y,occupyWidth:n.width,occupyHeight:n.height},a=function(e,t){var n=e.x,r=e.y,a=e.width,i=e.height,o=t.x,s=t.y,l=t.k;return{x:n*l+o,y:r*l+s,width:a*l,height:i*l}}(function(e,t,n){var r=n.leftbound,a=n.upperbound,i=n.occupyHeight,o=n.occupyWidth,s=r+o,l=a+i,c=V(e,t),d=c.x,u=c.y,h=c.x+c.width,f=c.y+c.height;d<r&&(d=r),h>s&&(h=s),u<a&&(u=a),f>l&&(f=l);var g=h-d,p=f-u;return g<0?g=0:g>o&&(g=o),p<0?p=0:p>i&&(p=i),{x:d,y:u,width:g,height:p}}(t,L,r),N);v.save(),v.clearRect(0,0,f,u),ne(v,y,x,100,100),re(v,y,x,100,100),v.translate(N.x,N.y),v.scale(N.k,N.k),R(v),v.scale(1/N.k,1/N.k),v.translate(-N.x,-N.y),ne(v,a.x,a.y,a.width,a.height,"#000"),re(v,a.x,a.y,a.width,a.height,"#ccc",.5),v.restore()}G(p,!0)}function W(){var e=function(e){return!(!e.hasOwnProperty("hovered")||!e.hovered)};_.save(),_.clearRect(0,0,f,u),_.translate(L.x,L.y),_.scale(L.k,L.k),I.links.filter((function(t){return!(!e(t.source)||!e(t.target))})).forEach((function(e){se(_,e.real_color,e.source.x,e.source.y,e.target.x,e.target.y,null,e.weight)})),I.nodes.filter((function(t){return e(t)})).sort(E).forEach((function(e,t){var n=e.radius-.3,r=e.radius,a=2*e.radius,i=e.node_weight;le(_,e.real_color,n*e.hover_cons,r*e.hover_cons,a*e.hover_cons,e.x,e.y,!0,i,!1)})),_.restore()}ce.select(j).on("click",(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(ce.event.defaultPrevented)return;n?t=D:(t=ce.mouse(this),D=t);if(t)if("OverviewCanvas"===A(t[0],t[1]))F(t[0],t[1]);else{var r=T(t[0],t[1]);r&&e(r.id)}})).on("mousemove",G).on("mouseout",(function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=e;D=null,I.nodes.forEach((function(e){t=t||O(e,!1),e.hovered=!1,e.hover_cons=1})),P(),t&&W()})),ce.select(j).call(ce.zoom().scaleExtent([.1,8]).on("zoom",(function(){var e=ce.mouse(this);D=e,L=ce.event.transform,"GraphCanvas"===A(e[0],e[1])&&(M(L),z())}))),n?(C.nodes(I.nodes).on("tick",z),C.force("link").links(I.links)):(C.stop(),C.nodes(I.nodes),C.force("link").links(I.links),z())}},{key:"render",value:function(){return r.createElement("div",{id:"force_directed_graph"},r.createElement("canvas",{id:"bottom",className:"AbsPos"}),r.createElement("canvas",{id:"middle",className:"AbsPos"}),r.createElement("canvas",{id:"overview",className:"AbsPos"}),r.createElement("svg",{id:"svgChart",xmlns:"http://www.w3.org/2000/svg",className:"AbsPos"},r.createElement("g",{id:"ForceDirectedLegend"}),r.createElement("g",{id:"ForceDirectedColorLegend"})),r.createElement("div",{id:"tooltip",className:"AbsPos"}),r.createElement("canvas",{id:"event",className:"AbsPos"}))}}]),n}(r.Component),ge=Object(W.b)((function(e){return{GraphViewState:e.GraphViewState}}),(function(e){return{}}))(fe),pe=m.a.Option,_e=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prevGraphJson=null,r.onEnableForceDirected=r.onEnableForceDirected.bind(Object(c.a)(r)),r.onExtendedModeChange=r.onExtendedModeChange.bind(Object(c.a)(r)),r.onNodeClick=r.onNodeClick.bind(Object(c.a)(r)),r.onChangeSelectInspectNode=r.onChangeSelectInspectNode.bind(Object(c.a)(r)),r.state={enableForceDirected:!1},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"onNodeClick",value:function(e){!1===this.props.showSource?(this.props.changeSelectInspectNode(e),this.props.changeShowSource(!0),this.props.changeExtendedMode(3)):this.props.changeSelectInspectNode(e)}},{key:"constructGraphJson",value:function(e,t,n,r,a,i,o,s,l,c,d){var u,h=c.join("_"),f=e.common,g=e.individual,p=e.subgraphs,_=e.subgraph_list,v="",m=!1;d>=0?(v=_[d],Object.keys(p[v].node_subgraphs).indexOf(""+i)>=0&&(r=(u=p[v].node_subgraphs[i]).nodes,m=!0)):m=!1,console.log("subgraph_mode",m);var y=r.join("_"),x=f.name+"_"+f.dataset_id+"_"+t+"_"+f.data_type_id+"_SELECTED_"+y+"_SELECTEDEND_"+a+"_"+s+"_"+l+"_SELECTMODEL_"+h+"_SELECTMODELEND_"+d;4==t&&(x=x+"_"+n);var b,w=f.graph_in,S=f.graph_target,C=f.graph_layout,k=f.mask,M=new Set(k.train);if(0===r.length){r=[];for(var E=0;E<C.length;E++)r.push(E)}var O=a;(b=C).length>0&&(b=function(e,t,n){if(0===e.length)return e;var r=function(e){if(0===e.length)return{xmin:0,xmax:0,ymin:0,ymax:0};for(var t=e[0][0],n=e[0][0],r=e[0][1],a=e[0][1],i=0;i<e.length;i++){var o=e[i][0],s=e[i][1];t>o&&(t=o),n<o&&(n=o),r>s&&(r=s),a<s&&(a=s)}return{xmin:t,xmax:n,ymin:r,ymax:a}}(e),a=20;e.length>=100&&(a=20);var i=t-2*a,o=n-2*a,s=r.xmax-r.xmin,l=r.ymax-r.ymin;0===s&&(s=1e-16),0===l&&(l=1e-16);for(var c=Math.min(i/s,o/l),d=a+(i-c*s)/2,u=a+(o-c*l)/2,h=r.xmin,f=r.ymin,g=[],p=0;p<e.length;p++){var _=d+(e[p][0]-h)*c,v=u+(e[p][1]-f)*c;g.push([_,v])}return g}(b,s,l));var P=f.data_type_id;if(2==P){var I=w.senders,j=w.receivers,D=S.node_features.length,T=!1,A=this.prevGraphJson;A&&A.success&&A.nodes.length===D&&(T=!0);for(var G=w.senders.length,V=[],H=[],F=[],z=0;z<D;z++){var W,K,U=z,J=""+U,q=1,B=1,X=S.node_features[U];W=X;for(var Y=[L(X,2)],Z=0;Z<c.length;Z++){var $=g[c[Z]].graph_out.node_features[U];Y.push(L($,3))}Y.push(N(U,M)),K=Y.slice();var Q=r.indexOf(U);Q>=0?m&&(J=J+": "+(B=u.nweight[Q]).toFixed(4)):(Y=["#ddd","#ddd","#ddd","#ddd","#ddd"],q=0);var ee=3;U===i&&!0===o&&(ee=6);var te={id:U,group:W,color:Y,real_color:K,radius:ee,highlight:q,node_weight:R(B,0,1),title:J};T?(te.x=A.nodes[z].x,te.y=A.nodes[z].y):!1===O&&(te.x=b[z][0],te.y=b[z][1]),V.push(te)}for(var ne=0;ne<G;ne++){var re="#eee",ae=.1;if(m)u.eids.indexOf(ne)>=0&&(re="#bbb",ae=.1);else r.indexOf(I[ne])>=0&&r.indexOf(j[ne])>=0&&(re="#bbb");F.indexOf(re)>=0||F.push(re),H.push({source:I[ne],target:j[ne],value:1,color:re,real_color:"#bbb",weight:R(ae)})}var ie=c;return{success:!0,name:x,nodes:V,links:H,links_color:F,nodenum:D,edgenum:G,enable_forceDirected:O,colorLegend:function(){var e=f.graph_additional_info,t=e.num_class,n=[];if(Object.keys(e).indexOf("idx_to_class")>=0)for(var r=e.idx_to_class,a=0;a<t;a++)n.push({text:a+":"+r[a],color:L(a,2)});else for(var i=0;i<t;i++)n.push({text:i,color:L(i,2)});return n}(),pieLegend:{pie_name:ie}}}return console.log("Unknown data type : ",P),{success:!1}}},{key:"onEnableForceDirected",value:function(e){this.setState({enableForceDirected:e})}},{key:"onExtendedModeChange",value:function(e){this.props.changeExtendedMode(e)}},{key:"constructExtendedSelectedNodeIdList",value:function(e,t){if(0===e.length)return[];for(var n=e.slice(),r=0;r<e.length;r++){var a=e[r];n=n.concat(t[a])}return n=Array.from(new Set(n))}},{key:"onChangeSelectInspectNode",value:function(e,t){var n=parseInt(e);(!n||n<0)&&(n=0),n>=t&&(n=t-1),console.log("graphview, new_node_id",n),this.props.changeSelectInspectNode(n)}},{key:"showGraphViewSettingModal",value:function(){this.props.changeGraphViewSettingsModal_visible(!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.show_mode,i=t.explained_node,o=t.selectedNodeIdList,s=t.selected_models_list,l=t.showSource,c=t.select_inspect_node,d=t.width,u=t.height,h=t.extendedMode,f=this.onNodeClick,g=o,p=n.common,_=n.subgraph_list,v=M(p.graph_in),w=d-10,S=u-50,C=-1;l&&(g=[c]),2===h?g=this.constructExtendedSelectedNodeIdList(g,v):3===h?(g=this.constructExtendedSelectedNodeIdList(g,v),g=this.constructExtendedSelectedNodeIdList(g,v)):h>=4&&(C=h-4)>=_.length&&(console.log("Not found the subgraph."),C=-1),this.props.changeSpecificNodeIdList(g);var k=this.constructGraphJson(n,a,i,g,this.state.enableForceDirected,c,l,w,S,s,C);if(k.NeighborSet=v,k.success&&(this.prevGraphJson=k),k.success){var L=k.nodenum,N=[[1,"None"],[2,"One Hop"],[3,"Two Hop"]];if(l){var O=n.subgraphs,P=!1;h<=3&&(P=!0);for(var I=0;I<_.length;I++){var j=_[I];if(Object.keys(O[j].node_subgraphs).indexOf(""+c)>=0)O[j].node_subgraphs[c].nodes.length>0&&(N.push([I+4,_[I]]),h==I+4&&(P=!0))}P||this.props.changeExtendedMode(3)}return r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Graph View",r.createElement("div",{style:{float:"right"}},l?[r.createElement("span",{key:"span1"},"Id:"),r.createElement(y.a,{min:0,max:L,size:"small",value:c,onChange:function(t){e.onChangeSelectInspectNode(t,L)}}),r.createElement("span",{key:"span3"},"\xa0"),r.createElement(x.a,{size:"small",onClick:function(){e.props.changeShowSource(!1),e.props.changeExtendedMode(1)}},"X")]:[r.createElement("span",{key:"span2"})],r.createElement(te,null),"\xa0\xa0 Subgraph:\xa0",r.createElement(m.a,{placeholder:"Select a subgraph",value:h,style:{width:"100px"},onChange:this.onExtendedModeChange,size:"small"},N.map((function(e){return r.createElement(pe,{value:e[0],key:e[0]},e[1])}))),"\xa0\xa0",this.state.enableForceDirected?r.createElement(x.a,{type:"primary",size:"small",onClick:function(){e.onEnableForceDirected(!1)}},"Stop Layout"):r.createElement(x.a,{type:"default",size:"small",onClick:function(){e.onEnableForceDirected(!0)}},"Start Layout"),"\xa0\xa0",r.createElement(x.a,{type:"default",size:"small",onClick:function(){e.showGraphViewSettingModal()}},r.createElement(z.a,null)),"\xa0\xa0 #Nodes: ",r.createElement(b.a,null,E(g.length,L)," "))),r.createElement("div",{className:"ViewBox"},r.createElement("div",{style:{width:"100%"}},r.createElement(ge,{graph_json:k,width:w,height:S,onNodeClick:f}))))}return r.createElement("div",null)}}]),n}(r.Component),ve=Object(W.b)((function(e){return{selectedNodeIdList:e.selectedNodeIdList,selectedMessagePassingNodeIdList:e.selectedMessagePassingNodeIdList,showSource:e.showSource,select_inspect_node:e.select_inspect_node,extendedMode:e.extendedMode,GraphViewSettingsModal_visible:e.GraphViewSettingsModal_visible,selected_models_list:e.selected_models_list}}),(function(e){return{changeSpecificNodeIdList:function(t){return e(function(e){return{type:"SPECIFIC_NODE_ID_LIST_CHANGE",specificNodeIdList:e}}(t))},changeSelectInspectNode:function(t){return e(function(e){return{type:"SELECT_INSPECT_NODE_CHANGE",select_inspect_node:e}}(t))},changePrevGraphJson:function(t){return e(function(e){return{type:"PREV_GRAPH_JSON_CHANGE",prevGraphJson:e}}(t))},changeShowSource:function(t){return e(ee(t))},changeExtendedMode:function(t){return e(function(e){return{type:"EXTENDED_MODE_CHANGE",extendedMode:e}}(t))},changeGraphViewSettingsModal_visible:function(t){return e(Y(t))}}}))(_e),me=(n(137),n(29)),ye=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="Matrix_",r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name===this.props.feature_matrix_json.name&&e.MatrixFilters.refreshnumber===this.props.MatrixFilters.refreshnumber&&e.MatrixRowFilters.refreshnumber===this.props.MatrixRowFilters.refreshnumber||this.renderD3()}},{key:"renderD3",value:function(){var e=this.props.feature_matrix_json,t=this.props.layout_config,n=e.showSource,r=0,a=30,i=100,o=0,s=t.width-o-a,l=e.y_axis,c=e.y_axis_info,d=e.x_axis,u=e.selectedFeatureTitle,h=e.matrix,f=e.type,g=e.color_info,p=e.highlight_flag,_=e.pieName.length,v=this.props.MatrixFilters;console.log("renderD3",c);var m=this.props.MatrixRowFilters;function y(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n}var x=Math.max(1,Math.floor(s/15));v.hasOwnProperty("index")||(v.index=[0,x]),v.index[1]-v.index[0]>=x&&(v.index[1]=v.index[0]+x);var b=g.y_axis_color;m.hasOwnProperty("row_index")&&n?(d=d.slice(v.index[0],v.index[1]),u=u.slice(v.index[0],v.index[1]),l=y(m.row_index,l),b=y(m.row_index,b),c=y(m.row_index,c),console.log("Filtered y axis info",c),h=function(e,t,n){for(var r=[],a=new Set(n),i={},o=0;o<n.length;o++)i[n[o]]=o;for(var s=0;s<e.length;s++)if(e[s].x>=t[0]&&e[s].x<t[1]){var l=e[s].y;a.has(l)&&r.push({x:e[s].x-t[0],y:i[l],value:e[s].value})}return r}(h,v.index,m.row_index)):(d=d.slice(v.index[0],v.index[1]),u=u.slice(v.index[0],v.index[1]),h=function(e,t){for(var n=[],r=0;r<e.length;r++)e[r].x>=t[0]&&e[r].x<t[1]&&n.push({x:e[r].x-t[0],y:e[r].y,value:e[r].value});return n}(h,v.index)),n||l.length===b.length||(l=[],d=[],h=[]);var w,S,C=Math.floor(s/x),k=C*l.length+20;1===e.distance_select&&"discrete"===f?(w=2,S=["#ffffd9","#081d58"]):(w=9,S=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]);var L,M=function(){for(var e=[],t=0;t<d.length;t++)for(var n=0;n<l.length;n++)e.push({x:t,y:n,value:0});return e}();L="discrete"===f?M.concat(h):h;var N=me.max(L,(function(e){return e.value})),E=me.min(L,(function(e){return e.value})),O=me.select("#FeatureMatrix_"+this.props.id).attr("width",s+o+a).attr("height",k+r+i).attr("transform","translate("+t.x+","+t.y+")").select("#Matrix").attr("transform","translate("+o+","+r+")");n&&(l=[]);var P=O.selectAll(".y_axisLabel").data(l,(function(e){return e})),I=Math.min(5,C/4),j=2*-I-.3,D=2*I,T=P.enter().append("g").attr("class","y_axisLabel");T.merge(P).attr("transform",(function(e,t){return"translate("+j+","+(t*C+D)+")"})).on("mouseover",(function(e,t){return Y.style("visibility","visible").text(c[t])})).on("mousemove",(function(e,t){return Y.style("top",me.event.pageY-10+"px").style("left",me.event.pageX+10+"px")})).on("mouseout",(function(e,t){return Y.style("visibility","hidden")})),P.exit().remove();var A,G,V,H,F,R,z;g.enable_y_axis_color&&function(){var e=g.y_axis_color;A=[];for(var t=0;t<_;t++)A.push({index:t,value:1/_});var n=-180/_;G=me.pie().startAngle(n/180*Math.PI).endAngle((2+n/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),V=G(A),H=T.append("circle").attr("class","outer_circle"),F=P.select("circle.outer_circle"),H.merge(F).attr("r",(function(e){return 2*I})).attr("fill",(function(t,n){return e[n][4]}));for(var r=[],a=function(t){var n=T.append("path").attr("class","arc_"+t),a=P.select("path.arc_"+t),i=n.merge(a);i.style("fill",(function(n,r){return e[r][t+1]})).attr("d",(function(e){return function(e){return me.arc().innerRadius(e).outerRadius(2*e)}(I)(V[t])})),r.push(i)},i=0;i<_;i++)a(i);R=T.append("circle").attr("class","inner_circle"),z=P.select("circle.inner_circle"),R.merge(z).attr("r",(function(e){return I-.3})).attr("fill",(function(t,n){return e[n][0]}))}();T.append("text").merge(P.select("text")).text((function(e){return e})).style("text-anchor","end").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").style("dominant-baseline","central").attr("transform","translate("+j+",0)").attr("class","y-axis");var W=O.selectAll(".x_axisLabel").data(d,(function(e){return e})),K=W.enter().append("g").attr("class","x_axisLabel");K.merge(W).attr("transform",(function(e,t){return"translate("+t*C+",0)"})).on("mouseover",(function(e,t){return X.style("visibility","visible").text(u[t])})).on("mousemove",(function(e){return X.style("top",me.event.pageY-10+"px").style("left",me.event.pageX+10+"px")})).on("mouseout",(function(e){return X.style("visibility","hidden")})),W.exit().remove();K.append("text").merge(W.select("text")).text((function(e){return e})).style("text-anchor","begin").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").attr("transform","translate("+.25*C+", -2)rotate(-45)").attr("class","x-axis");for(var U=[],J=(N-E)/(w-1),q=0;q<w;q++)U.push(q*J+E);me.scaleLinear().domain(U).range(S);var B=O.selectAll(".hour").data(L,(function(e){return e.x+":"+e.y}));B.enter().append("rect").attr("class","hour bordered").merge(B).attr("x",(function(e){return e.x*C})).attr("y",(function(e){return e.y*C})).attr("rx",4).attr("ry",4).attr("width",C).attr("height",C).style("fill-opacity",(function(e){return e.value})).style("fill",(function(e){return t=e.value,n=e.y,t>0?b[n][1]:S[0];var t,n})).style("stroke",(function(e){var t=e.y;return t>p.length?"#eee":!0===p[t]?"#222":"#eee"})).style("stroke-width","2").style("stroke-opacity",(function(e){var t=e.y;return t>p.length?0:!0===p[t]?1:0})).on("mouseover",(function(e){return X.style("visibility","visible").text(e.value.toFixed(4))})).on("mousemove",(function(e){return X.style("top",me.event.pageY-10+"px").style("left",me.event.pageX+10+"px")})).on("mouseout",(function(e){return X.style("visibility","hidden")})),B.exit().remove();var X=me.select("body").select("#tooltip_matrix").style("position","absolute").style("z-index","10").style("visibility","hidden").text("a simple tooltip"),Y=me.select("body").select("#tooltip_node_title").style("position","absolute").style("z-index","10").style("visibility","hidden").text("a simple tooltip")}},{key:"render",value:function(){return r.createElement("g",{id:"FeatureMatrix_"+this.props.id},r.createElement("g",{id:"Matrix"}))}}]),n}(r.Component),xe=Object(W.b)((function(e){return{MatrixFilters:e.matrixFilters,MatrixRowFilters:e.matrixRowFilters}}),(function(e){return{changeMatrixFilters:function(t){return e(B(t))}}}))(ye),be=n(29),we=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="BrushBarChart_",r.updateMatrixFilters=r.updateMatrixFilters.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name!==this.props.feature_matrix_json.name&&(be.selectAll("#"+this.TAB+this.props.id).remove(),this.renderD3())}},{key:"updateMatrixFilters",value:function(e){var t=Object.assign({},this.props.MatrixFilters);t.refreshnumber=t.refreshnumber+1,t.index=e.index,this.props.changeMatrixFilters(t)}},{key:"renderD3",value:function(){var e,t,n,r,a,i,o=this.props.feature_matrix_json.selectedFeatureStatistics,s=this.props.layout_config,l=be.select("#chart_"+this.props.id).append("g").attr("id",this.TAB+this.props.id).attr("width",s.width).attr("height",s.height).attr("transform","translate("+s.x+","+s.y+")"),c=20,d=30,u=0,h=0,f=+s.width-h-d,g=+s.height-c-u,p=this.props.layout_config.max_row_num_block,_=be.scaleBand().range([0,f]).padding(.1),v=be.scaleBand().range([0,f]).padding(.1),m=be.scaleLinear().range([g,0]),y=be.scaleLinear().range([g,0]);t=o.map((function(e,t){return{id:t,ratio:e}})),n=[].concat(t),r=n.length;var x=this.updateMatrixFilters;e=be.brushX().extent([[0,0],[f,g]]).on("brush end",(function(){if(!be.event.sourceEvent||"zoom"!==be.event.sourceEvent.type){var t,o,s=be.event.selection||v.range();i=[Math.round(s[0]/(f/r)),Math.round(s[1]/(f/r))],_.domain(n.slice(i[0],i[1]).map((function(e){return e.id}))),i[1]-i[0]>=p+1?(i[1]=i[0]+p,be.select(this).call(e.move,i.map((function(e){return e*f/r})))):(t=i[0],o=i[1],a.selectAll(".bar").style("fill-opacity",(function(e,n){return n>=t&&n<o?"1":"0.3"})),x({index:[i[0],i[1]]}))}})),a=l.append("g").attr("class","context").attr("transform","translate("+h+","+c+")"),_.domain(n.map((function(e){return e.id}))),m.domain([0,be.max(n,(function(e){return e.ratio}))]),v.domain(_.domain()),y.domain(m.domain()),function(){var e=a.selectAll(".bar").data(n);e.attr("x",(function(e){return v(e.id)})).attr("width",v.bandwidth()).attr("y",(function(e){return y(e.ratio)})).attr("height",(function(e){return g-y(e.ratio)})).style("fill",(function(e){return"steelblue"})),e.enter().insert("rect").attr("class","bar").attr("x",(function(e){return v(e.id)})).attr("width",v.bandwidth()).attr("y",(function(e){return y(e.ratio)})).attr("height",(function(e){return g-y(e.ratio)})).style("fill",(function(e){return"steelblue"})),e.exit().remove()}(),a.append("g").attr("class","brush").call(e).call(e.move,v.range())}},{key:"render",value:function(){return r.createElement("g",{id:"chart_"+this.props.id})}}]),n}(r.Component),Se=Object(W.b)((function(e){return{MatrixFilters:e.matrixFilters}}),(function(e){return{changeMatrixFilters:function(t){return e(B(t))}}}))(we),Ce=(n(240),n(29)),ke=(Ce.tree,Ce.hierarchy,Ce.select),Le=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="IndentedTree_",r.updateMatrixFilters=r.updateMatrixFilters.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.feature_matrix_json.name!==this.props.feature_matrix_json.name&&(Ce.selectAll("#IndentedTree").remove(),this.renderD3())}},{key:"updateMatrixFilters",value:function(e){var t=Object.assign({},this.props.MatrixRowFilters);t.refreshnumber=t.refreshnumber+1,t.row_index=e,this.props.changeMatrixRowFilters(t)}},{key:"renderD3",value:function(){var e=this.props.feature_matrix_json.indentedList,t=this.props.feature_matrix_json.pieName.length,n=this.props.layout_config,r=10,a=10,i=20,o=10,s=n.width-a-o,l=n.width-r-i,c=n.barHeight,d=ke("#hierarchy-container").attr("width",s+a+o).attr("height",l+r+i).attr("transform","translate("+n.x+","+n.y+")").append("g").attr("id","IndentedTree").attr("transform","translate("+o+","+r+")").selectAll(".y_axisLabel").data(e,(function(e){return e.id})),u=c,h=Math.min(5,u/4),f=2*h+.3,g=d.enter().append("g").attr("class","y_axisLabel");g.merge(d).attr("transform",(function(e,t){return"translate("+(f+30*e.level)+","+(t*u+0)+")"})).on("mouseover",(function(e,t){return L.style("visibility","visible").text(e.node_title)})).on("mousemove",(function(e,t){return L.style("top",Ce.event.pageY-10+"px").style("left",Ce.event.pageX+10+"px")})).on("mouseout",(function(e,t){return L.style("visibility","hidden")})),d.exit().remove();for(var p=[],_=0;_<t;_++)p.push({index:_,value:1/t});var v=-180/t,m=Ce.pie().startAngle(v/180*Math.PI).endAngle((2+v/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index}))(p),y=g.append("circle").attr("class","outer_circle"),x=d.select("circle.outer_circle");y.merge(x).attr("r",(function(e){return 2*h})).attr("fill",(function(e,t){return e.color[e.color.length-1]}));for(var b=[],w=function(e){var t=g.append("path").attr("class","arc_"+e),n=d.select("path.arc_"+e),r=t.merge(n);r.style("fill",(function(t,n){return t.color[e+1]})).attr("d",(function(t){return function(e){return Ce.arc().innerRadius(e).outerRadius(2*e)}(h)(m[e])})),b.push(r)},S=0;S<t;S++)w(S);var C=g.append("circle").attr("class","inner_circle"),k=d.select("circle.inner_circle");C.merge(k).attr("r",(function(e){return h-.3})).attr("fill",(function(e,t){return e.color[0]})),g.append("text").merge(d.select("text")).text((function(e){return e.id})).style("text-anchor","start").style("font-size","9pt").style("font-family","Consolas, courier").style("fill","#000").style("dominant-baseline","central").attr("transform","translate("+f+",0)").attr("class","y-axis");var L=Ce.select("body").select("#tooltip_node_title").style("position","absolute").style("z-index","10").style("visibility","hidden").text("a simple tooltip")}},{key:"render",value:function(){return r.createElement("g",{id:"hierarchy-container"})}}]),n}(r.Component),Me=Object(W.b)((function(e){return{MatrixRowFilters:e.matrixRowFilters}}),(function(e){return{changeMatrixRowFilters:function(t){return e(function(e){return{type:"MATRIX_ROW_FILTERS_CHANGE",matrixRowFilters:e}}(t))}}}))(Le),Ne=(n(241),n(29)),Ee=n(317),Oe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).TAB="VerticalSlider_",r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.layout_config.name!==this.props.layout_config.name&&(Ne.selectAll("#"+this.TAB+this.props.id).remove(),this.renderD3())}},{key:"renderD3",value:function(){var e=this.props.layout_config,t=e.node_start_index,n=e.node_max_index;console.log("rerender d3",t,n);var r=Ne.select("#chart_"+this.props.id).append("g").attr("id",this.TAB+this.props.id).attr("width",e.width).attr("height",e.height).attr("transform","translate("+e.x+","+e.y+")"),a=0,i=0,o=0,s=0,l=(e.width,+e.height-a-o),c=this.props.changeNodeStartIndex,d=Ee.sliderLeft().min(0).max(n).height(l).displayValue(!1).default(n-t).step(1).handle(Ne.symbol().type(Ne.symbolCircle).size(200)()).on("onchange",(function(e){console.log("onchange, choose value",e,n-e),c(n-e)})),u=r.append("g").attr("transform","translate(30,0)");u.call(d),u.select("g.axis").remove()}},{key:"render",value:function(){return r.createElement("g",{id:"chart_"+this.props.id})}}]),n}(r.Component),Pe=Object(W.b)((function(e){return{}}),(function(e){return{}}))(Oe),Ie=n(242).default,je=m.a.Option,De=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onAxisChange=r.onAxisChange.bind(Object(c.a)(r)),r.onDistanceChange=r.onDistanceChange.bind(Object(c.a)(r)),r.onDataSourceChange=r.onDataSourceChange.bind(Object(c.a)(r)),r.onColorEncodeChange=r.onColorEncodeChange.bind(Object(c.a)(r)),r.onEnableSort=r.onEnableSort.bind(Object(c.a)(r)),r.changeNodeStartIndex=r.changeNodeStartIndex.bind(Object(c.a)(r)),r.state={axis_select:2,distance_select:1,dataSource_select:1,color_encode:2,enableSorting:1,node_start_index:0},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"calculateFeatureCosDistance",value:function(e,t,n,r){for(var a=e.length,i=n.length,o=0,s=0;s<a;s++){var l=n.indexOf(e[s]);l>=0&&(o+=t[s]*r[l])}for(var c=0,d=0,u=0;u<a;u++)c+=t[u]*t[u];for(var h=0;h<i;h++)d+=r[h]*r[h];return o/((c=Math.sqrt(c))*(d=Math.sqrt(d))+1e-8)}},{key:"calculateFeatureDistance",value:function(e,t){for(var n=e.length,r=t.length,a=0,i=0;i<n;i++)t.indexOf(e[i])>=0&&(a+=1);return n+r-2*a}},{key:"calculateEuclideanDistance",value:function(e,t){for(var n=e.length,r=0,a=0;a<n;a++)r+=(e[a]-t[a])*(e[a]-t[a]);return r=Math.sqrt(r)}},{key:"constructIndentedList",value:function(e,t,n,r,a){var i=a.getNodeColorInfo,o=a.features,s=a.features_value,l=[],c=[],d=[];l.push({id:t,color:i(t),level:n,dist:2});for(var u=o[t],h=s[t];l.length>0;){var f=l[0],g=f.id,p=f.level;if(l.shift(),!(c.indexOf(g)>=0)&&!(p>r)){d.push(f),c.push(g);var _=Object.keys(e[g]);if(p+1<=r)for(var v=p+1,m=0;m<_.length;m++){var y=parseInt(_[m]);if(!(c.indexOf(y)>=0)){var x=o[y],b=s[y],w=this.calculateFeatureCosDistance(u,h,x,b);l.push({id:y,color:i(y),level:v,dist:w})}}}}return d.sort((function(e,t){return e.dist>t.dist?-1:1})),d}},{key:"constructIndentedListFromKFS",value:function(e,t,n){var r=n.getNodeColorInfo,a=[];a.push({id:e,color:r(e),level:0,dist:2});I(t[e].details,this.props.K_value).forEach((function(e){var t=e.anchor_id;a.push({id:t,color:r(t),level:1,dist:e.anchor_similarity})}));return a.sort((function(e,t){return e.dist>t.dist?-1:1})),a}},{key:"constructIndentedTree",value:function(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=o.getNodeColorInfo,c=o.features,d=o.features_value;if(n>=r)return{name:""+t,children:[],row_id:a,next_row_id:a+1,edge_weight:s,color:l(t)};for(var u=Object.keys(e[t]),h=[],f=a,g=a+1,p=[],_=c[i],v=d[i],m=0;m<u.length;m++){var y=parseInt(u[m]);if(y!==t&&y!==i){var x=c[y],b=d[y],w=this.calculateFeatureCosDistance(_,v,x,b);p.push({id:y,dist:w})}}p.sort((function(e,t){return e.dist>t.dist?-1:1}));for(var S=0;S<p.length;S++){var C=p[S].id,k=e[t][C],L=this.constructIndentedTree(e,C,n+1,r,g,i,o,k);g=L.next_row_id,h.push(L)}return{name:""+t,children:h,row_id:f,next_row_id:g,edge_weight:s,color:l(t)}}},{key:"sequentialIndentedTree",value:function(e){var t=[];t.push(parseInt(e.name));for(var n=0;n<e.children.length;n++)t=t.concat(this.sequentialIndentedTree(e.children[n]));return t}},{key:"sequentialIndentedTreeToList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r={id:parseInt(e.name),name:e.name,color:e.color,depth:t};n.push(r);for(var a=0;a<e.children.length;a++)n=n.concat(this.sequentialIndentedTreeToList(e.children[a],t+1));return n}},{key:"getNodeColorInfoFull",value:function(e,t,n,r,a){for(var i=t.node_features[e],o=[L(i,2)],s=0;s<a.length;s++)o.push(L(n[a[s]].graph_out.node_features[e]));return o.push(N(e,r)),o}},{key:"hclusterSortingSelectedNode",value:function(e){for(var t=e.num_nodes,n=e.selectedNodeIdList,r=e.features,a=e.features_value,i=[],o=[],s=[],l=0;l<t;l++){for(var c=[],d=0;d<t;d++)c.push(0);i.push(c),o.push([n[l],0]),s.push(!1)}for(var u=0;u<t;u++)for(var h=n[u],f=r[h],g=a[h],p=0;p<u;p++){var _=n[p],v=r[_],m=a[_],y=1-this.calculateFeatureCosDistance(f,g,v,m);i[u][p]=y,i[p][u]=y}for(var x=Ie.optimal_leaf_order().distance_matrix(i)(o),b=Ie.stablepermute(o,x),w=[],S=0;S<t;S++)w.push(b[S][0]);n=w.slice();for(var C=[],k=1;k<t;k++){var L=n[k],M=r[L],N=a[L],E=k-1,O=n[E],P=r[O],I=a[O],j=1-this.calculateFeatureCosDistance(M,N,P,I);C.push(j),j<.2&&(s[k]=!0,s[E]=!0)}return{selectedNodeIdList:n,highlight_flag:s}}},{key:"hclusterSortingSelectedFeatures",value:function(e){for(var t=e.pre_selected_feature_stats_index,n=e.pre_selected_feature,r=[],a=t.length,i=[],o=0;o<a;o++){for(var s=[],l=0;l<a;l++)s.push(0);r.push(s),i.push([n[o],0])}for(var c=0;c<a;c++)for(var d=t[c],u=0;u<c;u++){var h=t[u],f=this.calculateFeatureDistance(d,h);r[c][u]=f,r[u][c]=f}return{perm:Ie.optimal_leaf_order().distance_matrix(r)(i)}}},{key:"constructFeatureMatrixJson",value:function(e,t,n,r,a,i,o,s,l,c,d,u,h,f){var g=h.max_col_num_block,p=h.node_start_index,_=t.join("_"),v=f.join("_"),m=e.common,y=e.individual,x=m.name+"_"+m.dataset_id+"_"+m.data_type_id+"_SELECTED_"+_+"_SELECTED_END_"+n+"_"+r+"_"+a+"_"+i+"_"+o+"_"+l+"_"+c+"_"+d+"_"+this.props.K_value+"_SELECTEDMODEL_"+v+"_SELECTEDMODELEND_";x=s?x+"_"+u:x+"_"+p+"_"+g;var b=!1,w=e.feature_ranking_list,S=e.feature_ranking;if(l>=2&&w.length>=l-1){var C=w[l-2];if(Object.keys(S[C].feature_rank_values).indexOf(""+o)>=0)S[C].feature_rank_values[o].length>0&&(b=!0)}else b=!1;var k=m.graph_in,L=m.graph_target,M=f[0],N=m.graph_explaination.type;if("MessagePassing"!==N)return console.log("Unsupported explaination type , ",N),{success:!1};if(0===t.length)return{success:!1};var E,O=new Set(m.mask.train),P=[];1===a&&(E=k.feature,P=k.feature_value);var I=this.getNodeColorInfoFull;function j(e){return I(e,L,y,O,f)}var D=[];if(s){var T={getNodeColorInfo:j,features:E,features_value:P};t=(D=this.constructIndentedListFromKFS(o,m.graph_additional_info.KFS,T)).map((function(e){return e.id})),console.log("Feature Matrix Common",m.graph_additional_info.KFS,D)}var A=[],G=[],V=[],H=[],F=[],R=0;function z(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}var W=m.graph_additional_info.num_class;if(!(t.length>0&&t.length<=300))return{success:!1};if(1===a){var K=t.length;if((R=t.length-g)<0&&(R=0),K>=2&&!s){var U={num_nodes:K,selectedNodeIdList:t,features:E,features_value:P},J=this.hclusterSortingSelectedNode(U);F=J.highlight_flag;var q=0;p>=(K=(t=J.selectedNodeIdList).length)?(console.log("node_start_index, num_nodes",p,K),p=0,q=K>=g?g:K):p<K&&(q=K>=p+g?p+g:K),t=t.slice(p,q),F=F.slice(p,q),K=t.length}for(var B=[],X=[],Y=[],Z=[],$=[],Q=[],ee=0;ee<t.length;ee++)for(var te=t[ee],ne=y[M].graph_out.node_features[te],re=0;re<E[te].length;re++){var ae=E[te][re];B.indexOf(ae)>=0||(B.push(ae),X.push(0),Y.push(ee),$.push([]),Z.push([]),Q.push({distribution:z(W)}));var ie=B.indexOf(ae);X[ie]=X[ie]+1,$[ie].push(te),Z[ie].push(ee),Q[ie].distribution[ne]=Q[ie].distribution[ne]+1}for(var oe=0;oe<Q.length;oe++){for(var se=Q[oe].distribution,le=0,ce=0;ce<se.length;ce++)le+=se[ce];if(le>0)for(var de=0;de<se.length;de++)se[de]=se[de]/le;Q[oe].distribution=se}var ue=[];if(l>=2&&b){var he=S[w[l-2]].feature_rank_values[o],fe=E[o],ge=t[0],pe=(y[M].graph_out.node_features[ge],X.map((function(e,t){var n=1;n=0===Z[t][0]?1:0;var r=fe.indexOf(B[t]),a=0;return r>=0&&(a=he[r]),{index:B[t],freq:e,pro:a,first:n}})));pe.sort((function(e,t){return e.first>t.first?-1:e.first<t.first?1:e.pro>t.pro?-1:e.pro<t.pro?1:e.freq>t.freq?-1:1})),B=pe.map((function(e){return e.index})),X=pe.map((function(e){return e.freq})),ue=pe.map((function(e){return e.pro}))}else if(1===l){var _e=t[0],ve=y[M].graph_out.node_features[_e],me=X.map((function(e,t){var n=1;return n=0===Z[t][0]?1:0,{index:B[t],freq:e,pro:Q[t].distribution[ve],first:n}}));me.sort((function(e,t){return e.first>t.first?-1:e.first<t.first?1:e.pro>t.pro?-1:e.pro<t.pro?1:e.freq>t.freq?-1:1})),B=me.map((function(e){return e.index})),X=me.map((function(e){return e.freq}))}else{var ye=Z.map((function(e,t){return{index:B[t],stats:X[t],value:e}}));ye.sort((function(e,t){for(var n=e.value,r=t.value,a=n.length,i=r.length,o=0,s=Math.min(a,i),l=0;l<s;l++){if(n[l]<r[l]){o=-1;break}if(n[l]>r[l]){o=1;break}}return 0===o&&(o=a>i?-1:a<i?1:0),o})),B=ye.map((function(e){return e.index})),X=ye.map((function(e){return e.stats}))}G=B,V=X,H=ue;for(var xe=0;xe<t.length;xe++)for(var be=t[xe],we=0;we<E[be].length;we++){var Se,Ce=E[be][we];Se={x:G.indexOf(Ce),y:xe,value:P[be][we]},A.push(Se)}}for(var ke=[],Le=0;Le<t.length;Le++){var Me=j(t[Le]);ke.push(Me)}var Ne=m.data_type_id;if(2===Ne){var Ee=m.graph_additional_info,Oe=[],Pe=[];if(Object.keys(Ee).indexOf("idx_to_attr")>=0&&1===a)for(var Ie=Ee.idx_to_attr,je=0;je<G.length;je++)Oe.push(Ie[G[je]]),b?Pe.push(Ie[G[je]]+": "+H[je].toFixed(4)):Pe.push(Ie[G[je]]);else{Oe=G;for(var De=0;De<G.length;De++)b?Pe.push(G[De]+": "+H[De].toFixed(4)):Pe.push(""+G[De])}var Te,Ae,Ge,Ve=[];if(Object.keys(Ee).indexOf("idx_to_node_title")>=0){for(var He=Ee.idx_to_node_title,Fe=0;Fe<t.length;Fe++){var Re=He[t[Fe]];Ve.push(t[Fe]+": "+Re)}if(s)for(var ze=0;ze<D.length;ze++){var We=D[ze].id,Ke=He[We];D[ze].node_title=We+": "+Ke}console.log("y_axis_info: ",Ve)}else if(Ve=t,s)for(var Ue=0;Ue<D.length;Ue++){var Je=D[Ue].id;D[Ue].node_title=""+Je}Te=1===a?"discrete":"continuous";var qe,Be;Ae=Oe,Ge=t,!1,!0,qe=[],Be=ke;var Xe={enable_x_axis_color:!1,enable_y_axis_color:!0};Xe.x_axis_color=qe,Xe.y_axis_color=Be;var Ye=!0;R<=0&&(Ye=!1);var Ze={node_start_index:p,node_max_index:R,display:Ye};return console.log("verticalSliderConfig",Ze),{success:!0,name:x,matrix:A,x_axis:Ae,y_axis:Ge,y_axis_info:Ve,distance_select:r,type:Te,color_info:Xe,selectedFeatureStatistics:V,selectedFeatureTitle:Pe,indentedList:D,showSource:s,highlight_flag:F,verticalSliderConfig:Ze,pieName:f}}return console.log("Unknown data type : ",Ne),{success:!1}}},{key:"onAxisChange",value:function(e){this.setState({axis_select:e})}},{key:"onDistanceChange",value:function(e){this.setState({distance_select:e})}},{key:"onDataSourceChange",value:function(e){this.setState({dataSource_select:e})}},{key:"onColorEncodeChange",value:function(e){this.setState({color_encode:e})}},{key:"onEnableSort",value:function(e){this.setState({enableSorting:e})}},{key:"changeNodeStartIndex",value:function(e){this.setState({node_start_index:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.specificNodeIdList,i=t.select_inspect_node,o=n.common.graph_explaination.type,s=120;this.props.showSource||(s=100);var l=this.props.width-s-30,c=Math.max(1,Math.floor(l/15)),d=Math.floor(l/c),u=d,h=this.props.height-180-90,f={max_col_num_block:Math.max(1,Math.floor((h+22)/15)),node_start_index:this.state.node_start_index},g=this.constructFeatureMatrixJson(n,a,this.state.axis_select,this.state.distance_select,this.state.dataSource_select,this.state.color_encode,this.props.select_inspect_node,this.props.showSource,this.state.enableSorting,this.props.width,this.props.height,this.props.extendedMode,f,this.props.selected_models_list);if("MessagePassing"==o&&g.success){var p=180+g.y_axis.length*u+20,_=g.verticalSliderConfig,v={width:this.props.width-s,height:100,x:s,y:0,max_row_num_block:c},y={width:this.props.width-s,height:p-180,x:s,y:180,gridSize:d,max_row_num_block:c},x={width:s,height:p-180,x:0,y:180,barHeight:u},b={width:s-60,height:h,x:0,y:190,node_start_index:_.node_start_index,node_max_index:_.node_max_index,name:"verticalslider_"+_.node_max_index},w=function(t){e.onEnableSort(t)},S=function(){return e.state.enableSorting},C=[[0,"Node order"],[1,"Frequency of features"]];if(this.props.showSource){var k=n.feature_ranking_list,L=n.feature_ranking,M=!1,N=S();N<=1&&(M=!0);for(var E=0;E<k.length;E++){var O=k[E];if(Object.keys(L[O].feature_rank_values).indexOf(""+i)>=0)L[O].feature_rank_values[i].length>0&&(C.push([E+2,O]),N==E+2&&(M=!0))}M||w(1)}return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Feature Matrix View",r.createElement("div",{style:{float:"right"}},"Sort features by:\xa0",r.createElement(m.a,{placeholder:"Select a sort mode.",value:S(),style:{width:"120px"},onChange:w,size:"small"},C.map((function(e){return r.createElement(je,{value:e[0],key:e[0]},e[1])}))))),r.createElement("div",{className:"ViewBox",style:{width:"100%",height:this.props.height-40+"px",overflowX:"scroll"}},r.createElement("div",{style:{width:"100%"}},r.createElement("div",{style:{width:"100%",height:p+"px"}},r.createElement("svg",{style:{height:"100%",width:"100%"},id:"FeatureMatrixSVGChart",xmlns:"http://www.w3.org/2000/svg"},r.createElement(Se,{id:3,feature_matrix_json:g,layout_config:v}),r.createElement(xe,{id:1,feature_matrix_json:g,layout_config:y}),this.props.showSource?r.createElement(Me,{id:4,feature_matrix_json:g,layout_config:x}):_.display?r.createElement(Pe,{id:5,feature_matrix_json:g,layout_config:b,changeNodeStartIndex:this.changeNodeStartIndex}):r.createElement("g",null))))))}return r.createElement("div",{style:{width:"100%",height:this.props.height-20+"px",overflowX:"scroll"}},r.createElement("div",{className:"ViewTitle"},"Feature Matrix View"))}}]),n}(r.Component),Te=Object(W.b)((function(e){return{specificNodeIdList:e.specificNodeIdList,showSource:e.showSource,select_inspect_node:e.select_inspect_node,extendedMode:e.extendedMode,K_value:e.K_value,selected_models_list:e.selected_models_list}}),(function(e){return{}}))(De),Ae=(n(246),n(334)),Ge=n(338),Ve=n(339),He=n(330),Fe=n(121),Re=n.n(Fe),ze=window.location.origin,We=Re.a.create({baseURL:"".concat(ze,"/api/"),headers:{"Access-Control-Allow-Origin":"*"}}),Ke=window.location.origin,Ue=(Re.a.create({baseURL:"".concat(Ke,"/data/"),headers:{"Access-Control-Allow-Origin":"*"}}),We);function Je(){return qe.apply(this,arguments)}function qe(){return(qe=Object(v.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/datasets",e.next=4,Ue.get(t);case 4:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.data);case 7:throw n;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e,t,n,r){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(v.a)(_.a.mark((function e(t,n,r,a){var i,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/graph_info",i={dataset_id:t,model_id:n,explain_id:r,graph_id:a},e.next=4,Ue.get("/graph_info",{params:i});case 4:if(200!==(o=e.sent).status){e.next=7;break}return e.abrupt("return",o.data);case 7:throw o;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=Object(v.a)(_.a.mark((function e(t){var n,r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=10;break;case 4:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.data);case 7:throw n;case 10:return"/graph_bundle_info",r={dataset_id:t},e.next=14,Ue.get("/graph_bundle_info",{params:r});case 14:if(200!==(a=e.sent).status){e.next=17;break}return e.abrupt("return",a.data);case 17:throw a;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $e=m.a.Option,Qe=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onDatasetSelectorChange=r.onDatasetSelectorChange.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.initDatasetList()}},{key:"initDatasetList",value:function(){var e=Object(v.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je();case 2:!0===(t=e.sent).success&&this.props.initDatasetList(t.datasets);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onDatasetSelectorChange",value:function(e){this.props.changeDataset(e)}},{key:"render",value:function(){var e=this.props.datasetList.length<=0;return r.createElement(Ge.a,null,r.createElement(Ve.a,{span:4},"Datasets:\xa0"),r.createElement(Ve.a,{span:20},r.createElement(m.a,{placeholder:"Select a dataset",value:this.props.dataset_id||void 0,style:{width:"100%"},onChange:this.onDatasetSelectorChange,disabled:e},this.props.datasetList.map((function(e){return r.createElement($e,{value:e.id,key:e.id},e.name)})))))}}]),n}(r.Component),et=Object(W.b)((function(e){return{dataset_id:e.dataset_id,datasetList:e.datasetList}}),(function(e){return{changeDataset:function(t){return e(function(e){return{type:"DATASET_ID_CHANGE",dataset_id:e}}(t))},clearIdInfo:function(){return e({type:"CLEAR_ID_INFO"})},initDatasetList:function(t){return e(function(e){return{type:"INIT_DATASET_LIST",datasetList:e}}(t))}}}))(Qe),tt=m.a.Option,nt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onModelSelectorChange=r.onModelSelectorChange.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"onModelSelectorChange",value:function(e){e.length<=0||e.length>=4||this.props.changeSelectedModels(e)}},{key:"render",value:function(){var e=!1;(!this.props.selected_models_list||this.props.models_list.length<=0)&&(e=!0);for(var t=this.props.models_list,n=[],a=0;a<t.length;a++){var i={name:t[a],id:a};n.push(i)}return r.createElement(Ge.a,null,r.createElement(Ve.a,{span:4},"Models:\xa0"),r.createElement(Ve.a,{span:20},r.createElement(m.a,{mode:"multiple",allowClear:!0,placeholder:"Select models",style:{width:"100%"},onChange:this.onModelSelectorChange,disabled:e,value:this.props.selected_models_list,defaultValue:[]},n.map((function(e){return r.createElement(tt,{value:e.name,key:e.id},e.name)})))))}}]),n}(r.Component),rt=Object(W.b)((function(e){return{models_list:e.models_list,selected_models_list:e.selected_models_list}}),(function(e){return{changeSelectedModels:function(t){return e($(t))}}}))(nt),at=Ae.a.Group,it=["All","Training","Validation","Test"],ot=["Train","Valid","Test","Others"],st=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).min_K_value=1,r.max_K_value=5,r.handleKvalueChange=function(e){e>=r.min_K_value&&e<=r.max_K_value?r.props.changeK_value(e):e<r.min_K_value?r.props.changeK_value(r.min_K_value):e>r.max_K_value&&r.props.changeK_value(r.max_K_value)},r.onChangeRadioCategory=r.onChangeRadioCategory.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"transformCategoryList",value:function(e){if(4===e.length)return it[0];if(1===e.length){var t=e[0];if("Train"===t)return it[1];if("Valid"===t)return it[2];if("Test"===t)return it[3]}return console.log("Some errors occur in categoryList"),"All"}},{key:"onChangeRadioCategory",value:function(e){var t=e.target.value,n=[];t===it[0]?n=ot:t===it[1]?n=[ot[0]]:t===it[2]?n=[ot[1]]:t===it[3]?n=[ot[2]]:(console.log("Some errors occur in onChangeRadioCategory selectedValue"),n=ot),this.props.onChangeInspectCategoryList(n)}},{key:"render",value:function(){var e=this.transformCategoryList(this.props.InspectCategoryList),t=this.min_K_value,n=this.max_K_value,a=this.props.K_value;return r.createElement("div",null,r.createElement("div",{className:"ViewTitle"},"Control Panel"),r.createElement("div",{className:"ViewBox"},r.createElement(Ge.a,null,r.createElement(et,null)),this.props.dataset_id&&this.props.dataset_id>=0?r.createElement(Ge.a,null,r.createElement(rt,null)):r.createElement("div",null),this.props.dataset_id&&this.props.dataset_id>=0?r.createElement(Ge.a,null,"Inspect category:\xa0\xa0",r.createElement(at,{value:e,onChange:this.onChangeRadioCategory},it.map((function(e,t){return r.createElement(Ae.a,{key:e,value:e},e)})))):r.createElement("div",null),this.props.dataset_id&&this.props.dataset_id>=0?r.createElement(Ge.a,null,r.createElement(Ge.a,null,"K value:"),r.createElement(Ge.a,null,r.createElement(Ve.a,{span:16},r.createElement(He.a,{min:t,max:n,onChange:this.handleKvalueChange,value:"number"===typeof a?a:0})),r.createElement(Ve.a,{span:4},r.createElement(y.a,{min:t,max:n,style:{margin:"0 16px"},value:a,onChange:this.handleKvalueChange})))):r.createElement("div",null)))}}]),n}(r.Component),lt=Object(W.b)((function(e){return{InspectCategoryList:e.InspectCategoryList,dataset_id:e.dataset_id,K_value:e.K_value}}),(function(e){return{onChangeInspectCategoryList:function(t){return e({type:"INSPECT_CATEGORY_LIST_CHANGE",inspectCategoryList:t})},changeK_value:function(t){return e(Z(t))}}}))(st),ct=(n(282),n(29)),dt=(n(283),function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).onRibbonClick=r.onRibbonClick.bind(Object(c.a)(r)),r.clearFilter=r.clearFilter.bind(Object(c.a)(r)),r.onCategoryClick=r.onCategoryClick.bind(Object(c.a)(r)),r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){e.PSJson.name===this.props.PSJson.name&&this.comparePSDimensions(e.PSDimensions,this.props.PSDimensions)||(ct.selectAll("#ParallelSets_SVG").remove(),this.props.changeFilters({}),this.renderD3())}},{key:"comparePSDimensions",value:function(e,t){if(e.length!==t.length)return 0;for(var n=1,r=0;r<e.length;r++)if(e[r]!==t[r]){n=0;break}return n}},{key:"onRibbonClick",value:function(e){for(var t={},n=e.data;n&&n.hasOwnProperty("parent");)t[n.dimension]=[n.name],n=n.parent;this.props.changeFilters(t)}},{key:"onCategoryClick",value:function(e){console.log("onCategoryClick",e);var t={},n=e.data;t[n.dimension.name]=[n.name],this.props.changeFilters(t)}},{key:"clearFilter",value:function(){console.log("clearFilter"),this.props.changeFilters({})}},{key:"renderD3",value:function(){console.log("Parallel Sets props",this.props);var e=this.props,t=e.width,n=e.height,r=e.PSJson,a=e.PSDimensions,i=r.PSData,o=a;if(o.length<=1)console.log("The number of dimensions must be larger or equal to 2.");else{var s=ct.parsets().dimensions(o).width(t).height(n).tension(1).on("ribbonClick",this.onRibbonClick).on("sortDimensions",this.clearFilter).on("sortCategories",this.clearFilter).on("categoryClick",this.onCategoryClick),l=i;ct.select("#parallelSets").append("svg").attr("id","ParallelSets_SVG").attr("width",s.width()).attr("height",s.height()).datum(l).call(s)}}},{key:"render",value:function(){return r.createElement("div",{id:"parallelSets"})}}]),n}(r.Component)),ut=Object(W.b)((function(e){return{PSDimensions:e.PSDimensions}}),(function(e){return{changeFilters:function(t){return e(function(e){return{type:"FILTERS_CHANGE",filters:e}}(t))}}}))(dt),ht=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.createElement(b.a,null," ",E(this.props.PSSelectedNodes,this.props.totalNodeNum))}}]),n}(r.Component),ft=Object(W.b)((function(e){return{PSSelectedNodes:e.PSSelectedNodes}}),(function(e){return{}}))(ht),gt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).min_K_value=1,r.max_K_value=5,r.handleOk=function(e){console.log(e),r.props.PSSettingModal_visible_setting(!1)},r.handleCancel=function(e){console.log(e),r.props.PSSettingModal_visible_setting(!1)},r.handleChange=function(e){e.length<2?console.log("Modal Warning: the number of dimensions cannot be less than 2."):r.props.changePSDimensions(e)},r.handleKvalueChange=function(e){e>=r.min_K_value&&e<=r.max_K_value?r.props.changeK_value(e):e<r.min_K_value?r.props.changeK_value(r.min_K_value):e>r.max_K_value&&r.props.changeK_value(r.max_K_value)},r.state={},r}return Object(l.a)(n,[{key:"render",value:function(){for(var e=m.a.Option,t=[],n=(this.min_K_value,this.max_K_value,this.props.K_value,this.props.CandidatePSDimensions),a=0;a<n.length;a++)t.push(r.createElement(e,{key:n[a]},n[a]));return this.props.PSDimensions.length<=0&&this.props.changePSDimensions(this.props.DefaultPSDimensions),console.log("Parallel Sets View Settings Modal, ",this.props.PSSettingModal_visible),r.createElement(U.a,{title:"Parallel Sets View Settings",visible:this.props.PSSettingModal_visible,onOk:this.handleOk,onCancel:this.handleCancel,footer:[r.createElement(x.a,{key:"OK",type:"primary",onClick:this.handleOk},"OK")]},"Dimensions Selection:",r.createElement(m.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select dimensions.",value:this.props.PSDimensions,onChange:this.handleChange},t))}}]),n}(r.Component),pt=Object(W.b)((function(e){return{PSSettingModal_visible:e.PSSettingsModal_visible,PSDimensions:e.PSDimensions,K_value:e.K_value}}),(function(e){return{PSSettingModal_visible_setting:function(t){return e(X(t))},changePSDimensions:function(t){return e(Q(t))},changeK_value:function(t){return e(Z(t))}}}))(gt),_t=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prev_bundle_id=-1,r.state={},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"componentDidUpdate",value:function(e,t){}},{key:"constructPSJson",value:function(e,t,n,r,a,i){console.log("constructPSJson",e);var o=n.join("_"),s=i.join("_"),l=e.common,c=e.individual;if(0===i.length)return console.log("No selected models"),{success:!1};var d=i[0],u=c[d].graph_out,h=l.name+"_"+l.dataset_id+"_"+t+"_"+l.data_type_id+"_CheckedList_"+o+"_CheckedList_End_"+r+"_"+a+"_"+this.props.K_value+"SELECTED_MODEL_"+s+"_SELECTED_MODEL_END_",f=l.graph_in,g=l.graph_target,p=l.graph_explaination.type;if("MessagePassing"!==p)return console.log("Unsupported explaination type , ",p),{success:!1};var _=l.data_type_id,v=M(f),m=l.mask,y=new Set(l.mask.train);if(2===_){var x,b,S=g.node_features.length,C=l.graph_additional_info.num_class,k=function(e,t,n){for(var r=n.train,a=n.test,i=n.valid,o=[].concat(Object(w.a)(r),Object(w.a)(a),Object(w.a)(i)),s=[],l=0;l<e;l++)o.indexOf(l)>=0||s.push(l);var c=[];return t.indexOf("Train")>=0&&(c=c.concat(r)),t.indexOf("Test")>=0&&(c=c.concat(a)),t.indexOf("Valid")>=0&&(c=c.concat(i)),t.indexOf("Others")>=0&&(c=c.concat(s)),c}(S,n,m),L=e.individual_model_names,N=function(e,t,n,r){for(var a,i,o,s,l,c=[],d=[],u=[],h=0;h<e;h++){var f=0,g=0,p=n[h],_=r[h],v={cgt_npt:0,cgt_ngt:0,cpt_npt:0,cpt_ngt:0};if(h in t){f=t[h].length;for(var m=0,y=0;y<f;y++){var x=t[h][y];n[x]===r[x]&&(m+=1),a=v,i=p,o=_,s=n[x],l=r[x],i===s&&(a.cgt_ngt=a.cgt_ngt+1),i===l&&(a.cgt_npt=a.cgt_npt+1),o===s&&(a.cpt_ngt=a.cpt_ngt+1),o===l&&(a.cpt_npt=a.cpt_npt+1),v=a}0===f?(g=0,v.cgt_ngt=0,v.cgt_npt=0,v.cpt_ngt=0,v.cpt_npt=0):(g=m/f,v.cgt_ngt=v.cgt_ngt/f,v.cgt_npt=v.cgt_npt/f,v.cpt_ngt=v.cpt_ngt/f,v.cpt_npt=v.cpt_npt/f)}c.push(f),d.push(g),u.push(v)}return{degree_list:c,one_hop_accuracy_list:d,cn_consistency_list:u}}(S,v,g.node_features,u.node_features);x=l.graph_additional_info.SPD,b=l.graph_additional_info.KFS;for(var E=N.degree_list,O=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=e.length,r={},a=0;a<n;a++)r[e[a]]?r[e[a]]=r[e[a]]+1:r[e[a]]=1;for(var i=Object.keys(r),o=[],s=0;s<i.length;s++)o.push(parseInt(i[s]));var l=function(e,t){return e-t};o=o.sort(l);for(var c=[],d={active:!1},u={active:!1},h=n/t,f=0;f<o.length;f++){var g={active:!0,start:o[f],end:o[f],count:r[o[f]]};(u=A(d,g)).active&&(u.count<h?f===i.length-1&&(c.push(u),u={active:!1}):u.count>=2*h?(d.active&&c.push(d),c.push(g),u={active:!1}):(c.push(u),u={active:!1}),d=Object.assign({},u))}for(var p=0;p<c.length;p++){var _=c[p].start,v=c[p].end;c[p].name=_===v?""+v:"["+_+","+v+"]"}return c}(E.slice()),P=N.one_hop_accuracy_list,j=N.cn_consistency_list,R=[],z=i,W=d+"_correctness",K=[],U=0;U<L.length;U++)K.push(L[U]+"_correctness");for(var J=d+"_one_hop_accuracy",q="Nearest_training_nodes_dominant_label_consistency",B="Top-k_most_similar_training_nodes_dominant_label_consistency",X="Shortest_Path_Distance_to_Training_Nodes",Y=[W,q,B,"Label"],Z=["Label",J,"Degree",X,"Label_consistency","Label-Prediction_consistency","Prediction-Label_consistency","Prediction_consistency",q,B,"Confidence"],$=0;$<K.length;$++)Z.push(K[$]);for(var Q=0;Q<C;Q++)Z.push("Nearest_training_nodes_label_distribution_"+Q);for(var ee=0;ee<C;ee++)Z.push("Top-k_most_similar_training_nodes_label_distribution_"+ee);for(var te=0,ne={},re=(function(){var e=l.graph_additional_info,t=e.num_class,n=[];if(Object.keys(e).indexOf("idx_to_class")>=0)for(var r=e.idx_to_class,a=0;a<t;a++)n.push(r[a]);else for(var i=0;i<t;i++)n.push(""+i)}(),d+"_Confidence"),ae=0;ae<k.length;ae++){var ie=k[ae],oe={},se=g.node_features[ie],le=u.node_features[ie],ce=u.output_vector[ie][le];oe.Data_id=ie,oe.Color=T(ie,g,c,i,y),oe.Shortest_Path_Distance_to_Train_Nodes=x[ie].dis,oe.Spd_node_info=x[ie].train_nodes,"inf"===oe.Shortest_Path_Distance_to_Train_Nodes||oe.Shortest_Path_Distance_to_Train_Nodes>=5?oe.Transformed_Distance=0:oe.Transformed_Distance=1-.2*oe.Shortest_Path_Distance_to_Train_Nodes,oe[X]=oe.Shortest_Path_Distance_to_Train_Nodes,oe.Spd_node_info[le],oe.Spd_node_info[le]>=Math.max.apply(Math,Object(w.a)(oe.Spd_node_info))&&1,oe.Topkfs_node_info=b[ie].train_nodes,oe.Topkfs_nodes=b[ie].details,oe.Topkfs_nodes=I(oe.Topkfs_nodes,this.props.K_value),oe.Topkfs_node_info=D(oe.Topkfs_nodes,C),oe.Topkfs_nodes=oe.Topkfs_nodes.sort((function(e,t){return e.anchor_label<t.anchor_label?-1:e.anchor_label>t.anchor_label?1:e.anchor_similarity>t.anchor_similarity?-1:1})),oe.CN_consistency=j[ie],oe.Degree=H(E[ie],O),oe.Real_Degree=E[ie],oe.Ground_Truth_Label=""+se,se in ne||(ne[se]={correct_num:0,wrong_num:0}),oe.Label=oe.Ground_Truth_Label,oe[re]=ce;for(var de=0;de<K.length;de++){var ue=L[de],he=c[ue].graph_out.node_features[ie];oe[ue+"_Prediction_Label"]=he,oe[K[de]]=he===se?"Correct":"Wrong"}se===le?(te+=1,ne[se].correct_num=ne[se].correct_num+1):ne[se].wrong_num=ne[se].wrong_num+1,oe[J]=""+P[ie];var fe=P[ie];fe>0&&fe<1&&(oe[J]="(0,1)"),R.push(oe)}for(var ge,pe=[[],[],[],[]],_e=[],ve=[],me=[],ye=[[],[],[],[]],xe=[],be=[],we=0;we<C;we++)_e.push([]),ve.push([]),xe.push([]),be.push([]);for(var Se=0;Se<R.length;Se++){var Ce=R[Se],ke=Ce.CN_consistency;pe[0].push(ke.cgt_ngt),pe[1].push(ke.cgt_npt),pe[2].push(ke.cpt_ngt),pe[3].push(ke.cpt_npt);for(var Le=Ce.Spd_node_info,Me=Ce.Topkfs_node_info,Ne=0;Ne<C;Ne++)_e[Ne].push(Le[Ne]),ve[Ne].push(Me[Ne]);me.push(Ce[re])}for(var Ee=0;Ee<pe.length;Ee++)ye[Ee]=G(pe[Ee]);for(var Oe=0;Oe<_e.length;Oe++)xe[Oe]=G(_e[Oe]);for(var Pe=0;Pe<ve.length;Pe++)be[Pe]=G(ve[Pe]);ge=G(me);for(var Ie=0;Ie<R.length;Ie++){var je=R[Ie],De=je.CN_consistency;je.Label_consistency=V(De.cgt_ngt,ye[0]),je["Label-Prediction_consistency"]=V(De.cgt_npt,ye[1]),je["Prediction-Label_consistency"]=V(De.cpt_ngt,ye[2]),je.Prediction_consistency=V(De.cpt_npt,ye[3]);for(var Te=je.Spd_node_info,Ae=je.Topkfs_node_info,Ge=0;Ge<C;Ge++)je["Nearest_training_nodes_label_distribution_"+Ge]=V(Te[Ge],xe[Ge]),je["Top-k_most_similar_training_nodes_label_distribution_"+Ge]=V(Ae[Ge],be[Ge]);var Ve=F(Te),He=F(Ae);-1===Ve?(je.SPD_label="Not Sure",je[q]="Not Sure"):(je.SPD_label=""+Ve,je.Ground_Truth_Label===je.SPD_label?je[q]="True":je[q]="False"),-1===He?(je.KFS_label="Not Sure",je[B]="Not Sure"):(je.KFS_label=""+He,je.Ground_Truth_Label===je.KFS_label?je[B]="True":je[B]="False"),je.Confidence=V(je[re],ge)}R.columns=Z,R.default_columns=Y;for(var Fe=Object.keys(ne),Re=0,ze=0;ze<Fe.length;ze++){var We=ne[Fe[ze]],Ke=We.correct_num+We.wrong_num;We.accuracy=Ke>0?We.correct_num/Ke:0,We.total=Ke,Ke>Re&&(Re=Ke)}for(var Ue=0;Ue<Fe.length;Ue++){var Je=ne[Fe[Ue]];Je.max_percentage=Re>0?Je.total/Re:0}return k.length<=0?(console.log("No selected data."),{success:!1}):{success:!0,name:h,PSData:R,accuracy:te/k.length,nodenum:k.length,pie_name:z,graph_additional_info:l.graph_additional_info}}return console.log("Unknown data type : ",_),{success:!1}}},{key:"showPSSettingModal",value:function(){this.props.changePSSettingsModal_visible(!0)}},{key:"render",value:function(){var e=this,t=this.props,n=t.graph_object,a=t.show_mode,i=(t.explained_node,t.onExplainNodeChange,t.onShowModeChange,this.props.width-10),o=this.props.height-60,s=this.constructPSJson(n,a,this.props.checkedList,i,o,this.props.selected_models_list);this.props.changePSJson(s);var l=n.bundle_id;return l!==this.prev_bundle_id&&(this.props.changePSDimensions(s.PSData.default_columns),this.prev_bundle_id=l),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Parallel Sets View",r.createElement("div",{style:{float:"right"}},s.success?r.createElement("div",null,r.createElement("div",null,r.createElement(x.a,{type:"default",size:"small",onClick:function(){e.showPSSettingModal()}},r.createElement(z.a,null)),r.createElement(pt,{CandidatePSDimensions:s.PSData.columns,DefaultPSDimensions:s.PSData.default_columns}),"\xa0\xa0\xa0\xa0","#Nodes: ",r.createElement(ft,{totalNodeNum:s.nodenum}))):r.createElement("div",null))),r.createElement("div",{className:"ViewBox"},r.createElement(Ge.a,{gutter:4},r.createElement(Ge.a,null,s.success?r.createElement(ut,{width:i,height:o,PSJson:s}):r.createElement("div",null)))))}}]),n}(r.Component),vt=Object(W.b)((function(e){return{checkedList:e.InspectCategoryList,K_value:e.K_value,selected_models_list:e.selected_models_list}}),(function(e){return{changePSJson:function(t){return e(function(e){return{type:"PSJSON_CHANGE",PSJson:e}}(t))},changePSSettingsModal_visible:function(t){return e(X(t))},changePSDimensions:function(t){return e(Q(t))}}}))(_t),mt=(n(284),n(327)),yt=(n(148),n(167)),xt=n(29),bt=n(287),wt=n(293),St=(m.a.Option,"#bbb"),Ct=2,kt="2,3",Lt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).point_array=[],r.additional_info={},r.model={},r.mappingGraph=r.mappingGraph.bind(Object(c.a)(r)),r.onSelectedNodeListChange=r.onSelectedNodeListChange.bind(Object(c.a)(r)),r.onShowModeChange=r.onShowModeChange.bind(Object(c.a)(r)),r.handleTitleMouseOut=r.handleTitleMouseOut.bind(Object(c.a)(r)),r.handleTitleMouseMove=r.handleTitleMouseMove.bind(Object(c.a)(r)),r.handleGlyphMouseMove=r.handleGlyphMouseMove.bind(Object(c.a)(r)),r.handleGlyphMouseOut=r.handleGlyphMouseOut.bind(Object(c.a)(r)),r.state={showMode:1},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.renderD3()}},{key:"componentDidUpdate",value:function(e,t){P(e.selectedNodeIdList,this.props.selectedNodeIdList)&&e.dataPackage.mode===this.props.dataPackage.mode&&e.showMode===this.props.showMode&&e.layoutMode===this.props.layoutMode?e.enableLegends===this.props.enableLegends||this.renderInViewLegend():this.renderD3()}},{key:"onSelectedNodeListChange",value:function(e,t,n){this.props.onChangeHighLightNodeIdList(e,t,n)}},{key:"onHoveredNodeListChange",value:function(e,t,n){this.props.onChangeHoveredNodeIdList(e,t,n)}},{key:"hiddenTooltip",value:function(){xt.select("#tooltip_proj").style("opacity",0)}},{key:"handleTitleMouseOut",value:function(e){this.hiddenTooltip()}},{key:"handleGlyphMouseOut",value:function(e){this.hiddenTooltip();var t=this.props.showMode;this.onHoveredNodeListChange([],[],t)}},{key:"constructPathOnNodeList",value:function(e){for(var t="",n=0;n<e.length;n++){var r="M";n>0&&(r="L"),t=t+r+e[n][0]+" "+e[n][1]+" "}return t}},{key:"getArc",value:function(e){return xt.arc().innerRadius(e).outerRadius(2*e)}},{key:"getVariableArc",value:function(e,t){return xt.arc().innerRadius(e).outerRadius(t)}},{key:"getArcConf",value:function(e,t){return xt.arc().innerRadius(e).outerRadius(t+e)}},{key:"getSizeScale",value:function(e){return Math.sqrt(1+Math.log(e))}},{key:"renderGlyphGT3PT",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=this.getArc,l=this.getArcConf,c=this.getSizeScale,d=r-n,u=t.append("circle").attr("class","proj_outer_circle"),h=e.select("circle.proj_outer_circle"),f=u.merge(h),g=a.pie_name,p=g[0],_=g.length+1,v=g.length;f.attr("r",(function(e){var t=o?c(e.data.size):1;return r*i*t*2})).attr("fill",(function(e){return e.data.Color[_]}));for(var m=[],y=0;y<v;y++)m.push({index:y,value:1/v});for(var x=-180/v,b=xt.pie().startAngle(x/180*Math.PI).endAngle((2+x/180)*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),w=b(m),S=[],C=function(n){var a=t.append("path").attr("class","arc_"+n),l=e.select("path.arc_"+n),d=a.merge(l);d.style("fill",(function(e){return e.data.Color[n+1]})).style("stroke","#bbb").style("stroke-width",1).attr("d",(function(e){var t=1;return o&&(t=c(e.data.size)),s(r*i*t)(w[n])})),S.push(d)},k=0;k<v;k++)C(k);for(var L=xt.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value((function(e){return e.value})).sort((function(e,t){return e.index<t.index})),M=[],N=2*r+2,E=1,O=function(n){var r=t.append("path").attr("class","carc_"+n),a=e.select("path.carc_"+n),s=r.merge(a);s.style("fill",(function(e){return 3===n?"#000":4===n?"#fff":void 0})).attr("d",(function(e){var t=[{index:0,value:e.data[p+"_Confidence"]},{index:1,value:1-e.data[p+"_Confidence"]}],r=L(t),a=1;return o&&(a=c(e.data.size)),l(N*i*a,E*i*a)(r[n-3])})),M.push(s)},P=3;P<5;P++)O(P);var I=t.append("circle").attr("class","inner_circle"),j=e.select("circle.inner_circle"),D=I.merge(j);D.attr("r",(function(e){var t=1;return o&&(t=c(e.data.size)),d*i*t})).attr("fill",(function(e){return e.data.Color[0]}))}},{key:"renderLegendGT3PT",value:function(e,t,n,r,a,i){var o=this.constructPathOnNodeList,s=i.pie_name,l=s[0],c=a.legend_x,d=a.legend_y,u=a.legend_scale,h=a.legend_Color,f=a.legend_conf,g=l+"_Confidence",p=s.length,_=p+1,v={data:{Color:h,Data_id:t}};v.data[g]=f;var m=a.legend_text_setting,y=2*r+2,x=e.selectAll("g.legend_pie").data([v],(function(e){return e.data.Data_id}));x.exit().remove();var b=x.enter().append("g").attr("class","legend_pie").attr("transform","translate("+c+","+d+")");this.renderGlyphGT3PT(x,b,n,r,i,u);for(var w=0;w<p;w++){var S=[1.5*u*r*Math.sin(120*w/180*Math.PI),1.5*u*r*-Math.cos(120*w/180*Math.PI)],C=[1.5*u*r*Math.sin(120*w/180*Math.PI),4.5*u*r*-Math.cos(120*w/180*Math.PI)+m[w+1].y_offset];1===w&&(C=[4.5*u*r*Math.sin(120*w/180*Math.PI),4.5*u*r*-Math.cos(120*w/180*Math.PI)+m[w+1].y_offset]);var k=[4.5*u*r*Math.sin(60/180*Math.PI),4.5*u*r*-Math.cos(120*w/180*Math.PI)+m[w+1].y_offset];b.append("path").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("d",o([S,C,k])).attr("fill","none"),b.append("text").attr("x",k[0]).attr("y",k[1]).attr("text-anchor",m[w+1]["text-anchor"]).attr("dominant-baseline",m[w+1]["dominant-baseline"]).text(m[w+1].text)}var L=4.5*u*r*Math.sin(60/180*Math.PI),M=4.5*u*r*-Math.cos(60/180*Math.PI)+m[0].y_offset;b.append("line").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("x1",0).attr("y1",0).attr("x2",L).attr("y2",M),b.append("text").attr("x",L).attr("y",M).attr("text-anchor",m[0]["text-anchor"]).attr("dominant-baseline",m[0]["dominant-baseline"]).text(m[0].text),L=3.5*u*r*Math.sin(.5*Math.PI),M=3.5*u*r*-Math.cos(.5*Math.PI)+m[_].y_offset,b.append("line").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("x1",y*u+.5*u).attr("y1",0).attr("x2",L).attr("y2",M),b.append("text").attr("x",L).attr("y",M).attr("text-anchor",m[_]["text-anchor"]).attr("dominant-baseline",m[_]["dominant-baseline"]).text(m[_].text)}},{key:"renderGlyphDEGCN",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.getSizeScale,s=r.max_degree;function l(e,t,n,r){return[e*r*Math.sin(t/n*Math.PI*2),-e*r*Math.cos(t/n*Math.PI*2)]}function c(e,t){for(var n=[],r=e.length,a=0;a<r;a++)n.push(l(e[a],a,r,t));for(var i="",o=0;o<n.length;o++)i=i+n[o][0]+","+n[o][1]+" ";return i}function d(e){var t=[],r=e.data.Real_Degree;t.push(r/s),t.push(e.data.CN_consistency.cgt_ngt),t.push(e.data.CN_consistency.cgt_npt),t.push(e.data.CN_consistency.cpt_ngt),t.push(e.data.CN_consistency.cpt_npt);var l=i?o(e.data.size):1;return c(t,2*n*a*l)}var u=t.append("circle").attr("class","proj_outer_circle"),h=e.select("circle.proj_outer_circle"),f=u.merge(h);f.attr("r",(function(e){var t=i?o(e.data.size):1;return 2*n*a*t})).attr("fill",(function(e){return e.data.Color[e.data.Color.length-1]}));for(var g=function(r){_=t.append("line").attr("class","background_line_"+r),v=e.select("line.background_line_"+r),_.merge(v).attr("x1",0).attr("y1",0).attr("x2",(function(e){var t=i?o(e.data.size):1;return l(1,r,5,2*n*a*t)[0]})).attr("y2",(function(e){var t=i?o(e.data.size):1;return l(1,r,5,2*n*a*t)[1]})).style("stroke","#bbb").style("stroke-width",2).style("stroke-dasharray","1,1")},p=0;p<5;p++){var _,v;g(p)}var m=t.append("polygon").attr("class","sp_polygon"),y=e.select("polygon.sp_polygon"),x=m.merge(y);x.attr("points",d).style("fill",(function(e){return e.data.Color[0]}))}},{key:"renderLegendDEGCN",value:function(e,t,n,r,a){var i=this.constructPathOnNodeList,o=a.legend_x,s=a.legend_y,l=a.legend_scale,c=a.legend_Color,d=a.legend_text_setting,u={data:{Color:c,Data_id:t,Real_Degree:a.legend_degree,CN_consistency:a.legend_CN_consistency}},h=e.selectAll("g.legend_pie").data([u],(function(e){return e.data.Data_id}));h.exit().remove();var f=h.enter().append("g").attr("class","legend_pie").attr("transform","translate("+o+","+s+")");this.renderGlyphDEGCN(h,f,n,r,l);for(var g=0;g<5;g++){var p=[2*l*n*Math.sin(72*g/180*Math.PI),2*l*n*-Math.cos(72*g/180*Math.PI)],_=[2*l*n*Math.sin(72*g/180*Math.PI),4.5*l*n*-Math.cos(72*g/180*Math.PI)+d[g].y_offset],v=[4.5*l*n*Math.sin(.4*Math.PI),4.5*l*n*-Math.cos(72*g/180*Math.PI)+d[g].y_offset];f.append("path").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("d",i([p,_,v])).attr("fill","none"),f.append("text").attr("x",v[0]).attr("y",v[1]).attr("text-anchor",d[g]["text-anchor"]).attr("dominant-baseline",d[g]["dominant-baseline"]).text(d[g].text)}}},{key:"renderGlyphP1SPD",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=n*r/2*i,l=n*r*i,c=this.getSizeScale,d=this.constructPathOnNodeList,u=t.append("rect").attr("class","gnn_outer_rects"),h=e.select("rect.gnn_outer_rects"),f=u.merge(h);f.attr("x",(function(e){var t=o?c(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return(o?c(e.data.size):1)*s*2})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return e.data.Color[e.data.Color.length-1]}));var g=.25,p=t.append("rect").attr("class","gnnrect"),_=e.select("rect.gnnrect"),v=p.merge(_);v.attr("x",(function(e){var t=o?c(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return(o?c(e.data.size):1)*s-g})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return e.data.Color[1]}));for(var m=function(n){var r=t.append("rect").attr("class","rect_"+n),a=e.select("rect.rect_"+n);r.merge(a).attr("x",(function(e){return g})).attr("y",(function(e){for(var t=o?c(e.data.size):1,r=0,a=0;a<n;a++)r+=e.data.Spd_node_info[a];return t*(r*l-l/2)})).attr("width",(function(e){var t=o?c(e.data.size):1;return s*t-g})).attr("height",(function(e){return(o?c(e.data.size):1)*l*e.data.Spd_node_info[n]})).attr("fill",(function(e){return L(n,2)}))},y=0;y<a;y++)m(y);var x=t.append("path").attr("class","line_distance"),b=e.select("path.line_distance"),w=x.merge(b);w.attr("stroke","#000").attr("stroke-width","2").attr("d",(function(e){var t=e.data.Transformed_Distance,n=o?c(e.data.size):1,r=-s*n,a=-l/2*n-4;return t>1?t=1:t<0&&(t=0),d([[r,a],[r+2*s*n*t,a]])})).attr("fill","none");var S=t.append("rect").attr("class","gnngap"),C=e.select("rect.gnngap"),k=S.merge(C);k.attr("x",(function(e){return-g})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return 2*g})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return"#bbb"}))}},{key:"renderLegendP1SPD",value:function(e,t,n,r){var a=this.constructPathOnNodeList,i=r.legend_x,o=r.legend_y,s=r.legend_scale,l=r.legend_spd_info,c=r.legend_transformed_distance,d=l.length,u=r.legend_Color,h=r.legend_text_setting,f={data:{Color:u,Data_id:t,Spd_node_info:l,Transformed_Distance:c}},g=e.selectAll("g.legend_pie").data([f],(function(e){return e.data.Data_id}));g.exit().remove();var p=g.enter().append("g").attr("class","legend_pie").attr("transform","translate("+i+","+o+")");this.renderGlyphP1SPD(g,p,n,3,d,s);for(var _=3*n/2*s,v=3*n*s,m=0;m<3;m++){var y=[],x=[];if(0===m){x=[[-.5*_,0],[-1.3*_,0],[-1.3*_,-1.5*v],y=[1.5*_,-1.5*v]]}else 1===m?x=[[.5*_,0],[.5*_,.1*v],y=[1.5*_,.1*v]]:2===m&&(x=[[0,-.5*v-1],[0,-.5*v-4],y=[1.5*_,-.5*v-4]]);p.append("path").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("d",a(x)).attr("fill","none");var b=p.append("text").attr("x",y[0]).attr("y",y[1]).attr("text-anchor",h[m]["text-anchor"]).attr("dominant-baseline",h[m]["dominant-baseline"]).text(h[m].text);this.wrapLines(b)}}},{key:"renderGlyphP1KFS",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=n*r/2*i,l=n*r*i,c=this.getSizeScale,d=t.append("rect").attr("class","gnn_outer_rects"),u=e.select("rect.gnn_outer_rects"),h=d.merge(u);h.attr("x",(function(e){var t=o?c(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return(o?c(e.data.size):1)*s*2})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return e.data.Color[e.data.Color.length-1]}));var f=t.append("rect").attr("class","gnnrect"),g=e.select("rect.gnnrect"),p=f.merge(g);p.attr("x",(function(e){var t=o?c(e.data.size):1;return-s*t})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return(o?c(e.data.size):1)*s})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return e.data.Color[1]}));for(var _=function(n){var r=t.append("rect").attr("class","rect_"+n),a=e.select("rect.rect_"+n);r.merge(a).attr("x",(function(e){return 0})).attr("y",(function(e){for(var t=o?c(e.data.size):1,r=0,a=0;a<n;a++)r+=e.data.Topkfs_node_info[a];return t*(r*l-l/2)})).attr("width",(function(e){var t=o?c(e.data.size):1;return s*t})).attr("height",(function(e){return(o?c(e.data.size):1)*l*e.data.Topkfs_node_info[n]})).attr("fill",(function(e){return L(n,2)}))},v=0;v<a;v++)_(v);var m=.25,y=t.append("rect").attr("class","gnngap"),x=e.select("rect.gnngap"),b=y.merge(x);b.attr("x",(function(e){return-m})).attr("y",(function(e){var t=o?c(e.data.size):1;return-l/2*t})).attr("width",(function(e){return 2*m})).attr("height",(function(e){var t=o?c(e.data.size):1;return l*t})).attr("fill",(function(e){return"#bbb"}))}},{key:"wrapLines",value:function(e){var t,n=e.text().split("\n").reverse(),r=0,a=e.node().getBoundingClientRect().height,i=+e.attr("x"),o=+e.attr("y");for(e.text(null);t=n.pop();)e.append("tspan").attr("x",i).attr("y",r*a+o).text(t),r+=1}},{key:"renderLegendP1KFS",value:function(e,t,n,r){var a=this.constructPathOnNodeList,i=r.legend_x,o=r.legend_y,s=r.legend_scale,l=r.legend_Color,c=r.legend_Topkfs_node_info,d=c.length,u={data:{Color:l,Data_id:t,Topkfs_nodes:r.legend_Topkfs_nodes,Topkfs_node_info:c}},h=r.legend_text_setting,f=e.selectAll("g.legend_pie").data([u],(function(e){return e.data.Data_id}));f.exit().remove();var g=f.enter().append("g").attr("class","legend_pie").attr("transform","translate("+i+","+o+")");this.renderGlyphP1KFS(f,g,n,3,d,s);var p=3*n/2*s,_=3*n*s;for(var v=0;v<2;v++){var m=[],y=[],x=[];0===v?(m=[-.5*p,0],y=[-.5*p,-_],x=[1.5*p,-_]):1===v&&(m=[.5*p,0],y=[.5*p,0],x=[1.5*p,0]),g.append("path").attr("stroke",St).attr("stroke-width",Ct).style("stroke-dasharray",kt).attr("d",a([m,y,x])).attr("fill","none");var b=g.append("text").attr("x",x[0]).attr("y",x[1]).attr("text-anchor",h[v]["text-anchor"]).attr("dominant-baseline",h[v]["dominant-baseline"]).text(h[v].text);this.wrapLines(b)}}},{key:"renderColorLegend",value:function(e,t){console.log("Rendering Color Legend in Projection View...",e,t);var n=e.selectAll("g.legend_row_color").data(t,(function(e,t){return e.text+"_"+t+"_"+e.color})),r=n.enter().append("g").attr("class","legend_row_color").attr("transform",(function(e,t){return"translate(10,"+(10+20*t)+")"}));r.append("circle").attr("r",5).attr("fill",(function(e){return e.color})),r.append("text").attr("x",10).attr("y",5).text((function(e){return e.text})),n.exit().remove()}},{key:"renderLegend",value:function(e){var t=e.configuration,n=e.tooltip_svg,r=e.additional_info,a=e.e,i=e.showMode,o=e.legendMode,s=t.radius,l=n.append("g").attr("width",100).attr("height",70).attr("transform","translate(0,0)");a.refresh_number=a.refresh_number+1;var c=r.pie_name,d=c[0];if(1===i){var u=30,h=50;2===o&&(u=30,h=50);for(var f=[{text:"Label","text-anchor":"begin","dominant-baseline":"central",y_offset:1}],g=[-7.5,0,19],p=0;p<c.length;p++)f.push({text:c[p],"text-anchor":"begin","dominant-baseline":"central",y_offset:g[p]});f.push({text:"Conf.","text-anchor":"begin","dominant-baseline":"central",y_offset:0});var _={legend_x:u,legend_y:h,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_conf:.66,legend_text_setting:f};if(this.renderLegendGT3PT(l,a.refresh_number,.3,s,_,r),2===o){var v=e.color_svg,m=e.colorLegend;this.renderColorLegend(v,m)}}else if(2===i){var y={legend_x:30,legend_y:45,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:"DEG","text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"L. - p. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"P. - l. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:18},{text:"Pred. cons.","text-anchor":"begin","dominant-baseline":"central",y_offset:-22}],legend_degree:8,legend_CN_consistency:{cgt_ngt:.8,cgt_npt:.8,cpt_ngt:.8,cpt_npt:.8}};this.renderLegendDEGCN(l,a.refresh_number,s,{max_degree:10},y)}else if(3===i){var x=20,b=40;2===o&&(x=30,b=50);var w={legend_x:x,legend_y:b,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:d,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Near. train. \n label dist.","text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Closeness","text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_spd_info:[0,.7,.2,.1],legend_transformed_distance:.5};this.renderLegendP1SPD(l,a.refresh_number,s,w)}else if(4===i){var S=20,C=30;2===o&&(S=30,C=50);var k={legend_x:S,legend_y:C,legend_scale:2,legend_Color:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#fff"],legend_text_setting:[{text:d,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Top-k. feat. \n train. l. dist.","text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_Topkfs_nodes:[{anchor_label:0,anchor_similarity:1},{anchor_label:1,anchor_similarity:.9},{anchor_label:2,anchor_similarity:.8},{anchor_label:3,anchor_similarity:.7},{anchor_label:4,anchor_similarity:.6}],legend_Topkfs_node_info:[.2,.2,.2,.2,.2]};this.renderLegendP1KFS(l,a.refresh_number,s,k)}}},{key:"handleTitleMouseMove",value:function(e,t,n){var r;r=[xt.event.pageX,xt.event.pageY];var a=100,i=100,o=this.props.showMode;1===o?(a=190,i=100):2===o?(a=300,i=100):3===o?(a=210,i=70):4===o&&(a=280,i=60);var s=xt.select("#tooltip_proj").style("opacity",.95).style("top",r[1]-i+"px").style("left",r[0]+10+"px");s.selectAll("*").remove();var l={configuration:t,tooltip_svg:s.append("svg").attr("width",a).attr("height",i),additional_info:n,e:e,showMode:o,legendMode:1};this.renderLegend(l)}},{key:"handleGlyphMouseMove",value:function(e,t,n){var r,a=xt.select(e).data()[0].data;r=[xt.event.pageX,xt.event.pageY];var i=100,o=100,s=this.props.showMode,l="",c="";if(1===s)i=215,o=100;else if(2===s)i=330,o=100;else if(3===s){i=215,o=70;for(var d=a.Spd_node_info,u=0;u<d.length;u++)0===d[u]||(l=l+"\nLabel "+u+":"+d[u].toFixed(2),o+=20)}else if(4===s){i=280,o=60;for(var h=a.Topkfs_node_info,f=0;f<h.length;f++)0===h[f]||(c=c+"\nLabel "+f+":"+h[f].toFixed(2),o+=20)}var g=r[1]-(o+=20),p=r[0]+10;4===s&&(p=r[0]-10-i);var _=xt.select("#tooltip_proj").style("opacity",.95).style("top",g+"px").style("left",p+"px");_.selectAll("*").remove();var v=_.append("svg").attr("width",i).attr("height",o),m=t.radius,y=v,x="";x=1===a.size?"The id of this node:"+a.raw_id_list[0]:"The size of this cluster:"+a.size,y.append("text").attr("x",10).attr("y",5).attr("text-anchor","start").attr("dominant-baseline","hanging").text(x);var b=y.append("g").attr("width",100).attr("height",70).attr("transform","translate(0,20)");e.refresh_number=e.refresh_number+1;var w=n.pie_name,S=w[0];if(1===s){for(var C=a.Color,k=a[S+"_Confidence"],L=[{text:"Label:"+a.Ground_Truth_Label,"text-anchor":"begin","dominant-baseline":"central",y_offset:1}],M=[-7.5,0,19],N=0;N<w.length;N++)L.push({text:w[N]+":"+a[w[N]+"_Prediction_Label"],"text-anchor":"begin","dominant-baseline":"central",y_offset:M[N]});L.push({text:"Confidence:"+a[S+"_Confidence"].toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0});var E={legend_x:30,legend_y:50,legend_scale:2,legend_Color:C,legend_conf:k,legend_text_setting:L};this.renderLegendGT3PT(b,e.refresh_number,.3,m,E,n)}else if(2===s){var O={legend_x:30,legend_y:45,legend_scale:2,legend_Color:a.Color,legend_degree:a.Real_Degree,legend_CN_consistency:a.CN_consistency,legend_text_setting:[{text:"DEG/MAX_DEG:"+a.Real_Degree.toFixed(2)+"/"+n.max_degree,"text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label consistency:"+a.CN_consistency.cgt_ngt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:16},{text:"Label - prediction consistency:"+a.CN_consistency.cgt_npt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Prediction - label consistency:"+a.CN_consistency.cpt_ngt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:18},{text:"Prediction consistency:"+a.CN_consistency.cpt_npt.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:-22}]};this.renderLegendDEGCN(b,e.refresh_number,m,n,O)}else if(3===s){var P=a.Spd_node_info,I=a.Color,j=a.Transformed_Distance,D={legend_x:20,legend_y:40,legend_scale:2,legend_Color:I,legend_text_setting:[{text:S+":"+a[S+"_Prediction_Label"],"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Nearest training nodes \n label distribution"+l,"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Closeness:"+j.toFixed(2),"text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_spd_info:P,legend_transformed_distance:j};this.renderLegendP1SPD(b,e.refresh_number,m,D)}else if(4===s){var T=a.Color,A=a.Topkfs_nodes,G=a.Topkfs_node_info,V={legend_x:20,legend_y:30,legend_scale:2,legend_Color:T,legend_text_setting:[{text:S+":"+a[S+"_Prediction_Label"],"text-anchor":"begin","dominant-baseline":"central",y_offset:0},{text:"Top-k similar features \n training nodes label distribution"+c,"text-anchor":"begin","dominant-baseline":"central",y_offset:0}],legend_Topkfs_nodes:A,legend_Topkfs_node_info:G};this.renderLegendP1KFS(b,e.refresh_number,m,V)}var H=a.Data_id,F=a.raw_id_list,R=[H];this.onHoveredNodeListChange(F,R,s)}},{key:"renderInViewLegend",value:function(){var e=this.props.enableLegends,t=this.props.showMode,n={radius:3.5,showlabel:!1,width:this.props.width,height:this.props.height},r=this.additional_info,a=this.props.graph_additional_info,i=n.width,o=n.height;o<1&&(o=1);var s=150;s=Math.min(i,s),xt.select("#ScatterPlot_sub_legend"+this.props.id).remove(),xt.select("#ScatterPlot_sub_colorlegend"+this.props.id).remove();var l=xt.select("#TopSVGChart_ScatterPlot_Legend_"+this.props.id);if(e){console.log("Enable projection view legends rendering...");var c=o-110,d=l.append("g").attr("id","ScatterPlot_sub_legend"+this.props.id).attr("transform",(function(){return"translate(10,"+c+")"})).attr("width",s-10).attr("height",100);d.append("rect").attr("x",0).attr("y",0).attr("width",s-10).attr("height",100).attr("fill","white").attr("stroke","#bbb").attr("stroke-width",2).attr("fill-opacity",.9).attr("stroke-opacity",.5);var u={configuration:n,tooltip_svg:d,additional_info:r,e:this,showMode:t,legendMode:2};if(1===t){var h=function(){var e=a,t=e.num_class,n=[];if(Object.keys(e).indexOf("idx_to_class")>=0)for(var r=e.idx_to_class,i=0;i<t;i++)n.push({text:i+":"+r[i],color:L(i,2)});else for(var o=0;o<t;o++)n.push({text:o,color:L(o,2)});return n}(),f=0;h.forEach((function(e){var t=""+e.text;t.length>f&&(f=t.length)}));var g=8*f+24,p=20*h.length,_=c-10-p,v=l.append("g").attr("id","ScatterPlot_sub_colorlegend"+this.props.id).attr("width",g).attr("height",p).attr("transform","translate(10,"+_+")"),m=v.selectAll("rect").data([0]);m.enter().append("rect").merge(m).attr("x",0).attr("y",0).attr("width",g).attr("height",p).attr("fill","#fff").attr("opacity",.8).attr("stroke","#bbb").attr("stroke-width",1).attr("rx",3).attr("ry",3),u.color_svg=v,u.colorLegend=h}this.renderLegend(u)}else console.log("Not Enable projection view legends...")}},{key:"mappingGraph",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getSizeScale;null===e?e=this.point_array:this.point_array=e,null===t?t=this.additional_info:this.additional_info=t,null===n?n=this.model:this.model=n;var a=this.props.showMode,i=this.props.layoutMode;if(xt.select("#ScatterPlot_sub_"+this.props.id).remove(),xt.select("#ScatterPlot_Legend_sub_"+this.props.id).remove(),xt.select("#ScatterPlot_sub_colorlegend"+this.props.id).remove(),!(e.length<=0)){var o=e.length,s={radius:3.5,showlabel:!0,width:this.props.width,height:this.props.height};o>=100&&(s={radius:3.5,showlabel:!1,width:this.props.width,height:this.props.height});var l=xt.select("#TopSVGChart_ScatterPlot_"+this.props.id),c=s.width,d=s.height;d<1&&(d=1);this.handleTitleMouseMove;var u=l.append("g").attr("id","ScatterPlot_sub_"+this.props.id);u.append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",d).attr("fill","white").attr("stroke","#bbb").attr("stroke-width",2).attr("fill-opacity",.1).attr("stroke-opacity",.5);var h=xt.select("#TopSVGChart_ScatterPlot_Legend_"+this.props.id),f=h.append("g").attr("id","ScatterPlot_Legend_sub_"+this.props.id);f.append("text").attr("x",c/2).attr("y",-4).attr("text-anchor","middle").text(this.props.name),this.renderInViewLegend();var g=u.append("g").attr("class","main_drawings");g.attr("width",c).attr("height",d);var p="clip_"+this.props.id,_="url(#"+p+")";g.append("defs").append("clipPath").attr("id",p).append("rect").attr("x",0).attr("y",0).attr("width",c).attr("height",d),g.attr("clip-path",_);var v=g.selectAll("g.nodes").data(e,(function(e,t){return""+e.data.Data_id})),m=v.enter().append("g").attr("class","nodes"),y=v.merge(m).attr("opacity",.9);v.exit().remove();var x=this.handleGlyphMouseMove;y.on("mousemove",H).on("mouseout",this.handleGlyphMouseOut);var b=3,w=.3,S=4.5,C=!0;if(1===a)this.renderGlyphGT3PT(v,m,w,b,t,1,C);else if(2===a)this.renderGlyphDEGCN(v,m,b,t,1,C);else if(3===a){var k=e[0].data.Spd_node_info.length;this.renderGlyphP1SPD(v,m,b,S,k,1,C)}else if(4===a){k=e[0].data.Topkfs_node_info.length;this.renderGlyphP1KFS(v,m,b,S,k,1,C)}var L=40,M=xt.scaleLinear().range([L,c-L]),N=xt.scaleLinear().range([L,d-L]),E=2*b+2*w;2===a||(1===a?E+=3:3!==a&&4!==a||(E=b*S/3*2+w*S/3*2));var O=this.props.renderLines,P=!0;if(o>=2){var I=.1,j=.005;1===i?(I=.1,j=.005):2===i&&(I=.2,j=.005);xt.forceSimulation(e).alphaDecay(j).alpha(I).force("tsne",(function(t){var r;n.step(),1===i?r=n.getSolution():2===i&&(r=n.getEmbedding()),M.domain(xt.extent(r.map((function(e){return e[0]})))),N.domain(xt.extent(r.map((function(e){return e[1]})))),e.forEach((function(e,n){e.x+=t*(M(r[n][0])-e.x),e.y+=t*(N(r[n][1])-e.y)}))})).force("collide",xt.forceCollide().radius((function(e){var t=1;return C&&(t=r(e.data.size)),t*E}))).on("tick",F)}else F();if(P){var D=function(){V.items().classed("lasso_not_possible",!0).classed("lasso_unselected",!1).classed("lasso_selected",!1)},T=function(){V.possibleItems().classed("lasso_not_possible",!1).classed("lasso_unselected",!1).classed("lasso_possible",!0),V.notPossibleItems().classed("lasso_not_possible",!0).classed("lasso_unselected",!1).classed("lasso_possible",!1)},A=this.onSelectedNodeListChange,G=function(){V.items().classed("lasso_not_possible",!1).classed("lasso_possible",!1),V.selectedItems().classed("lasso_selected",!0);var e,t=V.selectedItems().data();V.notSelectedItems().data().forEach((function(e){e.selected=!1})),V.selectedItems().data().forEach((function(e){e.selected=!0})),0===t.length?(e=V.notSelectedItems().data(),V.notSelectedItems().classed("lasso_unselected",!1)):(e=t,V.notSelectedItems().classed("lasso_unselected",!0)),console.log(e);var n=[];e.forEach((function(e){n=n.concat(e.data.raw_id_list)}));var r=t.map((function(e){return e.data.Data_id}));A(n,r,a)},V=bt.default().closePathSelect(!0).closePathDistance(100).items(y).targetArea(l).on("start",D).on("draw",T).on("end",G);l.call(V)}this.props.updateSingleHighlightNodeStatus(a)}function H(){x(this,s,t)}function F(){m.merge(v).attr("transform",(function(e){return"translate("+e.x+","+e.y+")"})),P&&O()}}},{key:"renderD3",value:function(){var e,t=this.props.dataPackage,n=t.matrix,r=t.selectedNodeList,a=this.props.dataPackage.additional_info,i=this.props.layoutMode;if(1===i)(e=new wt.tSNE({dim:2,perplexity:30})).initDataDist(n);else if(2===i){e=new yt.UMAP({nComponents:2,distanceFn:function(e,t){var r=e[0],a=t[0];return n[r][a]},nNeighbors:Math.min(15,n.length-1)});for(var o=[],s=0;s<n.length;s++)o.push([s]);o.length>=2&&e.initializeFit(o)}var l=this.props.width/2,c=this.props.height/2,d=[];r.forEach((function(e,t){d.push({data:e,x:l,y:c})})),(0,this.mappingGraph)(d,a,e)}},{key:"onShowModeChange",value:function(e){this.setState({showMode:e})}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,a=e.width,i=e.height;return r.createElement("g",null,r.createElement("g",{id:"TopSVGChart_ScatterPlot_"+this.props.id,transform:"translate("+t+","+n+")",width:a,height:i}),r.createElement("g",{id:"TopSVGChart_ScatterPlot_Legend_"+this.props.id,transform:"translate("+t+","+n+")",width:a,height:i}))}}]),n}(r.Component),Mt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.createElement(b.a,null," ",E(this.props.ProjectionViewSelectedNodes,this.props.ProjectionViewTotalNodeNum))}}]),n}(r.Component),Nt=Object(W.b)((function(e){return{ProjectionViewSelectedNodes:e.ProjectionViewSelectedNodes,ProjectionViewTotalNodeNum:e.ProjectionViewTotalNodeNum}}),(function(e){return{}}))(Mt),Et=function(){function e(t){Object(s.a)(this,e),this.distance=function(e,t){return 0},this.linkage="single",this.distMatrix=null,this.showMode=1,this.vector_type=[],this.showMode=t}return Object(l.a)(e,[{key:"setlinkage",value:function(e){this.linkage=e}},{key:"setDistMatrix",value:function(e){this.distMatrix=e.map((function(e){return e.slice(0)}))}},{key:"setDistance",value:function(e){this.distance=e}},{key:"cluster",value:function(e){var t,n,r,a,i,o,s,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,c=e.length,d=[],u=[],h=[],f=0,g=[];if(null===this.distMatrix)for(this.distMatrix=[],o=-1;++o<c;)for(d[o]=0,this.distMatrix[o]=[],s=-1;++s<c;)this.distMatrix[o][s]=o===s?1/0:this.distance(e[o],e[s]),this.distMatrix[o][d[o]]>this.distMatrix[o][s]&&(d[o]=s);else{if(this.distMatrix.length<c||this.distMatrix[0].length<c)throw{error:"Provided distance matrix length "+this.distMatrix.length+" instead of "+c};for(o=-1;++o<c;)for(d[o]=0,s=-1;++s<c;)o===s&&(this.distMatrix[o][s]=1/0),this.distMatrix[o][d[o]]>this.distMatrix[o][s]&&(d[o]=s)}for(o=-1;++o<c;)o!=f&&console.log("i = %d, id = %d",o,f),h.push([]),g.push(!0),h[o].push({left:null,right:null,dist:0,centroid:e[o],id:f,size:1,depth:0,id_list:[f]}),f++,u[o]=1;for(i=0;i<c-1;i++){for(t=0,o=0;o<c;o++)this.distMatrix[o][d[o]]<this.distMatrix[t][d[t]]&&(t=o);if(n=d[t],r=h[t][0],a=h[n][0],this.distMatrix[t][n]>l)break;var p={left:r,right:a,dist:this.distMatrix[t][n],centroid:this.calculateCentroid(r.size,r.centroid,a.size,a.centroid),id:f++,size:r.size+a.size,depth:1+Math.max(r.depth,a.depth),id_list:r.id_list.concat(a.id_list)};for(h[t].splice(0,0,p),u[t]+=u[n],s=0;s<c;s++)switch(this.linkage){case"single":this.distMatrix[t][s]>this.distMatrix[n][s]&&(this.distMatrix[s][t]=this.distMatrix[t][s]=this.distMatrix[n][s]);break;case"complete":this.distMatrix[t][s]<this.distMatrix[n][s]&&(this.distMatrix[s][t]=this.distMatrix[t][s]=this.distMatrix[n][s]);break;case"average":this.distMatrix[s][t]=this.distMatrix[t][s]=(u[t]*this.distMatrix[t][s]+u[n]*this.distMatrix[n][s])/(u[t]+u[s])}for(this.distMatrix[t][t]=1/0,g[n]=!1,o=0;o<c;o++)this.distMatrix[o][n]=this.distMatrix[n][o]=1/0;for(s=0;s<c;s++)d[s]==n&&(d[s]=t),this.distMatrix[t][s]<this.distMatrix[t][d[t]]&&(d[t]=s);p}for(var _=[],v=0;v<g.length;v++)!0===g[v]&&_.push(h[v][0]);return _}},{key:"calculateCentroid",value:function(e,t,n,r){for(var a=[],i=e+n,o=t.length,s=-1;++s<o;)a[s]=(e*t[s]+n*r[s])/i;return a}}]),e}(),Ot=n(29),Pt=function(){function e(){Object(s.a)(this,e),this.CacheDataPackage={},this.filters={},this.PCPJson={},this.pie_name=[],this.selectedNodeList=[],this.initialize_flag=!1,this.cluster_selectedNodeIdIndex=[],this.cluster_highlightNodeIdDict={},this.detail_highlightNodeIdList=[],this.cluster_hoveredNodeIdDict={},this.detail_hoveredNodeIdList=[],this.cluster_rawHoveredNodeIdList=[],this.detail_rawHoveredNodeIdList=[],this.cluster_renderedLinesList=[],this.detail_renderedLinesList=[],this.cluster_hoveredLinesList=[],this.detail_hoveredLinesList=[],this.cluster_rawHighlightNodeIdList=[],this.detail_rawHighlightNodeIdList=[],this.aggregationMode=1,this.getDistance=this.getDistance.bind(this),this.initialize=this.initialize.bind(this),this.checkinitialize=this.checkinitialize.bind(this),this.reset=this.reset.bind(this),this.getDataPackage=this.getDataPackage.bind(this),this.computeDistance=this.computeDistance.bind(this),this.computeDistanceMatrix=this.computeDistanceMatrix.bind(this),this.updateHighlightNodeIdList=this.updateHighlightNodeIdList.bind(this)}return Object(l.a)(e,[{key:"updateAggregationMode",value:function(e){this.aggregationMode=e}},{key:"getAggregationMode",value:function(){return this.aggregationMode}},{key:"getRawHighlightNodeIdList",value:function(){return 1===this.aggregationMode?this.cluster_rawHighlightNodeIdList:2===this.aggregationMode?this.detail_rawHighlightNodeIdList:void 0}},{key:"updateNodeStatistic",value:function(e,t){if(1===this.aggregationMode){var n=this.cluster_rawHighlightNodeIdList.length,r=this.selectedNodeList.length;e(n),t(r)}else if(2===this.aggregationMode){var a=this.cluster_rawHighlightNodeIdList.length;0===a&&(a=this.selectedNodeList.length),e(this.detail_rawHighlightNodeIdList.length),t(a)}}},{key:"calculateHighlightNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1===this.aggregationMode){for(var n={},r={},a={},i=1;i<=4;i++)n[""+i]=this.getDataPackage(i,1),r[""+i]=n[""+i].invertedIndex,a[""+i]=[];for(var o=n[""+t].selectedNodeList,s=[],l=0;l<e.length;l++){var c=o[e[l]].id_list;s=s.concat(c)}for(var d={},u=0;u<s.length;u++){for(var h=s[u],f={size:1},g="LINE_",p=1;p<=4;p++){var _=r[""+p][h];f[""+p]=_,g=g+_+"_"}f.name=g,Object.keys(d).indexOf(g)>=0?d[g].size=d[g].size+1:d[g]=f}for(var v=Object.keys(d).map((function(e){return d[e]})),m=0;m<v.length;m++)for(var y=1;y<=4;y++){var x=v[m][""+y];a[""+y].indexOf(x)>=0||a[""+y].push(x)}this.cluster_selectedNodeIdIndex=s,this.cluster_highlightNodeIdDict=a,this.cluster_renderedLinesList=v,console.log("cluster_highlightNodeIdDict, renderedLinesList, showMode, selectedNodeIdList",this.cluster_highlightNodeIdDict,this.cluster_renderedLinesList,t,s)}else if(2===this.aggregationMode){this.detail_highlightNodeIdList=e;for(var b=[],w=0;w<e.length;w++){for(var S={size:1},C="LINE_",k=1;k<=4;k++)S[""+k]=e[w],C=C+e[w]+"_";S.name=C,b.push(S)}this.detail_renderedLinesList=b,console.log("detail_highlightNodeIdList, renderedLinesList",this.detail_highlightNodeIdList,this.detail_renderedLinesList)}}},{key:"updateFullHighlightStatus",value:function(){for(var e=1;e<=4;e++)this.updateSingleHighlightStatus(e)}},{key:"updateSingleHighlightStatus",value:function(e){1===this.aggregationMode?(this.cluster_highlightNodeIdDict[""+e]||(this.cluster_highlightNodeIdDict[""+e]=[]),this.updateHighlightStatus(this.cluster_highlightNodeIdDict[""+e],e)):2===this.aggregationMode&&this.updateHighlightStatus(this.detail_highlightNodeIdList,e)}},{key:"updateHighlightNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];1===this.aggregationMode?(this.cluster_rawHighlightNodeIdList=n,this.detail_rawHighlightNodeIdList=[],this.detail_highlightNodeIdList=[],this.detail_renderedLinesList=[]):2===this.aggregationMode&&(this.detail_rawHighlightNodeIdList=n),this.calculateHighlightNodeIdList(e,t),this.updateFullHighlightStatus()}},{key:"updateHoveredNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];1===this.aggregationMode?(this.cluster_rawHoveredNodeIdList=n,this.detail_rawHoveredNodeIdList=[],this.detail_hoveredNodeIdList=[]):2===this.aggregationMode&&(this.detail_rawHoveredNodeIdList=n),this.calculateHoveredNodeIdList(e,t),this.updateFullHoveredStatus()}},{key:"calculateHoveredNodeIdList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1===this.aggregationMode){for(var n={},r={},a={},i=1;i<=4;i++)n[""+i]=this.getDataPackage(i,1),r[""+i]=n[""+i].invertedIndex,a[""+i]=[];for(var o=n[""+t].selectedNodeList,s=[],l=0;l<e.length;l++){var c=o[e[l]].id_list;s=s.concat(c)}for(var d={},u=0;u<s.length;u++){for(var h=s[u],f={size:1},g="LINE_",p=1;p<=4;p++){var _=r[""+p][h];f[""+p]=_,g=g+_+"_"}f.name=g,Object.keys(d).indexOf(g)>=0?d[g].size=d[g].size+1:d[g]=f}for(var v=Object.keys(d).map((function(e){return d[e]})),m=0;m<v.length;m++)for(var y=1;y<=4;y++){var x=v[m][""+y];a[""+y].indexOf(x)>=0||a[""+y].push(x)}this.cluster_hoveredNodeIdDict=a,this.cluster_hoveredLinesList=v}else if(2===this.aggregationMode){this.detail_hoveredNodeIdList=e;for(var b=[],w=0;w<e.length;w++){for(var S={size:1},C="LINE_",k=1;k<=4;k++)S[""+k]=e[w],C=C+e[w]+"_";S.name=C,b.push(S)}this.detail_hoveredLinesList=b}}},{key:"updateFullHoveredStatus",value:function(){for(var e=1;e<=4;e++)this.updateSingleHoveredStatus(e)}},{key:"updateSingleHoveredStatus",value:function(e){1===this.aggregationMode?(this.cluster_highlightNodeIdDict[""+e]||(this.cluster_highlightNodeIdDict[""+e]=[]),this.cluster_hoveredNodeIdDict[""+e]||(this.cluster_hoveredNodeIdDict[""+e]=[]),this.updateHoveredStatus(this.cluster_hoveredNodeIdDict[""+e],this.cluster_highlightNodeIdDict[""+e],e)):2===this.aggregationMode&&this.updateHoveredStatus(this.detail_hoveredNodeIdList,this.detail_highlightNodeIdList,e)}},{key:"updateHoveredStatus",value:function(e,t,n){console.log("updateHoveredStatus",e,n);var r=Ot.select("#ScatterPlot_sub_"+n).select("g.main_drawings").selectAll("g.nodes"),a=r.filter((function(t){return e.indexOf(t.data.Data_id)>=0?(t.hovered=!0,!0):(t.hovered=!1,!1)}));r.classed("hovered",!1),a.classed("hovered",!0)}},{key:"initialize",value:function(e,t){this.reset(),this.filters=e,this.PCPJson=t,this.selectedNodeList=this.constructSelectedNodeList(e,t),this.pie_name=t.pie_name;for(var n=1;n<=4;n++)this.CacheDataPackage[""+n]=this.computeDistance(n);this.initialize_flag=!0}},{key:"checkinitialize",value:function(){return this.initialize_flag}},{key:"reset",value:function(){this.CacheDataPackage={},this.filters={},this.PCPJson={},this.pie_name=[],this.selectedNodeList=[],this.initialize_flag=!1,this.cluster_selectedNodeIdIndex=[],this.cluster_highlightNodeIdDict={},this.detail_highlightNodeIdList=[],this.cluster_renderedLinesList=[],this.detail_renderedLinesList=[],this.cluster_rawHighlightNodeIdList=[],this.detail_rawHighlightNodeIdList=[],this.cluster_hoveredNodeIdDict={},this.detail_hoveredNodeIdList=[],this.cluster_rawHoveredNodeIdList=[],this.detail_rawHoveredNodeIdList=[],this.cluster_hoveredLinesList=[],this.detail_hoveredLinesList=[],this.aggregationMode=1}},{key:"reconstructDataPackage",value:function(e){var t=this.cluster_selectedNodeIdIndex,n=e.matrix,r=e.selectedNodeList,a=t.map((function(e){return r[e]})),i=t.map((function(e){return t.map((function(t){return n[e][t]}))}));return Object(K.a)(Object(K.a)({},e),{},{matrix:i,selectedNodeList:a})}},{key:"getDataPackage",value:function(e,t){if(!(Object.keys(this.CacheDataPackage).indexOf(""+e)>=0))return{};var n="cluster";return 1===t?(n="cluster",this.CacheDataPackage[""+e][n]):2===t?(n="detail",this.cluster_selectedNodeIdIndex.length<=0?this.CacheDataPackage[""+e][n]:this.reconstructDataPackage(this.CacheDataPackage[""+e][n])):void 0}},{key:"getSquareDistance",value:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(Math.abs(e[r]-t[r]),2);return n}},{key:"transformCNtoList",value:function(e){return[e.cgt_ngt,e.cgt_npt,e.cpt_ngt,e.cpt_npt]}},{key:"getDistance",value:function(e,t,n,r){for(var a=this.getSquareDistance,i=this.transformCNtoList,o=0,s=n.pie_name,l=s[0],c=[],d=0;d<s.length;d++)c.push(s[d]+"_Prediction_Label");if(1===r){for(var u=["Ground_Truth_Label"],h=0;h<c.length;h++)u.push(c[h]);for(var f=0;f<u.length;f++)e[u[f]]===t[u[f]]||(o+=1);var g=e[l+"_Confidence"],p=t[l+"_Confidence"];o+=Math.pow(Math.abs(g-p),2)}else if(2===r){for(var _=["Ground_Truth_Label"],v=0;v<_.length;v++)e[_[v]]===t[_[v]]||(o+=1);var m=e.Real_Degree,y=t.Real_Degree,x=n.max_degree;m/=x,y/=x,o+=Math.pow(Math.abs(m-y),2),o+=a(i(e.CN_consistency),i(t.CN_consistency))}else if(3===r){for(var b=[c[0]],w=0;w<b.length;w++)e[b[w]]===t[b[w]]||(o+=1);o+=a(e.Spd_node_info,t.Spd_node_info);var S=e.Transformed_Distance,C=t.Transformed_Distance;o+=(S-C)*(S-C)}else if(4===r){for(var k=[c[0]],L=0;L<k.length;L++)e[k[L]]===t[k[L]]||(o+=1);o+=a(e.Topkfs_node_info,t.Topkfs_node_info)}return Math.sqrt(o)}},{key:"constructSelectedNodeList",value:function(e,t){var n=t.PSData.slice(),r=[],a=Object.keys(e);return n.forEach((function(t,n){if(function(t){if(a.length>0){for(var n=0;n<a.length;n++)if(e[a[n]].indexOf(t[a[n]])<0)return!1;return!0}return!0}(t)){var i=t;r.push(i)}})),r}},{key:"aggregateSelectedNodeList",value:function(e,t,n){var r={};if(e.length>=1){for(var a=0;a<t.length;a++){var i=n[a],o=t[a];if("categorical"===i){for(var s={},l=0;l<e.length;l++){var c=e[l][o];Object.keys(s).indexOf(c)>=0?s[c]=s[c]+1:s[c]=1}for(var d=Object.keys(s),u=d[0],h=s[u],f=1;f<d.length;f++)h<s[d[f]]&&(h=s[d[f]],u=d[f]);r[o]=u}else if("continuous"===i){for(var g=0,p=0;p<e.length;p++){g+=e[p][o]}var _=g/e.length;r[o]=_}else if("dict_continuous"===i){for(var v=Object.keys(e[0][o]),m=[],y=0;y<v.length;y++)m.push("continuous");for(var x=[],b=0;b<e.length;b++)x.push(e[b][o]);var w=this.aggregateSelectedNodeList(x,v,m);r[o]=w}else if("vector_continuous"===i){for(var S=[],C=e[0][o].length,k=0;k<C;k++)S[k]=0;for(var L=0;L<e.length;L++)for(var M=0;M<C;M++)S[M]=S[M]+e[L][o][M];for(var N=0;N<C;N++)S[N]=S[N]/e.length;r[o]=S}}return r}return r}},{key:"transformClusterRoot",value:function(e,t,n,r){for(var a=[],i=e.id_list,o=[],s=0;s<i.length;s++)a.push(t[i[s]]);for(var l=0;l<i.length;l++)o.push(a[l].Data_id);var c=r.pie_name,d=c[0];if(1===n){for(var u=["Ground_Truth_Label"],h=["categorical"],f=0;f<c.length;f++)u.push(c[f]+"_Prediction_Label"),h.push("categorical");u.push(c[0]+"_Confidence"),h.push("continuous");var g={};g=this.aggregateSelectedNodeList(a,u,h);for(var p=[L(g.Ground_Truth_Label,2)],_=0;_<c.length;_++)p.push(L(g[c[_]+"_Prediction_Label"],3));return p.push("#fff"),g.Color=p,g.id_list=i,g.raw_id_list=o,g.size=i.length,g}if(2===n){var v={};v=this.aggregateSelectedNodeList(a,["Ground_Truth_Label","Real_Degree","CN_consistency"],["categorical","continuous","dict_continuous"]);var m=[L(v.Ground_Truth_Label,2),"#fff","#fff","#fff","#fff"];return v.Color=m,v.id_list=i,v.raw_id_list=o,v.size=i.length,v}if(3===n){var y=[d+"_Prediction_Label","Spd_node_info","Transformed_Distance"],x={};x=this.aggregateSelectedNodeList(a,y,["categorical","vector_continuous","continuous"]);var b=["#fff",L(x[d+"_Prediction_Label"],3),"#fff","#fff","#fff"];return x.Color=b,x.id_list=i,x.raw_id_list=o,x.size=i.length,x}if(4===n){var w=[d+"_Prediction_Label","Topkfs_node_info"],S={};if(S=this.aggregateSelectedNodeList(a,w,["categorical","vector_continuous"]),a.length>=1){for(var C=[],k=0;k<a.length;k++)C=C.concat(a[k].Topkfs_nodes);C.sort((function(e,t){return e.anchor_similarity>t.anchor_similarity?-1:1}));var M=C.slice(0,5);M.sort((function(e,t){return e.anchor_label<t.anchor_label?-1:1})),S.Topkfs_nodes=M}var N=["#fff",L(S[d+"_Prediction_Label"],3),"#fff","#fff","#fff"];return S.Color=N,S.id_list=i,S.raw_id_list=o,S.size=i.length,S}return{}}},{key:"computeDistanceMatrix",value:function(e,t,n){for(var r=[],a=this.getDistance,i=0;i<e.length;i++){for(var o=[],s=0;s<e.length;s++)o.push(a(e[i],e[s],t,n));r.push(o)}return r}},{key:"renderLines",value:function(e,t,n){var r=this;if(e){for(var a=[],i=[],o=function(e){var t=void 0;1===r.aggregationMode?(r.cluster_highlightNodeIdDict[""+e]||(r.cluster_highlightNodeIdDict[""+e]=[]),t=r.cluster_highlightNodeIdDict[""+e]):t=r.detail_highlightNodeIdList,l=Ot.select("#ScatterPlot_sub_"+e),c=l.select("g.main_drawings"),d=c.selectAll("g.nodes"),u={},d.data().forEach((function(e){t.indexOf(e.data.Data_id)>=0&&(u[e.data.Data_id]={x:e.x,y:e.y})})),i.push({id:e,point_array:u})},s=1;s<=4;s++){var l,c,d,u;o(s)}var h=(t-20-20)/4-10,f=!0,g=[],p=[];1===this.aggregationMode?(g=this.cluster_renderedLinesList,p=this.cluster_hoveredLinesList):2===this.aggregationMode&&(g=this.detail_renderedLinesList,p=this.detail_hoveredLinesList),p=p.map((function(e){return e.name}));for(var _=0;_<g.length;_++){var v=g[_],m=v.name,y=!1;p.indexOf(m)>=0&&(y=!0),v.hovered=y;for(var x=[],b=0;b<i.length;b++){var w=v[""+(b+1)];if(!i[b].point_array[w]){f=!1;break}var S=20+b*(h+10),C=[i[b].point_array[w].x+S,i[b].point_array[w].y+20];x.push(C)}if(!f)break;a.push({line_package:v,coords:x})}f||(a=[]);var k=Ot.select("#connectionPath");if(k){var L=k.selectAll("path").data(a,(function(e){return e.line_package.name})),M=Ot.line().curve(Ot.curveNatural),N=L.enter().append("path").merge(L);L.exit().remove(),N.attr("d",(function(e){return M(e.coords.slice())})).style("fill","none").style("stroke",(function(e){return!0===e.line_package.hovered?"#000":"#999"})).style("stroke-width",(function(e){return 1.5*Math.sqrt(e.line_package.size)})).style("opacity",.5)}}}},{key:"updateHighlightStatus",value:function(e,t){var n=Ot.select("#ScatterPlot_sub_"+t).select("g.main_drawings").selectAll("g.nodes"),r=n.filter((function(t){return e.indexOf(t.data.Data_id)>=0?(t.selected=!0,!0):(t.selected=!1,!1)}));n.classed("lasso_not_possible",!1).classed("lasso_possible",!1).classed("lasso_selected",!1),e.length>0?n.classed("lasso_unselected",!0):n.classed("lasso_unselected",!1),r.classed("lasso_unselected",!1).classed("lasso_selected",!0)}},{key:"constructInvertedIndex",value:function(e){for(var t={},n=0;n<e.length;n++)for(var r=e[n].Data_id,a=e[n].id_list,i=0;i<a.length;i++)t[a[i]]=r;return t}},{key:"computeDistance",value:function(e){for(var t,n,r=this.transformCNtoList,a=this.pie_name,i=this.selectedNodeList,o=[],s=0,l=1,c={},d=0;d<i.length;d++){var u=i[d].Shortest_Path_Distance_to_Train_Nodes;"inf"!==u&&u>s&&(s=u);var h=i[d].Real_Degree;h>l&&(l=h),i[d].size=1,i[d].id_list=[i[d].Data_id],i[d].raw_id_list=[i[d].Data_id]}c.max_shortest_path_distance=s,c.max_degree=l,c.pie_name=a,t=this.computeDistanceMatrix(i,c,e);var f=a[0];if(1===e){for(var g=["Ground_Truth_Label"],p=0;p<a.length;p++)g.push(a[p]+"_Prediction_Label");g.push(f+"_Confidence");for(var _=0;_<i.length;_++){for(var v=[],m=i[_],y=0;y<g.length;y++)v.push(m[g[y]]);o.push(v)}}else if(2===e)for(var x=["Ground_Truth_Label"],b=0;b<i.length;b++){var w=[],S=i[b];w.push(S[x[0]]),w.push(S.Real_Degree),w=w.concat(r(S.CN_consistency)),o.push(w)}else if(3===e)for(var C=[f+"_Prediction_Label"],k=0;k<i.length;k++){var L=[],M=i[k];L.push(M[C[0]]),L=L.concat(M.Spd_node_info),o.push(L)}else if(4===e)for(var N=[f+"_Prediction_Label"],E=0;E<i.length;E++){var O=[],P=i[E];O.push(P[N[0]]),O=O.concat(P.Topkfs_node_info),o.push(O)}var I=new Et(e);I.setlinkage("complete"),I.setDistMatrix(t);for(var j=I.cluster(o,.5),D=[],T=0;T<j.length;T++){var A=this.transformClusterRoot(j[T],i,e,c);A.Data_id=T,D.push(A)}return n=D,{cluster:{mode:"cluster",additional_info:c,matrix:this.computeDistanceMatrix(n,c,e),selectedNodeList:n,highlightNodeIdList:[],invertedIndex:this.constructInvertedIndex(n)},detail:{mode:"detail",additional_info:c,matrix:t,selectedNodeList:i,highlightNodeIdList:[]}}}}]),e}(),It=m.a.Option,jt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).prevSelectedNodeIdList=[],r.thisSelectedNodeIdList=[],r.InsProjectionViewComputing=new Pt,r.onChangeHighLightNodeIdList=r.onChangeHighLightNodeIdList.bind(Object(c.a)(r)),r.onChangeHoveredNodeIdList=r.onChangeHoveredNodeIdList.bind(Object(c.a)(r)),r.renderLines=r.renderLines.bind(Object(c.a)(r)),r.onChangeLines=r.onChangeLines.bind(Object(c.a)(r)),r.onChangeLegends=r.onChangeLegends.bind(Object(c.a)(r)),r.updateSingleHighlightNodeStatus=r.updateSingleHighlightNodeStatus.bind(Object(c.a)(r)),r.onLayoutModeChange=r.onLayoutModeChange.bind(Object(c.a)(r)),r.state={currentPage:1,enableLegends:!0,enableLines:!0,aggregationMode:1,layoutMode:1},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){P(this.prevSelectedNodeIdList,this.thisSelectedNodeIdList)||(this.props.changeSelectedNodeIdList(this.thisSelectedNodeIdList),this.prevSelectedNodeIdList=this.thisSelectedNodeIdList.slice(),this.InsProjectionViewComputing.updateHighlightNodeIdList([]),this.InsProjectionViewComputing.updateHoveredNodeIdList([])),this.state.enableLines&&this.renderLines()}},{key:"constructSelectedNodeList",value:function(e,t){var n=t.PSData.slice(),r=[],a=Object.keys(e);return n.forEach((function(t,n){if(function(t){if(a.length>0){for(var n=0;n<a.length;n++)if(e[a[n]].indexOf(t[a[n]])<0)return!1;return!0}return!0}(t)){var i=t;r.push(i)}})),r}},{key:"renderLines",value:function(){this.InsProjectionViewComputing.renderLines(this.state.enableLines,this.props.width,this.props.height)}},{key:"onChangeHighLightNodeIdList",value:function(e,t,n){this.props.changeSelectedNodeIdList(e.slice()),0===t.length?this.InsProjectionViewComputing.updateHighlightNodeIdList(t.slice(),n,[]):this.InsProjectionViewComputing.updateHighlightNodeIdList(t.slice(),n,e.slice()),this.InsProjectionViewComputing.updateNodeStatistic(this.props.changeProjectionViewSelectedNodes,this.props.changeProjectionViewTotalNodeNum),this.renderLines()}},{key:"onChangeHoveredNodeIdList",value:function(e,t,n){0===t.length?this.InsProjectionViewComputing.updateHoveredNodeIdList(t.slice(),n,[]):this.InsProjectionViewComputing.updateHoveredNodeIdList(t.slice(),n,e.slice()),this.renderLines()}},{key:"updateSingleHighlightNodeStatus",value:function(e){this.InsProjectionViewComputing.updateFullHighlightStatus(e)}},{key:"onChangeLines",value:function(e){this.setState({enableLines:e})}},{key:"onChangeLegends",value:function(e){this.setState({enableLegends:e})}},{key:"onChangeAggregationMode",value:function(e){this.setState({aggregationMode:e})}},{key:"onLayoutModeChange",value:function(e){this.setState({layoutMode:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.filters,a=t.PCPJson;console.log("Selected Node List",n,a);var i,o,s=this.state.layoutMode;a.success?(o=this.constructSelectedNodeList(n,a),i=o.map((function(e){return e.Data_id}))):(o=[],i=[]),this.thisSelectedNodeIdList=i;var l=this.props.height-62-20,c=(this.props.width-20-20)/4-10;this.props.changePSSelectedNodes(o.length);var d=this.onChangeLegends,u=this.onChangeLines;if(i.length>0&&i.length<300){P(this.prevSelectedNodeIdList,this.thisSelectedNodeIdList)||this.InsProjectionViewComputing.initialize(n,a),this.InsProjectionViewComputing.updateAggregationMode(this.state.aggregationMode),this.InsProjectionViewComputing.updateNodeStatistic(this.props.changeProjectionViewSelectedNodes,this.props.changeProjectionViewTotalNodeNum);var h=this.InsProjectionViewComputing.getRawHighlightNodeIdList();return h.length>0&&this.props.changeSelectedNodeIdList(h.slice()),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px"}},r.createElement("div",{className:"ViewTitle"},"Projection View",r.createElement("div",{style:{float:"right"}},1===e.state.aggregationMode?r.createElement(x.a,{type:"default",size:"small",onClick:function(){e.onChangeAggregationMode(2)}},"Detail"):2===e.state.aggregationMode?r.createElement(x.a,{type:"primary",size:"small",onClick:function(){e.onChangeAggregationMode(1)}},"Cluster"):void 0,"\xa0\xa0\xa0\xa0 Layout:\xa0",r.createElement(m.a,{placeholder:"Select a layout",value:s,style:{width:"90px"},onChange:this.onLayoutModeChange,size:"small"},[[1,"t-SNE"],[2,"UMAP"]].map((function(e){return r.createElement(It,{value:e[0],key:e[0]},e[1])}))),"\xa0\xa0\xa0\xa0 Legend: ",r.createElement(mt.a,{checked:this.state.enableLegends,onChange:d}),"\xa0\xa0\xa0\xa0 Links: ",r.createElement(mt.a,{checked:this.state.enableLines,onChange:u}),"\xa0\xa0\xa0\xa0 #Nodes: ",r.createElement(Nt,null))),r.createElement("div",{className:"ViewBox"},r.createElement("svg",{style:{height:this.props.height-62+10+"px",width:this.props.width+"px"},id:"TopSVGChart_ScatterPlot",xmlns:"http://www.w3.org/2000/svg"},this.state.enableLines?r.createElement("g",{key:"c1",id:"connectionPath"}):r.createElement("g",{key:"c2",id:"connectionPath-Null"}),[[1,"Prediction results comparison"],[2,"Surrounding nodes label consistency"],[3,"Training nodes structure influence"],[4,"Training nodes feature influence"]].map((function(t){return r.createElement(Lt,Object.assign({key:t[0],id:t[0],showMode:t[0]},e.props,{x:20+(t[0]-1)*(c+10),y:20,height:l,width:c,name:t[1],selectedNodeIdList:i,onChangeHighLightNodeIdList:e.onChangeHighLightNodeIdList,onChangeHoveredNodeIdList:e.onChangeHoveredNodeIdList,renderLines:e.renderLines,dataPackage:e.InsProjectionViewComputing.getDataPackage(t[0],e.state.aggregationMode),updateSingleHighlightNodeStatus:e.updateSingleHighlightNodeStatus,enableLegends:e.state.enableLegends,layoutMode:e.state.layoutMode,graph_additional_info:e.props.PCPJson.graph_additional_info}))})))))}return this.InsProjectionViewComputing.reset(),r.createElement("div",{style:{width:"100%",height:this.props.height-10+"px",overflowX:"hidden"}},r.createElement("div",{className:"ViewTitle"},"Projection View "))}}]),n}(r.Component),Dt=Object(W.b)((function(e){return{filters:e.filters,refreshnumber:e.refreshnumber,showSource:e.showSource,select_inspect_node:e.select_inspect_node,PCPJson:e.PSJson}}),(function(e){return{changeSelectedNodeIdList:function(t){return e(function(e){return{type:"SELECTED_NODE_ID_LIST_CHANGE",selectedNodeIdList:e}}(t))},changeShowSource:function(t){return e(ee(t))},changePSSelectedNodes:function(t){return e(function(e){return{type:"PSSELECTEDNODES_CHANGE",PSSelectedNodes:e}}(t))},changeProjectionViewSelectedNodes:function(t){return e(function(e){return{type:"PROJECTIONVIEWSELECTEDNODES_CHANGE",ProjectionViewSelectedNodes:e}}(t))},changeProjectionViewTotalNodeNum:function(t){return e(function(e){return{type:"PROJECTIONVIEWTOTALNODENUM_CHANGE",ProjectionViewTotalNodeNum:e}}(t))}}}))(jt),Tt=n(331),At=n(170),Gt=n.n(At),Vt=(Tt.a.TabPane,n(29),m.a.Option,function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).PCPViewRef=void 0,a.GraphViewRef=void 0,a.FeatureMatrixViewRef=void 0,a.ControlPanelRef=void 0,a.ProjectionViewRef=void 0,a.onShowModeChange=a.onShowModeChange.bind(Object(c.a)(a)),a.onExplainNodeChange=a.onExplainNodeChange.bind(Object(c.a)(a)),a.onResizeStop=a.onResizeStop.bind(Object(c.a)(a)),a.getLayoutConfigWithName=a.getLayoutConfigWithName.bind(Object(c.a)(a)),a.getCurrentLayoutConfig=a.getCurrentLayoutConfig.bind(Object(c.a)(a)),a.onResize=a.onResize.bind(Object(c.a)(a)),a.PCPViewRef=r.createRef(),a.GraphViewRef=r.createRef(),a.FeatureMatrixViewRef=r.createRef(),a.ControlPanelRef=r.createRef(),a.ProjectionViewRef=r.createRef(),a.state={graph_object:{model:-1,graph:-1},show_mode:1,explained_node:0,layout_config:null,screenWidth:0,screenHeight:0},a}return Object(l.a)(n,[{key:"componentWillMount",value:function(){}},{key:"onResize",value:function(){this.setState({screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"componentDidMount",value:function(){this.setState({layout_config:this.getWholeLayoutConfig(),screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"componentWillUpdate",value:function(e,t){}},{key:"getgraphdata",value:function(){var e=Object(v.a)(_.a.mark((function e(t,n,r,a){var i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be(t,n,r,a);case 2:!0===(i=e.sent).success&&this.setState({graph_object:i.graph_obj});case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"getGraphBundledData",value:function(){var e=Object(v.a)(_.a.mark((function e(t){var n,r,a,i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ye(t);case 2:if(!0===(n=e.sent).success){for(this.props.changeLoadingDataset(!0),this.props.clearIdInfo(),n.graph_obj.bundle_id=t,r=n.graph_obj.individual_model_names,a=[],i=0;i<3&&i<r.length;i++)a.push(r[i]);this.props.changeModelsList(r),this.props.changeSelectedModels(a),this.setState({graph_object:n.graph_obj}),this.props.changeLoadingDataset(!1)}case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLayoutConfigWithName",value:function(e){var t=0,n=0;return"PCPView"===e?this.PCPViewRef&&(t=this.PCPViewRef.current.offsetWidth,n=this.PCPViewRef.current.offsetHeight):"GraphView"===e?this.GraphViewRef&&(t=this.GraphViewRef.current.offsetWidth,n=this.GraphViewRef.current.offsetHeight):"FeatureMatrixView"===e?this.FeatureMatrixViewRef&&(t=this.FeatureMatrixViewRef.current.offsetWidth,n=this.FeatureMatrixViewRef.current.offsetHeight):"ProjectionView"===e?this.ProjectionViewRef&&(t=this.ProjectionViewRef.current.offsetWidth,n=this.ProjectionViewRef.current.offsetHeight):"ControlPanel"===e&&this.ControlPanelRef&&(t=this.ControlPanelRef.current.offsetWidth,n=this.ControlPanelRef.current.offsetHeight),{width:t,height:n}}},{key:"getWholeLayoutConfig",value:function(){var e=this,t={};return["PCPView","GraphView","FeatureMatrixView","ControlPanel","ProjectionView"].forEach((function(n){t[n]=e.getLayoutConfigWithName(n)})),t}},{key:"getCurrentLayoutConfig",value:function(e){var t=this.state.layout_config;return t&&t[e]?t[e]:null}},{key:"componentDidUpdate",value:function(e,t){e.dataset_id!==this.props.dataset_id&&(this.props.dataset_id&&this.props.dataset_id>=0?this.getGraphBundledData(this.props.dataset_id):this.setState({graph_object:{model:-1,graph:-1}})),e.contentHeight===this.props.contentHeight&&e.contentWidth===this.props.contentWidth||this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"onShowModeChange",value:function(e){this.setState({show_mode:e})}},{key:"onExplainNodeChange",value:function(e){this.setState({explained_node:e})}},{key:"onLayoutChange",value:function(e){console.log("Layout",e)}},{key:"onResizeStop",value:function(e){console.log("onResizeStop",e),console.log("Layout",this.getWholeLayoutConfig()),this.setState({layout_config:this.getWholeLayoutConfig()})}},{key:"render",value:function(){var e=this,t=this.state,n=t.graph_object,a=t.show_mode,i=t.explained_node,o=this.props.modelList,s=-1,l=n.common;l&&(s=l.dataset_id),console.log("Dataruns graph_object",n);window.innerHeight;var c=Math.floor(this.props.contentHeight/40),d=c-6,u=Math.floor(c/2),h=c-u,f=[{i:"a",x:0,y:6,w:6,h:d,static:!0},{i:"b",x:6,y:u,w:11,h:h,static:!0},{i:"c",x:17,y:u,w:7,h:h,static:!0},{i:"d",x:0,y:0,w:6,h:6,static:!0},{i:"e",x:6,y:0,w:18,h:u,static:!0}],g=this.props.loading_dataset;return function(){var t=window.innerWidth;window.innerHeight;return r.createElement(Gt.a,{className:"layout",layout:f,cols:24,rowHeight:30,width:t,onLayoutChange:e.onLayoutChange,onResizeStop:e.onResizeStop},r.createElement("div",{className:"PanelBox",key:"a",ref:e.PCPViewRef},s>=0&&!g&&e.getCurrentLayoutConfig("PCPView")?function(e,t,n,a,i,o,s){var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return r.createElement(vt,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:l,height:c})}(n,a,i,e.onExplainNodeChange,e.onShowModeChange,-1,o,e.getCurrentLayoutConfig("PCPView").width,e.getCurrentLayoutConfig("PCPView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"b",ref:e.GraphViewRef},s>=0&&!g&&e.getCurrentLayoutConfig("GraphView")?function(e,t,n,a,i,o,s,l,c){return r.createElement(ve,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:l,height:c})}(n,a,i,e.onExplainNodeChange,e.onShowModeChange,-1,o,e.getCurrentLayoutConfig("GraphView").width,e.getCurrentLayoutConfig("GraphView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"c",ref:e.FeatureMatrixViewRef},s>=0&&!g&&e.getCurrentLayoutConfig("FeatureMatrixView")?function(e,t,n,a,i,o,s,l,c){return r.createElement(Te,{graph_object:e,show_mode:t,explained_node:n,onExplainNodeChange:a,onShowModeChange:i,model:o,modelList:s,width:l,height:c})}(n,a,i,e.onExplainNodeChange,e.onShowModeChange,-1,o,e.getCurrentLayoutConfig("FeatureMatrixView").width,e.getCurrentLayoutConfig("FeatureMatrixView").height):r.createElement("div",null)),r.createElement("div",{className:"PanelBox",key:"d",ref:e.ControlPanelRef},r.createElement(lt,null)),r.createElement("div",{className:"PanelBox",key:"e",ref:e.ProjectionViewRef},s>=0&&!g&&e.getCurrentLayoutConfig("ProjectionView")?r.createElement(Dt,{height:e.getCurrentLayoutConfig("ProjectionView").height,width:e.getCurrentLayoutConfig("ProjectionView").width}):r.createElement("div",null)))}()}}]),n}(r.Component)),Ht=Object(W.b)((function(e){return{model:e.model,graph:e.graph,dataset_id:e.dataset_id,explain_id:e.explain_id,modelList:e.modelList,loading_dataset:e.loading_dataset}}),(function(e){return{changeModelsList:function(t){return e(function(e){return{type:"MODELSLIST_CHANGE",models_list:e}}(t))},changeSelectedModels:function(t){return e($(t))},changeLoadingDataset:function(t){return e({type:"CHANGE_LOADING_DATASET",loading_dataset:t})},clearIdInfo:function(){return e({type:"CLEAR_ID_INFO"})}}}))(Vt),Ft=h.a.Content,Rt=h.a.Header,zt=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).ContentRef=void 0,r.ContentRef=a.a.createRef(),r.onResize=r.onResize.bind(Object(c.a)(r)),r.state={contentWidth:0,contentHeight:0,screenHeight:0,screenWidth:0},r}return Object(l.a)(n,[{key:"getLayoutConfig",value:function(){var e=0,t=0;return this.ContentRef&&(e=this.ContentRef.current.offsetWidth,t=this.ContentRef.current.offsetHeight),{contentWidth:e,contentHeight:t}}},{key:"onResize",value:function(){this.updateLayoutState()}},{key:"updateLayoutState",value:function(){var e=this.getLayoutConfig(),t=e.contentWidth,n=e.contentHeight;this.setState({contentWidth:t,contentHeight:n,screenHeight:window.innerHeight,screenWidth:window.innerWidth})}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),this.updateLayoutState()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e=this.state,t=(e.screenWidth,e.screenHeight,e.contentWidth),n=e.contentHeight;return a.a.createElement(h.a,{className:"app"},a.a.createElement(Rt,{className:"appHeader"},"GNNLens",a.a.createElement("img",{src:g.a,className:"appLogo","alt-text":"logo"})),a.a.createElement(Ft,{className:"appContent"},a.a.createElement("div",{style:{height:"100%",width:"100%"},ref:this.ContentRef},t>0&&n>0?a.a.createElement(Ht,{contentWidth:t,contentHeight:n}):a.a.createElement("div",null)),a.a.createElement("div",{id:"tooltip_proj"}),a.a.createElement("div",{id:"tooltip_matrix"}),a.a.createElement("div",{id:"tooltip_node_title"})))}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Wt=n(172),Kt={model:null,graph:null,dataset_id:null,explain_id:null,selected_models_list:[],models_list:[],refreshnumber:0,showSource:!1,modelList:[],datasetList:[],explainList:[],graphList:[],filters:{},selectedNodeIdList:[],selectedMessagePassingNodeIdList:[],specificNodeIdList:[],select_inspect_node:0,prevGraphJson:null,matrixFilters:{refreshnumber:0},matrixRowFilters:{refreshnumber:0},InspectCategoryList:O,PSJson:{},PSSelectedNodes:0,extendedMode:1,ProjectionViewSelectedNodes:0,ProjectionViewTotalNodeNum:0,PSSettingsModal_visible:!1,PSDimensions:[],ProjectionViewSettingsModal_visible:!1,GraphViewSettingsModal_visible:!1,FeatureMatrixViewSettingsModal_visible:!1,GraphViewState:{DisplayUnfocusedNodes:!1,DisplayOverview:!0},K_value:5,loading_dataset:!1},Ut=(n(315),n(316),Object(Wt.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MODEL_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{model:t.model});case"GRAPH_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{graph:t.graph});case"INIT_MODEL_LIST":return Object(K.a)(Object(K.a)({},e),{},{modelList:t.modelList});case"DATASET_ID_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{dataset_id:t.dataset_id});case"EXPLAIN_METHOD_ID_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{explain_id:t.explain_id});case"INIT_DATASET_LIST":return Object(K.a)(Object(K.a)({},e),{},{datasetList:t.datasetList});case"INIT_EXPLAIN_LIST":return Object(K.a)(Object(K.a)({},e),{},{explainList:t.explainList});case"INIT_GRAPH_LIST":return Object(K.a)(Object(K.a)({},e),{},{graphList:t.graphList});case"FILTERS_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{refreshnumber:e.refreshnumber+1,filters:t.filters});case"SELECTED_NODE_ID_LIST_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{selectedNodeIdList:t.selectedNodeIdList});case"SELECTED_MESSAGE_PASSING_NODE_ID_LIST_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{selectedMessagePassingNodeIdList:t.selectedMessagePassingNodeIdList});case"SHOW_SOURCE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{showSource:t.showSource});case"SPECIFIC_NODE_ID_LIST_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{specificNodeIdList:t.specificNodeIdList});case"SELECT_INSPECT_NODE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{select_inspect_node:t.select_inspect_node});case"CLEAR_ID_INFO":return Object(K.a)(Object(K.a)({},e),{},{filters:{},selectedNodeIdList:[],selectedMessagePassingNodeIdList:[],specificNodeIdList:[],select_inspect_node:0});case"PREV_GRAPH_JSON_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{prevGraphJson:t.prevGraphJson});case"MATRIX_FILTERS_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{matrixFilters:t.matrixFilters});case"MATRIX_ROW_FILTERS_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{matrixRowFilters:t.matrixRowFilters});case"INSPECT_CATEGORY_LIST_CHANGE":return console.log("CategoryList",t.inspectCategoryList),Object(K.a)(Object(K.a)({},e),{},{InspectCategoryList:t.inspectCategoryList});case"PSJSON_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{PSJson:t.PSJson});case"PSSELECTEDNODES_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{PSSelectedNodes:t.PSSelectedNodes});case"EXTENDED_MODE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{extendedMode:t.extendedMode});case"PROJECTIONVIEWSELECTEDNODES_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{ProjectionViewSelectedNodes:t.ProjectionViewSelectedNodes});case"PROJECTIONVIEWTOTALNODENUM_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{ProjectionViewTotalNodeNum:t.ProjectionViewTotalNodeNum});case"PSSETTINGMODAL_VISIBLE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{PSSettingsModal_visible:t.PSSettingsModal_visible});case"PSDIMENSIONS_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{PSDimensions:t.PSDimensions});case"PROJECTIONVIEWSELECTEDNODES_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{ProjectionViewSettingsModal_visible:t.ProjectionViewSettingsModal_visible});case"GRAPHVIEWSETTINGMODAL_VISIBLE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{GraphViewSettingsModal_visible:t.GraphViewSettingsModal_visible});case"FEATUREMATRIXVIEWSETTINGMODAL_VISIBLE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{FeatureMatrixViewSettingsModal_visible:t.FeatureMatrixViewSettingsModal_visible});case"GRAPHVIEWSTATE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{GraphViewState:t.GraphViewState});case"KVALUE_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{K_value:t.K_value});case"SELECTEDMODELS_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{selected_models_list:t.selected_models_list});case"MODELSLIST_CHANGE":return Object(K.a)(Object(K.a)({},e),{},{models_list:t.models_list});case"CHANGE_LOADING_DATASET":return Object(K.a)(Object(K.a)({},e),{},{loading_dataset:t.loading_dataset});default:return e}})));o.a.render(a.a.createElement(W.a,{store:Ut},a.a.createElement(zt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[177,1,2]]]);
//# sourceMappingURL=main.7193be71.chunk.js.map